(function(a){a.pocketlists={$loading:a('<i class="icon16 loading">'),defaults:{},options:{},updateAppCounter:function(c){var b=this;var d=function(f){f=parseInt(f,10)||"";var e=b.$app_menu_pocket.find(".indicator");var g=b.$core_sidebar.find('[data-pl-sidebar="todo"] .count');if(!e.length){b.$app_menu_pocket.find("a").append('<span class="indicator" style="display:none;">');e=b.$app_menu_pocket.find(".indicator")}if(!g.length){g=a('<span class="count indicator red" style="display:none;">');b.$core_sidebar.find('[data-pl-sidebar="todo"]').prepend(g)}e.add(g).text(f);if(f){e.add(g).show()}else{e.add(g).hide()}};if(c){d(c)}else{a.get("?module=json&action=appCount",function(e){if(e.status==="ok"){d(e.data)}},"json")}},scrollToTop:function(b,c){if(a("body").scrollTop()>c){a("html,body").animate({scrollTop:c+"px"},b)}},highlightSidebar:function(f){var b=this;var c=b.$core_sidebar.find("li");if(f){c.removeClass("selected");f.addClass("selected")}else{var e=a.pocketlists_routing.getHash(),d=c.find('a[href="'+e+'"]');if(e){c.removeClass("selected")}if(d.length){d.closest("li").addClass("selected")}else{e=e.split("/");if(e[1]){c.find('a[href^="'+e[0]+"/"+e[1]+'"]').first().closest("li").addClass("selected")}}}},setTitle:function(d){var b=this;var c=a("#wa-app .content h1").first();if(c.length&&!d){d=c.contents().filter(function(){return this.nodeType==3&&this.nodeValue.trim().length>0})[0].nodeValue.trim()}if(d){a("title").html(d+" &mdash; "+b.options.account_name)}},init:function(c){a.pocketlists_routing.init();var b=this;b.$app_menu_pocket=a("#wa-app-pocketlists");b.$core_sidebar=a("#pl-sidebar-core");b.options=a.extend({},b.defaults,c);b.highlightSidebar();a("#wa-app").on("click","[data-pl-scroll-to-top] a",function(){b.scrollToTop(0,80)});b.$core_sidebar.on("click","a",function(){b.highlightSidebar(a(this).closest("li"))})}}}(jQuery));