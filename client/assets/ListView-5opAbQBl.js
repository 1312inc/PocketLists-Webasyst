import{_ as w}from"./TaskListLayout.vue_vue_type_script_setup_true_lang-c4itqRrG.js";import{_ as S}from"./TaskList.vue_vue_type_script_setup_true_lang-eKR7raIY.js";import{d as b,r as m,O as B,P as $,o as n,c as d,E as I,i as O,j as p,k as h,q as N,e as y,x as _,l as v,b as l,F as k,s as g,I as L,G as T,Q as C,t as D,R as E,h as R,K as V}from"./index-8JwXqn5-.js";import"./rangy-5rxgwlWZ.js";import"./SortableList.vue_vue_type_style_index_0_lang-t9Ls2xKY.js";const F=r=>typeof r<"u",j=b({__name:"IntersectionObserver",props:{disabled:{type:Boolean}},emits:["intersecting"],setup(r,{emit:t}){const i=r,s=t,e=m(null),{stop:c}=B(e,([{isIntersecting:o}])=>{o&&!i.disabled&&s("intersecting")},{rootMargin:"100px"});return $(()=>{c()}),(o,u)=>(n(),d("div",{ref_key:"elRef",ref:e,class:"tw-min-h-2"},[I(o.$slots,"default")],512))}}),q={class:"skeleton"},G=b({__name:"Scroller",props:{currentListId:{},fetchDisabled:{type:Boolean}},setup(r){const t=r,i=O(),s=m(0),e=m(null),c=p(()=>e.value?e.value.offset+e.value.limit<e.value.count:!1);h(()=>t.currentListId,()=>{s.value=0,e.value=null}),h(s,async()=>{if(!t.fetchDisabled){const{scrollTop:u}=document.documentElement,{data:f,...a}=await i.fetch({list_id:t.currentListId,offset:s.value});await N(),document.documentElement.scrollTop=u,e.value=a}},{immediate:!0});function o(){e.value&&(s.value+=e.value.limit)}return(u,f)=>(n(),d(k,null,[I(u.$slots,"default",{tasks:y(i).getTasksInList(t.currentListId)}),c.value?(n(),_(j,{key:0,onIntersecting:o},{default:v(()=>[l("div",q,[(n(),d(k,null,g(10,a=>l("span",{key:a,class:"skeleton-custom-box",style:{height:"60px"}})),64))])]),_:1})):L("",!0)],64))}}),K={key:0,class:"tw-gap-4"},M={class:"tw-px-6"},H=b({__name:"ListView",setup(r){const t=T(),i=C(),s=p(()=>V(i.params.id)),e=p(()=>t.getItemById(s.value)),c=p(()=>[e.value,...t.getSublistsInList(s.value)].filter(F)),o=()=>{e.value&&t.createList({pocket_id:e.value.pocket_id,parent_list_id:s.value})};return(u,f)=>(n(),_(w,null,{default:v(()=>[e.value?(n(),d("div",K,[l("div",M,[l("h1",null,D(e.value.name),1)]),(n(!0),d(k,null,g(c.value,a=>(n(),_(G,{key:a.uuid||a.id,"current-list-id":a.id,"fetch-disabled":!y(E)(e.value)},{default:v(({tasks:x})=>[R(S,{items:x,"sortable-list-id":a.id,"addable-props":{list_id:a.id}},null,8,["items","sortable-list-id","addable-props"])]),_:2},1032,["current-list-id","fetch-disabled"]))),128)),l("div",{class:"align-center"},[l("button",{class:"gray",onClick:o},f[0]||(f[0]=[l("i",{class:"fas fa-plus"},null,-1)]))])])):L("",!0)]),_:1}))}});export{H as default};
