import{h as w,G as M,H as I,r as y,o as i,j as u,k as c,D as x,Q as k,w as b,X as C,F as B,B as P,Y as D,L as H,Z as v,u as K,E as U,v as L,$ as S,q as h,z as O,P as $,t as g,m as T,a0 as V,U as q,c as N,K as z,S as F}from"./index-B8l4BAgU.js";import{C as R}from"./ContenteditableBlock-QK_56zou.js";import{u as Y,p as j,_ as G}from"./SortableList.vue_vue_type_style_index_0_lang-Ng7Ay8iq.js";const J={class:"custom-p-12"},Q={class:"heading black custom-m-0 custom-mb-8"},W={key:1},X={key:2},de=w({__name:"PocketsListItem",props:{withoutPocket:{type:Boolean},pocket:{},userId:{}},setup(p){const e=p,d=M(),r=I(),s=y(!1),l=y(),t=async()=>{let a;if(e.pocket?a=await r.createList({pocket_id:e.pocket.id}):e.userId&&(a=await r.createList({assigned_contact_id:e.userId})),!a)return;D("focusList").emit(a.id)},m=async()=>{s.value=!0,await P(),l.value.focus()},_=async a=>{e.pocket&&await d.updateItemName(e.pocket,a)},f=async()=>{e.pocket&&await d.deleteItem(e.pocket)};return(a,n)=>(i(),u(B,null,[c("div",J,[c("h5",Q,[e.pocket?(i(),x(R,{key:0,ref_key:"pocketNameRef",ref:l,value:e.pocket.name||"",tag:"div",editable:s.value,focusable:!0,placeholder:a.$t("newPocket"),onBlur:n[0]||(n[0]=o=>s.value=!1),onUpdate:_},null,8,["value","editable","placeholder"])):e.withoutPocket?(i(),u("div",W," NO POCKET ")):e.userId?(i(),u("div",X," USER LIST ")):k("",!0),e.pocket?(i(),u("a",{key:3,class:"count",onClick:b(m,["prevent"])},n[1]||(n[1]=[c("i",{class:"fas fa-pen"},null,-1)]))):k("",!0),c("a",{class:"count action",onClick:b(t,["prevent"])},n[2]||(n[2]=[c("i",{class:"fas fa-plus-circle"},null,-1)])),e.pocket?(i(),u("a",{key:4,class:"count action",onClick:b(f,["prevent"])},n[3]||(n[3]=[c("i",{class:"fas fa-trash-alt"},null,-1)]))):k("",!0)])]),C(a.$slots,"default")],64))}}),Z=w({__name:"WaDropOnElement",props:{draggableEntityName:{}},emits:["drop"],setup(p,{emit:e}){const d=e,r=p,s=y(),{getDraggingEntityName:l}=Y();return H(()=>{v(s,"dragenter",t=>{r.draggableEntityName===l()&&t.currentTarget instanceof HTMLElement&&t.currentTarget.classList.add("dragover")}),v(s,"dragleave",t=>{if(t.currentTarget instanceof HTMLElement){if(t.relatedTarget&&t.currentTarget.contains(t.relatedTarget))return;t.currentTarget.classList.remove("dragover")}}),v(s,"dragover",t=>{t.preventDefault()}),v(s,"drop",t=>{if(r.draggableEntityName===l()&&t.currentTarget instanceof HTMLElement&&(t.preventDefault(),t.currentTarget.classList.remove("dragover"),t.dataTransfer))try{const m=JSON.parse(t.dataTransfer.getData("text/plain")).taskIds;d("drop",m)}catch{}})}),(t,m)=>(i(),u("div",{ref_key:"menuItemElementRef",ref:s},[C(t.$slots,"default")],512))}}),A={class:"image sortable-handle"},ee={class:"details"},te={class:"tablebox"},se={class:"count align-right tw-flex tw-gap-1"},ae={key:0,class:"hint tw-flex"},oe={class:"tw-w-14 tw-truncate"},ne=w({__name:"ListsListItem",props:{item:{}},setup(p){const e=p,d=I(),r=K(),s=U(),l=y(),t=y(!1),m=async o=>{t.value=!1,await d.updateItem(e.item,{name:o},{quietly:typeof e.item.pocket_id=="string"})},_=async o=>{await r.sort(e.item.id,null,o)},f=async o=>{o.target instanceof HTMLElement&&o.target.innerText&&s.push({name:"list",params:{id:e.item.id},query:{addNewTask:1}})};D("focusList").on(o=>{o===e.item.id&&n()});const n=async()=>{t.value=!0,await P(),l.value.focus()};return(o,ie)=>(i(),x(Z,{"draggable-entity-name":"tasks",onDrop:_},{default:L(()=>{var E;return[c("a",A,[c("i",{class:"userpic userpic32",style:S(`background-image: url(${e.item.icon_url||"/wa-apps/pocketlists/img/listicons/li-list@2x.png"})`)},null,4)]),c("a",ee,[c("div",te,[h(R,{ref_key:"contenteditableBlockRef",ref:l,value:o.item.name,editable:t.value,focusable:!0,placeholder:o.$t("newList"),tag:"strong",onUpdate:m,onKeydown:O(b(f,["prevent"]),["enter"])},null,8,["value","editable","placeholder","onKeydown"]),c("span",se,[$(g(e.item.extended_data.items_count>0?e.item.extended_data.items_count:0)+" ",1),e.item.extended_data.items_priority_count?(i(),u("span",{key:0,class:"badge",style:S(`background-color: ${(E=T(j).get(e.item.extended_data.items_priority_value))==null?void 0:E.color}`)},g(e.item.extended_data.items_priority_count),5)):k("",!0)])]),T(V).is_debug_mode?(i(),u("p",ae,[c("span",oe,"id: "+g(e.item.id),1),$(" | srank: "+g(e.item.sort)+" | "+g(e.item.rank),1)])):k("",!0)])]}),_:1}))}}),re={key:0,class:"custom-px-16 custom-py-12 gray"},me=w({__name:"ListsList",props:{withoutPocket:{type:Boolean},pocket:{},userId:{}},setup(p){const e=p,d=q(),r=I(),s=N(()=>e.withoutPocket?r.getListsInPocket(null):e.pocket?r.getListsInPocket(e.pocket.id):e.userId?r.getListsByUser(e.userId):[]),l=N(()=>d.matched[1].name==="users"?"userList":"list");return(t,m)=>{var f;const _=z("router-link");return i(),u(B,null,[h(G,{items:s.value,"sortable-list-id":(f=e.pocket)==null?void 0:f.id,"sortable-group-name":"lists","class-name":"list","class-name-item":"list",onSort:T(r).sort},{default:L(({item:a})=>[h(_,{to:{name:l.value,params:{listId:a.id}},custom:""},{default:L(({isActive:n,navigate:o})=>[h(ne,{item:a,class:F(["item",(n||a.uuid===t.$route.params.id)&&"selected"]),onClick:o},null,8,["item","class","onClick"])]),_:2},1032,["to"])]),_:1},8,["items","sortable-list-id","onSort"]),s.value.length?k("",!0):(i(),u("div",re," No Lists Yet "))],64)}}});export{de as _,me as a};
