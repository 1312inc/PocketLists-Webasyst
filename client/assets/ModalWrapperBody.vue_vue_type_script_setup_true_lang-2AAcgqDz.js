import{h as y,r as m,aA as F,Y as w,o as r,j as i,I as p,u as T,c as S,G as P,s as D,aB as L,L as M,k as o,t as $,M as v,q as N,v as C,aC as x,F as _,aD as Q,D as R,C as V,w as U}from"./index-HLAoaDBG.js";const A=y({__name:"IntersectionObserver",props:{disabled:{type:Boolean}},emits:["intersecting"],setup(d,{emit:e}){const t=d,l=e,a=m(null),{stop:c}=F(a,([{isIntersecting:n}])=>{n&&!t.disabled&&l("intersecting")},{rootMargin:"200px"});return w(()=>{c()}),(n,f)=>(r(),i("div",{ref_key:"elRef",ref:a},[p(n.$slots,"default")],512))}}),E={key:0},O={class:"skeleton custom-m-24"},B=30,G=y({__name:"TaskListLazyLoadFetcher",props:{filter:{},listId:{},locationId:{},searchQuery:{}},setup(d){const e=d,t=T(),l=m(B),a=m([]),c=m(!1),{item:n}=Q(),f=S(()=>({list:{source:e.listId?t.getTasksInList(e.listId):[],isFetchStream:!1,fetchParams:e.listId?{list_id:e.listId}:{}},upnext:{source:t.getUpnext,isFetchStream:!0,fetchParams:{filter:"upnext"}},due:{source:t.getDue,isFetchStream:!0,fetchParams:{filter:"due"}},priority:{source:t.getPriority,isFetchStream:!0,fetchParams:{filter:"priority"}},nearby:{source:t.getTasksSortedByCurrentDistance,isFetchStream:!0,fetchParams:{filter:"nearby"}},search:{source:a.value,isFetchStream:!0,fetchParams:{filter:`search/${e.searchQuery}`}},location:{source:e.locationId?t.getTasksInLocation(e.locationId):[],isFetchStream:!1,fetchParams:e.locationId?{location_id:e.locationId}:{}}})[e.filter]),g=S(()=>f.value.source.slice(0,l.value));P(()=>{k()}),D(()=>e.searchQuery,()=>{c.value=!1,a.value=[],k()});const b=()=>{l.value+=B},k=async()=>{const{isFetchStream:h,fetchParams:s}=f.value;if(s.list_id&&typeof s.list_id!="number")return;let u;s.list_id&&(u=n.value.get(s.list_id));const I=await t[h?"fetchStream":"fetch"]({...s,limit:500,starting_from:u&&L(new Date(u))});I.value&&e.filter==="search"&&(a.value=[...a.value,...I.value.data],c.value=!a.value.length),s.list_id&&n.value.set(s.list_id,Date.now())};return(h,s)=>(r(),i(_,null,[p(h.$slots,"default",{tasks:g.value}),e.filter==="search"&&c.value?(r(),i("div",E,[s[0]||(s[0]=M(" No matches found for ")),o("strong",null,$(e.searchQuery),1)])):v("",!0),N(x,{name:"fade"},{default:C(()=>[g.value.length&&g.value.length<f.value.source.length?(r(),R(A,{key:0,onIntersecting:b},{default:C(()=>[o("div",O,[(r(),i(_,null,V(5,u=>o("span",{key:u,class:"skeleton-custom-box",style:{height:"40px"}})),64))])]),_:1})):v("",!0)]),_:1})],64))}}),W={class:"dialog-header"},j={class:"dialog-content"},q={class:"dialog-footer tw-flex tw-gap-2"},H=y({__name:"ModalWrapperBody",props:{title:{},hideCloseButton:{type:Boolean},hideCloseIcon:{type:Boolean}},emits:["close"],setup(d){return(e,t)=>(r(),i(_,null,[o("header",W,[o("h1",null,$(e.$props.title),1),e.hideCloseIcon?v("",!0):(r(),i("a",{key:0,class:"dialog-close",onClick:t[0]||(t[0]=U(l=>e.$emit("close"),["prevent"]))},t[2]||(t[2]=[o("i",{class:"fas fa-times"},null,-1)])))]),o("div",j,[p(e.$slots,"default")]),o("footer",q,[p(e.$slots,"submit"),e.hideCloseButton?v("",!0):(r(),i("button",{key:0,class:"button light-gray",onClick:t[1]||(t[1]=l=>e.$emit("close"))}," Close "))])],64))}});export{G as _,H as a};
