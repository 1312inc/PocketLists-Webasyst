import{h as w,r as k,G as M,K as y,o as c,j as u,L as P,M as C,u as R,E as H,B as z,D as K,v as h,k as t,N as E,q as p,z as V,w as b,O as N,t as g,m as f,P as x,Q as O,R as I,H as q,I as F,F as S,s as U,C as j}from"./index-ZYVmQ8mK.js";import{C as D}from"./ContenteditableBlock-IYCbqY_l.js";import{u as G,p as J,_ as Q}from"./SortableList.vue_vue_type_style_index_0_lang-Tcz64vGb.js";import{_ as W}from"./SearchForm.vue_vue_type_script_setup_true_lang-_qjezk7a.js";import"./rangy-5rxgwlWZ.js";const Y=w({__name:"WaDropOnElement",props:{draggableEntityName:{}},emits:["drop"],setup(_,{emit:r}){const s=r,i=_,a=k(),{getDraggingEntityName:m}=G();return M(()=>{y(a,"dragenter",e=>{i.draggableEntityName===m()&&e.currentTarget instanceof HTMLElement&&e.currentTarget.classList.add("dragover")}),y(a,"dragleave",e=>{if(e.currentTarget instanceof HTMLElement){if(e.relatedTarget&&e.currentTarget.contains(e.relatedTarget))return;e.currentTarget.classList.remove("dragover")}}),y(a,"dragover",e=>{e.preventDefault()}),y(a,"drop",e=>{if(i.draggableEntityName===m()&&e.currentTarget instanceof HTMLElement&&(e.preventDefault(),e.currentTarget.classList.remove("dragover"),e.dataTransfer))try{const l=JSON.parse(e.dataTransfer.getData("text/plain")).taskIds;s("drop",l)}catch{}})}),(e,l)=>(c(),u("div",{ref_key:"menuItemElementRef",ref:a},[P(e.$slots,"default")],512))}}),A={class:"image sortable-handle"},X={class:"details"},Z={class:"tablebox"},ee={class:"count align-right tw-flex tw-gap-1"},te={key:0,class:"hint tw-flex"},se={class:"tw-w-14 tw-truncate"},ae=w({__name:"ListsListItem",props:{item:{}},setup(_,{expose:r}){const s=_,i=C(),a=R(),m=H(),e=k(),l=k(!1);r({focus:L});const T=async o=>{l.value=!1,await i.updateItemName(s.item,o)},d=async o=>{await a.sort(s.item.id,null,o)},n=async o=>{o.target instanceof HTMLElement&&o.target.innerText&&m.push({name:"list",params:{id:s.item.id},query:{addNewTask:1}})};async function L(){l.value=!0,await z(),e.value.focus()}return(o,$)=>(c(),K(Y,{"draggable-entity-name":"tasks",onDrop:d},{default:h(()=>{var v;return[t("a",A,[t("i",{class:"userpic userpic32",style:E(`background-image: url(${s.item.icon_url||"/wa-apps/pocketlists/img/listicons/li-list@2x.png"})`)},null,4)]),t("a",X,[t("div",Z,[p(D,{ref_key:"contenteditableBlockRef",ref:e,value:o.item.name,editable:l.value,focusable:!0,placeholder:"New list",tag:"strong",onUpdate:T,onKeydown:V(b(n,["prevent"]),["enter"])},null,8,["value","editable","onKeydown"]),t("span",ee,[N(g(s.item.extended_data.items_count>0?s.item.extended_data.items_count:0)+" ",1),s.item.extended_data.items_priority_count?(c(),u("span",{key:0,class:"badge",style:E(`background-color: ${(v=f(J).get(s.item.extended_data.items_priority_value))==null?void 0:v.color}`)},g(s.item.extended_data.items_priority_count),5)):x("",!0)])]),f(O).is_debug_mode?(c(),u("p",te,[t("span",se,"id: "+g(s.item.id),1),N(" | srank: "+g(s.item.sort)+" | "+g(s.item.rank),1)])):x("",!0)])]}),_:1}))}}),ne={class:"custom-p-12"},oe={class:"heading black custom-m-0 custom-mb-8"},re={class:"pl-bg-block"},ie={key:0,class:"custom-px-16 custom-py-12 gray"},le=w({__name:"ListsList",props:{pocket:{}},setup(_){const r=_,s=I(),i=C(),a=k(!1),m=k(new Set),e=async()=>{U(m,d=>{var n;d.size>0&&((n=[...d].at(-1))==null||n.focus())},{deep:!0,once:!0}),await i.createList({pocket_id:r.pocket.id})},l=async d=>{await s.updateItemName(r.pocket,d)},T=async()=>{await s.deleteItem(r.pocket)};return(d,n)=>{const L=q("router-link");return c(),u(S,null,[t("div",ne,[t("h5",oe,[p(D,{value:r.pocket.name,tag:"span",editable:a.value,focusable:!0,placeholder:"New Pocket",onBlur:n[0]||(n[0]=o=>a.value=!1),onUpdate:l},null,8,["value","editable"]),t("a",{class:"count",onClick:n[1]||(n[1]=b(o=>a.value=!a.value,["prevent"]))},n[2]||(n[2]=[t("i",{class:"fas fa-pen"},null,-1)])),t("a",{class:"count action",onClick:b(e,["prevent"])},n[3]||(n[3]=[t("i",{class:"fas fa-plus-circle"},null,-1)])),t("a",{class:"count action",onClick:b(T,["prevent"])},n[4]||(n[4]=[t("i",{class:"fas fa-trash-alt"},null,-1)]))])]),t("div",re,[p(Q,{items:f(i).getListsInPocket([r.pocket.id]),"sortable-list-id":r.pocket.id,"sortable-group-name":"lists","class-name":"list",onSort:f(i).sort},{default:h(({item:o})=>[p(L,{to:{name:"list",params:{id:o.id}},custom:""},{default:h(({isActive:$,navigate:v})=>[p(ae,{ref:B=>m.value.add(B),item:o,class:F(["item",($||o.uuid===d.$route.params.id)&&"selected"]),"data-id":o.id,onClick:v},null,8,["item","class","data-id","onClick"])]),_:2},1032,["to"])]),_:1},8,["items","sortable-list-id","onSort"]),f(i).getListsInPocket([r.pocket.id]).length?x("",!0):(c(),u("div",ie," No Lists Yet "))])],64)}}}),ce={class:"custom-m-12"},de={class:"align-center custom-m-12"},ge=w({__name:"SidebarInner",setup(_){const r=I();return(s,i)=>(c(),u(S,null,[t("div",ce,[p(W)]),(c(!0),u(S,null,j(f(r).items,a=>(c(),u("div",{key:a.uuid||a.id,class:"custom-mb-24"},[p(le,{pocket:a},null,8,["pocket"])]))),128)),t("div",de,[t("button",{class:"gray",onClick:i[0]||(i[0]=a=>f(r).createPocket())},i[1]||(i[1]=[t("i",{class:"fa fa-plus"},null,-1)]))])],64))}});export{ge as default};
