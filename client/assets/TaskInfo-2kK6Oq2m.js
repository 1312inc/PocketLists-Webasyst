import{d as w,u as x,a as k,r as p,o as c,c as m,b as e,w as _,e as h,f as y,t as f,g as u,h as b,i as I,F as g,j as C,k as T,T as $,l as S,v as B,m as V,n as N,p as R,q as D,s as M,x as E}from"./index-_-KoVtVs.js";import{C as U}from"./ContenteditableBlock-5KGLJS8H.js";import"./rangy-5rxgwlWZ.js";const A={class:"tw-flex tw-flex-col tw-gap-2 blank box rounded tw-rounded-lg tw-rounded-tl-0 small custom-mr-16"},F={class:"tw-flex tw-gap-2"},K={class:"tw-truncate smaller"},L={class:"gray"},W={class:"gray"},j=w({__name:"TaskInfoChatItem",props:{message:{}},setup(d){const s=d,l=x(),o=k(),t=p(!1),r=()=>{o.deleteItem(s.message)},n=i=>{o.updateItem(s.message,{comment:i})};return(i,a)=>{var v;return c(),m(g,null,[e("div",A,[e("div",F,[e("a",{onClick:_(r,["prevent"])},a[1]||(a[1]=[e("i",{class:"fas fa-times"},null,-1)])),e("a",{onClick:a[0]||(a[0]=_(Q=>t.value=!0,["prevent"]))},a[2]||(a[2]=[e("i",{class:"fas fa-edit"},null,-1)]))]),h(U,{editable:t.value,focusable:!0,value:s.message.comment,tag:"div",onUpdate:n},null,8,["editable","value"])]),e("div",K,[y(f((v=u(l).getItemById(s.message.contact_id))==null?void 0:v.name)+" ",1),e("span",L,f(u(b)(u(I)(s.message)).format("ll")),1),e("span",W,f(typeof s.message.id=="number"?"delivered":"not delivered"),1)])],64)}}}),q={class:"tw-flex tw-flex-col tw-h-full"},G={class:"tw-flex-auto tw-flex tw-flex-col tw-gap-3"},P={class:"tw-flex-none tw-sticky tw-bottom-0 custom-py-12 pl-chat-input"},z={class:"state-with-inner-icon right width-100"},H=w({__name:"TaskInfoChat",props:{taskId:{}},setup(d){const s=d,l=k(),o=p(),t=p("");C(()=>s.taskId,n=>N(n)&&l.fetch({item_id:n}),{immediate:!0});const r=async()=>{const n=await l.insert(s.taskId);n&&(l.updateItem(n,{comment:t.value}),t.value="",o.value.focus())};return(n,i)=>(c(),m("div",q,[e("div",G,[h($,{name:"slide-right"},{default:T(()=>[(c(!0),m(g,null,R(u(l).getComentsByTaskId(s.taskId),a=>(c(),D(j,{key:a.uuid||a.id,message:a},null,8,["message"]))),128))]),_:1})]),e("div",P,[e("div",z,[S(e("input",{ref_key:"inputRef",ref:o,"onUpdate:modelValue":i[0]||(i[0]=a=>t.value=a),type:"text",placeholder:"Type a message",class:"width-100 blank",onKeydown:V(r,["enter"])},null,544),[[B,t.value]]),e("button",{class:"icon",onClick:r},i[1]||(i[1]=[e("i",{class:"fas fa-arrow-right"},null,-1)]))])])]))}}),J={class:"tw-h-full tw-flex tw-flex-col"},O={class:"tw-flex-auto custom-p-12 custom-pb-0 tw-overflow-scroll hide-scrollbar"},ee=w({__name:"TaskInfo",props:{taskId:{}},setup(d){const s=M(),l=()=>{var t;const o=(t=[...s.currentRoute.value.matched].reverse().find(r=>r.meta.isListView))==null?void 0:t.name;o?s.push({name:o}):console.error("Cant find back route")};return(o,t)=>(c(),m("div",J,[e("div",{class:"tw-flex-none custom-p-12"},[e("a",{class:"back larger",onClick:l},t[0]||(t[0]=[e("i",{class:"fas fa-arrow-circle-left"},null,-1)]))]),t[1]||(t[1]=E('<div class="tw-flex-none custom-px-12"><h3 class="custom-my-0">taskname</h3><ul class="chips smaller"><li><a href="#">When</a></li><li><a href="#">Where</a></li><li><a href="#">Priority</a></li><li><a href="#">Assign</a></li><li><a href="#">Attach</a></li><li><a href="#">Tags</a></li></ul><p class="hint custom-mt-0">note / sublist / created / updated / last actor / more</p></div>',1)),e("div",O,[h(H,{"task-id":o.taskId},null,8,["task-id"])])]))}});export{ee as default};
