import{d as _,u as I,a as b,r as k,o as p,c as v,b as s,w as y,e as $,f as d,t as l,g,h as C,i as T,F as x,j as B,k as h,l as R,m as S,n as M,v as U,p as V,q as D,s as N,x as A,y as E}from"./index-wxDopzhW.js";import{C as F}from"./ContenteditableBlock-W-Q-YW9B.js";import"./rangy-5rxgwlWZ.js";const K={class:"tw-flex tw-flex-col tw-gap-2 blank box rounded tw-rounded-lg tw-rounded-tl-0 small custom-mr-16"},L={class:"tw-flex tw-gap-2"},W={class:"tw-truncate smaller"},j={class:"gray"},q={class:"gray"},z=_({__name:"TaskInfoChatItem",props:{message:{}},setup(w){const a=w,c=I(),n=b(),o=k(!1),e=()=>{n.deleteItem(a.message)},t=u=>{n.updateItem(a.message,{comment:u})};return(u,i)=>{var r;return p(),v(x,null,[s("div",K,[s("div",L,[s("a",{onClick:y(e,["prevent"])},i[1]||(i[1]=[s("i",{class:"fas fa-times"},null,-1)])),s("a",{onClick:i[0]||(i[0]=y(m=>o.value=!0,["prevent"]))},i[2]||(i[2]=[s("i",{class:"fas fa-edit"},null,-1)]))]),$(F,{editable:o.value,focusable:!0,value:a.message.comment,tag:"div",onUpdate:t},null,8,["editable","value"])]),s("div",W,[d(l((r=g(c).getItemById(a.message.contact_id))==null?void 0:r.name)+" ",1),s("span",j,l(g(C)(g(T)(a.message)).format("ll")),1),s("span",q,l(typeof a.message.id=="number"?"delivered":"not delivered"),1)])],64)}}}),H={class:"tw-flex tw-flex-col tw-h-full"},P={class:"tw-flex-auto tw-flex tw-flex-col tw-gap-3"},G={class:"tw-flex-none tw-sticky tw-bottom-0 custom-py-12 pl-chat-input"},J={class:"state-with-inner-icon right width-100"},O=_({__name:"TaskInfoChat",props:{taskId:{}},emits:["update"],setup(w,{emit:a}){const c=a,n=w,o=b(),e=k(),t=k(""),u=B(()=>o.getComentsByTaskId(n.taskId));h(()=>n.taskId,r=>D(r)&&o.fetch({item_id:r}),{immediate:!0}),h(u,async()=>{u.value.length&&(await N(),c("update"))},{immediate:!0}),R(()=>{e.value.focus()}),h(()=>n.taskId,()=>{e.value.focus()});const i=async()=>{const r=await o.insert(n.taskId);r&&(o.updateItem(r,{comment:t.value}),t.value="",e.value.focus())};return(r,m)=>(p(),v("div",H,[s("div",P,[(p(!0),v(x,null,S(u.value,f=>(p(),A(z,{key:f.uuid||f.id,message:f},null,8,["message"]))),128))]),s("div",G,[s("div",J,[M(s("input",{ref_key:"inputRef",ref:e,"onUpdate:modelValue":m[0]||(m[0]=f=>t.value=f),type:"text",placeholder:"Type a message",class:"width-100 blank",onKeydown:V(i,["enter"])},null,544),[[U,t.value]]),s("button",{class:"icon",onClick:i},m[1]||(m[1]=[s("i",{class:"fas fa-arrow-right"},null,-1)]))])])]))}}),Q={class:"tw-h-full tw-flex tw-flex-col"},X={class:"tw-flex-none custom-px-12"},Y={class:"chips small"},Z={href:"#"},ss={href:"#"},ts={href:"#"},es={href:"#"},as={href:"#"},ls={class:"hint custom-mb-4"},ns={class:"hint custom-mb-4"},us=_({__name:"TaskInfo",props:{taskId:{}},setup(w){const a=E(),c=k(),n=()=>{setTimeout(()=>{c.value.scrollTo({top:c.value.scrollHeight})},100)},o=()=>{var t;const e=(t=[...a.currentRoute.value.matched].reverse().find(u=>u.meta.isListView))==null?void 0:t.name;e?a.push({name:e}):console.error("Cant find back route")};return(e,t)=>(p(),v("div",Q,[s("div",{class:"tw-flex-none custom-p-12"},[s("a",{class:"back larger",onClick:o},t[0]||(t[0]=[s("i",{class:"fas fa-arrow-circle-left"},null,-1)]))]),s("div",X,[t[6]||(t[6]=s("h3",{class:"custom-my-0"}," taskname ",-1)),s("ul",Y,[s("li",null,[s("a",Z,[t[1]||(t[1]=s("i",{class:"fas fa-calendar-alt"},null,-1)),d(" "+l(e.$t("When")),1)])]),s("li",null,[s("a",ss,[t[2]||(t[2]=s("i",{class:"fas fa-map-marker-alt"},null,-1)),d(" "+l(e.$t("Where")),1)])]),s("li",null,[s("a",ts,[t[3]||(t[3]=s("i",{class:"fas fa-exclamation-circle"},null,-1)),d(" "+l(e.$t("Priority")),1)])]),s("li",null,[s("a",es,[t[4]||(t[4]=s("i",{class:"fas fa-arrow-right"},null,-1)),d(" "+l(e.$t("Assign")),1)])]),s("li",null,[s("a",as,[t[5]||(t[5]=s("i",{class:"fas fa-paperclip"},null,-1)),d(" "+l(e.$t("Attach")),1)])])]),s("p",ls,l(e.$t("Created by")),1),t[7]||(t[7]=s("p",{class:"custom-mt-0"},[s("span",null,[s("i",{class:"icon userpic userpic-20",style:{"background-image":"url('...')"}}),d(" username ")]),s("span",{class:"hint"},"when")],-1)),s("p",ns,l(e.$t("App link")),1),t[8]||(t[8]=s("p",{class:"custom-mt-0"},[s("span",null,[s("i",{class:"icon size-20",style:{"background-image":"url('...')"}}),s("a",{href:"#",target:"_blank"},"app_linked_entity")]),s("span",{class:"hint"},"app_name")],-1)),t[9]||(t[9]=s("hr",null,null,-1))]),s("div",{ref_key:"containerRef",ref:c,class:"tw-flex-auto custom-p-12 custom-pb-0 tw-overflow-scroll hide-scrollbar"},[$(O,{"task-id":e.taskId,onUpdate:n},null,8,["task-id"])],512)]))}});export{us as default};
