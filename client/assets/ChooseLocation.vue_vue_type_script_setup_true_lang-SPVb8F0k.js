import{aL as M,d as x,y as I,a2 as C,j as f,r as d,a3 as L,k as R,aM as $,o as S,c as k,b as t,t as s,f as m,n as h,v as g,B as z}from"./index-PpPTOWQK.js";const P=async n=>{try{const{response:o}=await(await fetch(`https://geocode-maps.yandex.ru/1.x/?apikey=${M}&geocode=${n}&format=json`)).json();return o?o.GeoObjectCollection.featureMember.map(i=>i.GeoObject):[]}catch(o){return o instanceof Error&&console.error(o.message),[]}};function T(n,o,i){const r=40075016686e-3/(256*Math.pow(2,o))*Math.cos(i*(Math.PI/180));return n/r}const j={class:"tw-absolute tw-top-0 tw-left-0 tw-w-full tw-h-1/2 md:tw-h-full"},A={class:"tw-absolute tw-w-70 tw-flex tw-flex-col tw-gap-2 tw-top-16 tw-right-6 tw-z-50"},N={class:"pl-bg-block custom-p-16"},D={class:"small custom-mt-0"},V={class:"small gray"},B={class:"small"},U={class:"custom-my-12"},G={class:"custom-my-12"},H=["placeholder"],F=x({__name:"ChooseLocation",props:{lng:{},lat:{},zoom:{}},setup(n){const o=n,i=I(),p=C(),l=f(()=>Math.pow(2,21-o.zoom)*1128.49722*(w.value/1e4)),r=f(()=>Math.round(T(l.value,o.zoom,o.lat))),w=d(50),b=d(""),v=d(!1),y=L([]),u=d("");R($(b,500),e=>{if(v.value){v.value=!1;return}_(e)});const _=async e=>{y.value=await P(e)},E=async()=>{const e=await p.insert({name:u.value,location_latitude:o.lat,location_longitude:o.lng,location_radius:l.value});e&&(await p.updateItem(e,{name:u.value,location_latitude:o.lat,location_longitude:o.lng,location_radius:l.value}),i.push(`/map/${e.id}`))};return(e,a)=>(S(),k("div",j,[t("div",A,[t("div",N,[t("div",{class:"tw-absolute tw-top-2 tw-right-3 tw-cursor-pointer gray",onClick:a[0]||(a[0]=c=>e.$router.replace("/map"))},a[3]||(a[3]=[t("i",{class:"fas fa-times"},null,-1)])),t("p",D,s(e.$t("adjustLocationHint")),1),t("p",V,[m(s(e.lat),1),a[4]||(a[4]=t("br",null,null,-1)),m(" "+s(e.lng),1)]),t("div",B,[m(s(e.$t("Radius"))+": ",1),t("b",null,s(l.value&&Math.ceil(l.value))+" "+s(e.$t("m")),1)]),t("div",U,[h(t("input",{"onUpdate:modelValue":a[1]||(a[1]=c=>w.value=c),type:"range",min:"10",max:"100",class:"width-100"},null,512),[[g,w.value,void 0,{number:!0}]])]),t("div",G,[h(t("input",{"onUpdate:modelValue":a[2]||(a[2]=c=>u.value=c),type:"text",placeholder:e.$t("name"),class:"width-100"},null,8,H),[[g,u.value,void 0,{trim:!0}]])]),t("button",{onClick:E},s(e.$t("Save location")),1)])]),t("div",{class:"tw-absolute tw-top-1/2 tw-left-1/2 -tw-translate-x-1/2 -tw-translate-y-1/2 tw-z-40 tw-rounded-full tw-pointer-events-none",style:z({"background-color":"rgba(56, 56, 219, 0.4)",border:"1px solid rgb(14, 194, 219)",width:r.value+"px",height:r.value+"px"})},a[5]||(a[5]=[t("div",{class:"tw-absolute tw-top-1/2 tw-left-1/2 -tw-translate-x-1/2 -tw-translate-y-1/2"},[t("i",{class:"fas fa-map-pin text-purple",style:{"font-size":"2rem"}})],-1)]),4)]))}});export{F as _};
