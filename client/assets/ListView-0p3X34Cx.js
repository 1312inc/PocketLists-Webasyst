import{_ as S}from"./TaskListLayout.vue_vue_type_script_setup_true_lang-LKplpc4I.js";import{_ as B}from"./TaskList.vue_vue_type_script_setup_true_lang-Owy9OOZ2.js";import{h as b,r as v,X as $,Y as w,o as n,j as _,H as y,u as C,c as f,s as h,B as D,m as I,D as m,v as p,k as o,F as k,C as L,U as g,P as N,Z as O,t as T,$ as V,q as E,S as R}from"./index-C8TYz00-.js";import{_ as F}from"./VerticalGap.vue_vue_type_script_setup_true_lang-BmxjFM-h.js";import"./rangy-5rxgwlWZ.js";import"./SortableList.vue_vue_type_style_index_0_lang-4AH0Oa-B.js";const U=l=>typeof l<"u",j=b({__name:"IntersectionObserver",props:{disabled:{type:Boolean}},emits:["intersecting"],setup(l,{emit:t}){const i=l,s=t,e=v(null),{stop:c}=$(e,([{isIntersecting:r}])=>{r&&!i.disabled&&s("intersecting")},{rootMargin:"100px"});return w(()=>{c()}),(r,u)=>(n(),_("div",{ref_key:"elRef",ref:e,class:"tw-min-h-2"},[y(r.$slots,"default")],512))}}),q={class:"skeleton"},H=b({__name:"Scroller",props:{currentListId:{},fetchDisabled:{type:Boolean}},setup(l){const t=l,i=C(),s=v(0),e=v(null),c=f(()=>e.value?e.value.offset+e.value.limit<e.value.count:!1);h(()=>t.currentListId,()=>{s.value=0,e.value=null}),h(s,async()=>{if(!t.fetchDisabled){const{scrollTop:u}=document.documentElement,{data:d,...a}=await i.fetch({list_id:t.currentListId,offset:s.value});await D(),document.documentElement.scrollTop=u,e.value=a}},{immediate:!0});function r(){e.value&&(s.value+=e.value.limit)}return(u,d)=>(n(),_(k,null,[y(u.$slots,"default",{tasks:I(i).getTasksInList(t.currentListId)}),c.value?(n(),m(j,{key:0,onIntersecting:r},{default:p(()=>[o("div",q,[(n(),_(k,null,L(10,a=>o("span",{key:a,class:"skeleton-custom-box",style:{height:"60px"}})),64))])]),_:1})):g("",!0)],64))}}),M={class:"tw-px-6"},G=b({__name:"ListView",setup(l){const t=N(),i=O(),s=f(()=>R(i.params.id)),e=f(()=>t.getItemById(s.value)),c=f(()=>[e.value,...t.getSublistsInList(s.value)].filter(U)),r=()=>{e.value&&t.createList({pocket_id:e.value.pocket_id,parent_list_id:s.value})};return(u,d)=>(n(),m(S,null,{default:p(()=>[e.value?(n(),m(F,{key:0,space:4},{default:p(()=>[o("div",M,[o("h1",null,T(e.value.name),1)]),(n(!0),_(k,null,L(c.value,a=>(n(),m(H,{key:a.uuid||a.id,"current-list-id":a.id,"fetch-disabled":!I(V)(e.value)},{default:p(({tasks:x})=>[E(B,{items:x,"sortable-list-id":a.id,"addable-props":{list_id:a.id}},null,8,["items","sortable-list-id","addable-props"])]),_:2},1032,["current-list-id","fetch-disabled"]))),128)),o("div",{class:"align-center"},[o("button",{class:"gray",onClick:r},d[0]||(d[0]=[o("i",{class:"fas fa-plus"},null,-1)]))])]),_:1})):g("",!0)]),_:1}))}});export{G as default};
