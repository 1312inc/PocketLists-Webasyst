import{h as T,r as k,G as R,L as b,o as c,j as d,M as H,N as B,u as z,E as V,B as D,D as K,v as x,k as s,O as $,q as f,z as O,w,I,t as g,m as u,P as h,Q as q,R as M,s as F,H as U,S as j,F as E,C as G}from"./index-8i6VzDTN.js";import{C as P}from"./ContenteditableBlock-s3kTbLbV.js";import{u as J,p as Q,_ as W}from"./SortableList.vue_vue_type_style_index_0_lang-DkBbFsKU.js";import{_ as Y}from"./SearchForm.vue_vue_type_script_setup_true_lang-VjIQz3HF.js";import"./rangy-5rxgwlWZ.js";const A=T({__name:"WaDropOnElement",props:{draggableEntityName:{}},emits:["drop"],setup(_,{emit:r}){const t=r,n=_,a=k(),{getDraggingEntityName:m}=J();return R(()=>{b(a,"dragenter",e=>{n.draggableEntityName===m()&&e.currentTarget instanceof HTMLElement&&e.currentTarget.classList.add("dragover")}),b(a,"dragleave",e=>{if(e.currentTarget instanceof HTMLElement){if(e.relatedTarget&&e.currentTarget.contains(e.relatedTarget))return;e.currentTarget.classList.remove("dragover")}}),b(a,"dragover",e=>{e.preventDefault()}),b(a,"drop",e=>{if(n.draggableEntityName===m()&&e.currentTarget instanceof HTMLElement&&(e.preventDefault(),e.currentTarget.classList.remove("dragover"),e.dataTransfer))try{const l=JSON.parse(e.dataTransfer.getData("text/plain")).taskIds;t("drop",l)}catch{}})}),(e,l)=>(c(),d("div",{ref_key:"menuItemElementRef",ref:a},[H(e.$slots,"default")],512))}}),X={class:"image sortable-handle"},Z={class:"details"},ee={class:"tablebox"},te={class:"count align-right tw-flex tw-gap-1"},se={key:0,class:"hint tw-flex"},ae={class:"tw-w-14 tw-truncate"},ne=T({__name:"ListsListItem",props:{item:{}},setup(_,{expose:r}){const t=_,n=B(),a=z(),m=V(),e=k(),l=k(!1);r({focus:S});const L=async i=>{await n.updateItemName(t.item,i),l.value=!1},p=async i=>{await a.sort(t.item.id,null,i)},o=async i=>{i.target instanceof HTMLElement&&i.target.innerText&&m.push({name:"list",params:{id:t.item.id},query:{addNewTask:1}})};async function S(){l.value=!0,await D(),e.value.focus()}return(i,N)=>(c(),K(A,{"draggable-entity-name":"tasks",onDrop:p},{default:x(()=>{var v,y,C;return[s("a",X,[s("i",{class:"userpic userpic32",style:$(`background-image: url(${t.item.icon_url||"/wa-apps/pocketlists/img/listicons/li-list@2x.png"})`)},null,4)]),s("a",Z,[s("div",ee,[f(P,{ref_key:"contenteditableBlockRef",ref:e,value:i.item.name,editable:l.value,focusable:!0,placeholder:"New list",tag:"strong",onUpdate:L,onKeydown:O(w(o,["prevent"]),["enter"])},null,8,["value","editable","onKeydown"]),s("span",te,[I(g(t.item.extended_data.items_count>0?t.item.extended_data.items_count:0)+" ",1),t.item.extended_data.items_priority_count?(c(),d("span",{key:0,class:"badge",style:$(`background-color: ${(v=u(Q).get(t.item.extended_data.items_priority_value))==null?void 0:v.color}`)},g(t.item.extended_data.items_priority_count),5)):h("",!0)])]),u(q).is_debug_mode?(c(),d("p",se,[s("span",ae,"id: "+g(t.item.id),1),I(" | srank: "+g(String((y=t.item)==null?void 0:y.sort))+" | "+g(String((C=u(n).getItemById(t.item.id))==null?void 0:C.rank)),1)])):h("",!0)])]}),_:1}))}}),oe={class:"heading black custom-m-0 custom-mb-8"},re={class:"pl-bg-block"},ie={key:0,class:"custom-px-16 custom-py-12 gray"},le=T({__name:"ListsList",props:{pocket:{}},setup(_){const r=_,t=M(),n=B(),a=k(!1),m=k(new Set);F(m,p=>{p.size>0&&D(()=>{var o;(o=[...p].at(-1))==null||o.focus()})},{deep:!0});const e=async()=>{await n.createList({pocket_id:r.pocket.id})},l=async p=>{await t.updateItemName(r.pocket,p)},L=async()=>{await t.deleteItem(r.pocket)};return(p,o)=>{const S=U("router-link");return c(),d(E,null,[s("h5",oe,[f(P,{value:r.pocket.name,tag:"span",editable:a.value,focusable:!0,placeholder:"New Pocket",onBlur:o[0]||(o[0]=i=>a.value=!1),onUpdate:l},null,8,["value","editable"]),s("a",{class:"count",onClick:o[1]||(o[1]=w(i=>a.value=!a.value,["prevent"]))},o[2]||(o[2]=[s("i",{class:"fas fa-pen"},null,-1)])),s("a",{class:"count action",onClick:w(e,["prevent"])},o[3]||(o[3]=[s("i",{class:"fas fa-plus-circle"},null,-1)])),s("a",{class:"count action",onClick:w(L,["prevent"])},o[4]||(o[4]=[s("i",{class:"fas fa-trash-alt"},null,-1)]))]),s("div",re,[f(W,{items:u(n).getListsInPocket([r.pocket.id]),"sortable-list-id":r.pocket.id,"sortable-group-name":"lists","class-name":"list",onSort:u(n).sort},{default:x(({item:i})=>[f(S,{to:{name:"list",params:{id:i.id}},custom:""},{default:x(({isActive:N,navigate:v})=>[f(ne,{ref:y=>m.value.add(y),item:i,class:j(["item",N&&"selected"]),"data-id":i.id,onClick:v},null,8,["item","class","data-id","onClick"])]),_:2},1032,["to"])]),_:1},8,["items","sortable-list-id","onSort"]),u(n).getListsInPocket([r.pocket.id]).length?h("",!0):(c(),d("div",ie," No Lists Yet "))])],64)}}}),ce={class:"custom-mb-24"},de={class:"align-center"},ge=T({__name:"SidebarInner",setup(_){const r=M();return(t,n)=>(c(),d(E,null,[s("div",ce,[f(Y)]),(c(!0),d(E,null,G(u(r).items,a=>(c(),d("div",{key:a.uuid||a.id},[f(le,{pocket:a},null,8,["pocket"])]))),128)),s("div",de,[s("button",{class:"gray",onClick:n[0]||(n[0]=a=>u(r).createPocket())},n[1]||(n[1]=[s("i",{class:"fa fa-plus"},null,-1)]))])],64))}});export{ge as default};
