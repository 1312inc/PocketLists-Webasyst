import{d as v,r as k,o as r,e as i,f as s,J as u,t as e,aM as B,F as $,y,D as L,j as b,av as h,aN as P,aO as S,aP as g}from"./index-Yo9k-dEA.js";const T={class:"box contentbox"},E={class:"small"},N={class:"small"},j={class:"flexbox small space-12 bordered-bottom"},D={class:"tw-w-24 align-right bold"},M={class:"tw-w-24 align-right"},O={class:"tw-w-24 align-right"},V={class:"tw-w-24"},A={class:"tw-w-24 align-right bold"},C={class:"tw-w-24 align-right"},U={class:"tw-w-24 align-right"},W={class:"custom-my-24"},x={class:"hint"},F={class:"small"},R={class:"icon"},q=v({__name:"BetaView",setup(z){const c=["task","list","pocket","comment","user","location"],p={task:"Tasks",list:"Lists",pocket:"Pockets",comment:"Comments",user:"Users",location:"Locations"},d=k({}),w=async(t,l)=>{var m;const a=h.getTableByEntity(t);if(!a)return;const o=await a.toArray(),n=o.filter(_=>typeof _.id=="string").length;return{total:o.length,unsynced:n,errors:(m=l[t])==null?void 0:m.length}};(async()=>{const t=await h.jobsUpdate.filter(o=>!!o.error).toArray(),l=Object.groupBy(t,o=>o.entity),a=await Promise.all(c.map(o=>w(o,l)));d.value=Object.fromEntries(c.map((o,n)=>[o,a[n]]))})();const f=async()=>{confirm("This will flush your local browser state. Sync will restart from scratch. Proceed?")&&(P(),await S(),location.reload())};return(t,l)=>(r(),i("div",T,[s("div",null,[s("h2",null,[u(e(t.$t("betaTitle"))+" ",1),l[0]||(l[0]=s("span",{class:"hint"},"Beta",-1))]),s("p",E,e(t.$t("betaWelcomeMsg")),1),l[2]||(l[2]=B('<p class="small"><a href="mailto:hello@1312.io" class="button light-gray text-blue"><i class="fas fa-envelope custom-mr-4"></i> hello@1312.io</a><a href="https://github.com/1312inc/PocketLists-Webasyst/tree/api" class="button nobutton text-blue" target="_blank"><i class="fab fa-github custom-mr-4"></i> 1312inc/PocketLists-Webasyst</a></p><hr>',2)),s("p",N,e(t.$t("localDbStateMsg")),1),s("div",j,[l[1]||(l[1]=s("div",{class:"tw-w-24"},null,-1)),s("div",D,e(t.$t("Total")),1),s("div",M,e(t.$t("Unsynced")),1),s("div",O,e(t.$t("Error")),1)]),(r(!0),i($,null,y(d.value,(a,o)=>(r(),i("div",{key:o,class:"flexbox small space-12 bordered-bottom"},[s("div",V,e(p[o]),1),s("div",A,e(a==null?void 0:a.total),1),s("div",C,e(a==null?void 0:a.unsynced),1),s("div",U,e(a==null?void 0:a.errors),1)]))),128))]),s("div",W,[s("button",{class:"green small",onClick:f},e(t.$t("betaResetBtn")),1),s("p",x,e(t.$t("betaResetBtnHint")),1)]),s("p",F,[s("span",R,[s("i",{class:"rounded",style:L(`background: ${b(g).status.value==="OPEN"?"var(--green)":"var(--orange)"};`)},null,4)]),u(" "+e(t.$t("betaSocketLabel"))+": "+e(b(g).status.value),1)])]))}});export{q as default};
