import{d as b,r as p,I as C,i as k,o as w,c as D,b as h,t as _,e as y,O as W,F as x,n as T,E as L,L as B,N as H,V as I,W as R,y as z,P as V,X as N,Y as O,H as E,h as F,j as P,B as A,C as $,Z as M}from"./index-d-BPde6o.js";const U=typeof window<"u"&&typeof document<"u"?window:void 0,Y=(d,s)=>{const l=new Date(Date.UTC(2017,0,2)),a=[];for(let c=0;c<7;c++)a.push(l.toLocaleDateString(d,{weekday:"short"})),l.setDate(l.getDate()+1);return s||a.unshift(a.pop()),a};function j(d,s,l){let a=0,c=!1,m=0,v=null;const n=10,r=10;function f(o){const g=-o.deltaY,S=Math.abs(g);S<r||o.timeStamp-m<300&&c||(m=o.timeStamp,a<S&&!c?(g<-n?s():g>n&&l(),u(S),v&&clearTimeout(v),v=setTimeout(()=>{a===S&&i()},1e3)):S<n&&i())}function u(o){a=o,c=!0}function i(){a=n,c=!1}const t=()=>{d.value&&d.value.removeEventListener("wheel",f)},e=k(d,o=>{t(),o&&o.addEventListener("wheel",f)},{immediate:!0,flush:"post"});N()&&O(()=>{t(),e()})}function q(d,s={width:0,height:0}){const l=U;let a;const c=l&&"ResizeObserver"in l,m=p(s.width),v=p(s.height),n=([u])=>{const i=u.contentBoxSize;if(i){const t=Array.isArray(i)?i:[i];m.value=t.reduce((e,{inlineSize:o})=>e+o,0),v.value=t.reduce((e,{blockSize:o})=>e+o,0)}else m.value=u.contentRect.width,v.value=u.contentRect.height},r=()=>{a&&(a.disconnect(),a=void 0)},f=k(d,u=>{r(),c&&l&&(a=new ResizeObserver(n),u&&a.observe(u))},{immediate:!0,flush:"post"});return z(()=>{d.value&&(m.value="offsetWidth"in d.value?d.value.offsetWidth:s.width,v.value="offsetHeight"in d.value?d.value.offsetHeight:s.height)}),N()&&O(()=>{r(),f()}),{width:m,height:v}}function G(d,s,l){const a=p(1),c=p(!0),m=p(!0),{height:v}=q(d),n=C(()=>v.value/6),r=p(W()),f=C(()=>{const t=r.value.startOf("M"),e=t.get("d")+-l,o=e<0?7+e:e;return t.add(-(6*7+o),"d")}),u=C(()=>new Array(6*7*3).fill(null).map((t,e)=>{const o=f.value.add(e,"d").toDate(),g=o.toLocaleDateString();return{localeDate:g,timestamp:o.getTime(),isWeekend:[0,6].includes(o.getDay()),isCurrent:new Date().toLocaleDateString()===g,isFirstDay:o.getDate()===1,isCurrentMonth:o.getMonth()===r.value.get("M")}}));z(()=>{s.value&&(m.value=!1,s.value.style.transform=`translate3d(0px, ${-s.value.clientHeight}px, 0px)`)}),j(d,()=>{c.value&&a.value<2&&a.value++},()=>{c.value&&a.value>0&&a.value--});const i=t=>{if(s.value){const e=s.value.querySelectorAll(".icg-months-grid-day--first-day")[t];e instanceof HTMLElement&&(s.value.style.transform=`translate3d(0px, ${-e.offsetTop}px, 0px)`)}};return k(a,t=>{t===1?i(t):s.value&&(m.value=!0,c.value=!1,s.value.addEventListener("transitionend",()=>{m.value=!1,c.value=!0,r.value=r.value.add(t===0?-1:1,"month"),V(()=>{a.value=1})},{once:!0}),i(t))}),k(m,t=>{s.value&&(s.value.style.transitionProperty=t?"transform":"none")}),k(n,()=>{i(1)},{flush:"post"}),{cellHeight:n,activeMonth:r,daysInCalendar:u}}const X={class:"icg"},Z={class:"icg-header"},J={class:"icg-month"},K={class:"icg-controls"},Q=h("svg",{xmlns:"http://www.w3.org/2000/svg",height:".8rem",viewBox:"0 0 320 512"},[h("path",{d:"M9.4 233.4c-12.5 12.5-12.5 32.8 0 45.3l192 192c12.5 12.5 32.8 12.5 45.3 0s12.5-32.8 0-45.3L77.3 256 246.6 86.6c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0l-192 192z"})],-1),ee=[Q],te=h("svg",{xmlns:"http://www.w3.org/2000/svg",height:".8rem",viewBox:"0 0 320 512"},[h("path",{d:"M310.6 233.4c12.5 12.5 12.5 32.8 0 45.3l-192 192c-12.5 12.5-32.8 12.5-45.3 0s-12.5-32.8 0-45.3L242.7 256 73.4 86.6c-12.5-12.5-12.5-32.8 0-45.3s32.8-12.5 45.3 0l192 192z"})],-1),ae=[te],se={class:"icg-weekdays"},ne=b({__name:"InfiniteCalendarGrid",props:{firstDayOfWeek:{default:0},locale:{default:"en-US"},todayLabel:{default:"Today"},items:{},fieldWithDate:{}},emits:["changeInterval"],setup(d,{emit:s}){const l=d,a=s,c=p(null),m=p(null),{cellHeight:v,activeMonth:n,daysInCalendar:r}=G(c,m,l.firstDayOfWeek),f=Y(l.locale,l.firstDayOfWeek),u=C(()=>{const i={};for(const t of l.items){const e=t[l.fieldWithDate];if(typeof e=="string"||typeof e=="number"){const o=new Date(e);if(!isNaN(o.getTime())){const g=o.toLocaleDateString();i[g]?i[g].push(t):i[g]=[t]}}}return i});return k(r,i=>{a("changeInterval",{start:i[0].timestamp,end:i[i.length-1].timestamp})},{immediate:!0,flush:"post"}),(i,t)=>(w(),D("div",X,[h("div",Z,[h("div",J,_(y(n).toDate().toLocaleDateString(l.locale,{year:"numeric",month:"long"}).replace("Ð³.","")),1),h("div",K,[h("button",{onClick:t[0]||(t[0]=e=>n.value=y(n).add(-1,"M"))},ee),h("button",{onClick:t[1]||(t[1]=e=>n.value=y(W)())},_(l.todayLabel),1),h("button",{onClick:t[2]||(t[2]=e=>n.value=y(n).add(1,"M"))},ae)])]),h("div",se,[(w(!0),D(x,null,T(y(f),(e,o)=>(w(),D("div",{key:e,class:L(["icg-weekdays-cell",{"icg-weekdays-cell--weekend":o===(l.firstDayOfWeek?5:0)||o===6}])},_(e),3))),128))]),h("div",{ref_key:"wrapperRef",ref:c,class:"icg-wrapper"},[h("div",{ref_key:"containerRef",ref:m,class:"icg-months-grid"},[(w(!0),D(x,null,T(y(r),e=>(w(),D("div",{key:e.timestamp,class:L(["icg-months-grid-day",{"icg-months-grid-day--active-month":e.isCurrentMonth,"icg-months-grid-day--first-day":e.isFirstDay,"icg-months-grid-day--weekend":e.isWeekend,"icg-months-grid-day--current":e.isCurrent}]),style:B({height:`${y(v)}px`})},[H(i.$slots,"default",I(R({date:e,items:u.value[e.localeDate]})))],6))),128))],512)],512)]))}}),ie={class:"tw-relative tw-h-full"},oe={class:"pl-calendar-day"},le={key:0},re={class:"custom-p-8 custom-pt-40"},ue=b({__name:"CalendarView",setup(d){const s=E(),l=p(),a=p(),c=C(()=>[...s.getTasksCompleted,...s.getDue].filter(n=>{const r=u=>u>l.value&&u<a.value;if(n.complete_datetime){const u=new Date(n.complete_datetime).getTime();return r(u)}if(!n.due_date)return!1;const f=new Date(n.due_date).getTime();return r(f)})),m=({start:n,end:r})=>{l.value=n,a.value=r,s.fetch({status:1}),s.fetchStream({filter:"due"})};function v(n){try{return n.toLocaleString(M,{month:"short"})}catch{}}return(n,r)=>(w(),D("div",ie,[F(y(ne),{items:c.value,"field-with-date":"due_date",locale:y(M),onChangeInterval:m},{default:P(({date:f,items:u})=>[h("div",oe,[A(_(new Date(f.timestamp).getDate())+" ",1),new Date(f.timestamp).getDate()===1?(w(),D("span",le,_(v(new Date(f.timestamp))),1)):$("",!0)]),h("div",re,[(w(!0),D(x,null,T(u,i=>(w(),D("div",{key:i.uuid||i.id},_(i.name),1))),128))])]),_:1},8,["items","locale"])]))}});export{ue as default};
