import{d as v,r as k,o as i,e as c,f as s,K as n,t as o,F as $,x as B,D as y,j as m,as as g,aL as L,aM as S,aN as h}from"./index-npZA7Hpi.js";const T={class:"box contentbox"},E={class:"small"},P={class:"small"},M={href:"https://support.webasyst.ru/forum/ideas/",class:"button light-gray text-blue custom-mr-8",target:"_blank"},j={class:"small"},D={class:"flexbox small space-12 bordered-bottom"},N={class:"tw-w-24 align-right bold"},A={class:"tw-w-24 align-right"},C={class:"tw-w-24 align-right"},F={class:"tw-w-24"},O={class:"tw-w-24 align-right bold"},U={class:"tw-w-24 align-right"},V={class:"tw-w-24 align-right"},W={class:"custom-my-24"},x={class:"hint"},H={class:"small"},R={class:"icon"},z={class:"hint"},I=v({__name:"BetaView",setup(K){const d=["task","list","pocket","comment","user","location"],p={task:"Tasks",list:"Lists",pocket:"Pockets",comment:"Comments",user:"Users",location:"Locations"},u=k({}),f=async(a,t)=>{var b;const e=g.getTableByEntity(a);if(!e)return;const l=await e.toArray(),r=l.filter(_=>typeof _.id=="string").length;return{total:l.length,unsynced:r,errors:(b=t[a])==null?void 0:b.length}};(async()=>{const a=await g.jobsUpdate.filter(l=>!!l.error).toArray(),t=Object.groupBy(a,l=>l.entity),e=await Promise.all(d.map(l=>f(l,t)));u.value=Object.fromEntries(d.map((l,r)=>[l,e[r]]))})();const w=async()=>{confirm("This will flush your local browser state. Sync will restart from scratch. Proceed?")&&(L(),await S(),location.reload())};return(a,t)=>(i(),c("div",T,[s("div",null,[s("h2",null,[n(o(a.$t("betaTitle"))+" ",1),t[0]||(t[0]=s("span",{class:"hint"},"Beta",-1))]),s("p",E,o(a.$t("betaWelcomeMsg")),1),s("p",P,[s("a",M,[t[1]||(t[1]=s("i",{class:"fas fa-magic custom-mr-4"},null,-1)),n(" "+o(a.$t("shareFeedbackMsg")),1)]),t[2]||(t[2]=s("a",{href:"mailto:hello@1312.io",class:"button nobutton text-blue"},[s("i",{class:"fas fa-envelope custom-mr-4"}),n(" hello@1312.io")],-1)),t[3]||(t[3]=s("a",{href:"https://github.com/1312inc/PocketLists-Webasyst/tree/api",class:"button nobutton text-blue",target:"_blank"},[s("i",{class:"fab fa-github custom-mr-4"}),n(" 1312inc/PocketLists-Webasyst")],-1))]),t[5]||(t[5]=s("hr",null,null,-1)),s("p",j,o(a.$t("localDbStateMsg")),1),s("div",D,[t[4]||(t[4]=s("div",{class:"tw-w-24"},null,-1)),s("div",N,o(a.$t("Total")),1),s("div",A,o(a.$t("Unsynced")),1),s("div",C,o(a.$t("Error")),1)]),(i(!0),c($,null,B(u.value,(e,l)=>(i(),c("div",{key:l,class:"flexbox small space-12 bordered-bottom"},[s("div",F,o(p[l]),1),s("div",O,o(e==null?void 0:e.total),1),s("div",U,o(e==null?void 0:e.unsynced),1),s("div",V,o(e==null?void 0:e.errors),1)]))),128))]),s("div",W,[s("button",{class:"green small",onClick:w},o(a.$t("betaResetBtn")),1),s("p",x," ↑ "+o(a.$t("betaResetBtnHint")),1)]),t[6]||(t[6]=s("hr",null,null,-1)),s("p",H,[s("span",R,[s("i",{class:"rounded",style:y(`background: ${m(h).status.value==="OPEN"?"var(--green)":"var(--orange)"};`)},null,4)]),n(" "+o(a.$t("betaSocketLabel"))+": ",1),s("b",null,o(m(h).status.value),1)]),s("p",z," ↑ "+o(a.$t("betaSocketHint")),1)]))}});export{I as default};
