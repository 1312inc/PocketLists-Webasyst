import{h as y,r as h,aA as $,K as F,o,j as l,X as p,u as b,c as _,s as P,M as T,k as a,t as S,N as v,q as w,v as k,aB as L,F as g,D as N,C as M,w as x}from"./index-4X9ivWVs.js";const D=y({__name:"IntersectionObserver",props:{disabled:{type:Boolean}},emits:["intersecting"],setup(d,{emit:e}){const t=d,n=e,s=h(null),{stop:u}=$(s,([{isIntersecting:r}])=>{r&&!t.disabled&&n("intersecting")},{rootMargin:"200px"});return F(()=>{u()}),(r,f)=>(o(),l("div",{ref_key:"elRef",ref:s},[p(r.$slots,"default")],512))}}),R={key:0},V={class:"skeleton custom-m-24"},I=30,O=y({__name:"TaskListLazyLoadFetcher",props:{filter:{},listId:{},locationId:{},userId:{},searchQuery:{}},setup(d){const e=d,t=b(),n=h(I),s=h([]),u=h(!1),r=_(()=>({list:{source:e.listId?t.getTasksInList(e.listId):[],isFetchStream:!1,fetchParams:e.listId?{list_id:e.listId}:{}},upnext:{source:t.getUpnext,isFetchStream:!0,fetchParams:{filter:"upnext"}},due:{source:t.getDue,isFetchStream:!0,fetchParams:{filter:"due"}},priority:{source:t.getPriority,isFetchStream:!0,fetchParams:{filter:"priority"}},nearby:{source:t.getTasksSortedByCurrentDistance,isFetchStream:!0,fetchParams:{filter:"nearby"}},search:{source:s.value,isFetchStream:!0,fetchParams:{filter:`search/${e.searchQuery}`}},location:{source:e.locationId?t.getTasksInLocation(e.locationId):[],isFetchStream:!1,fetchParams:e.locationId?{location_id:e.locationId}:{}},user:{source:e.userId?t.getTasksByUser(e.userId):[],isFetchStream:!1,fetchParams:e.userId?{assigned_contact_id:e.userId}:{}},completed:{source:t.getTasksCompleted,isFetchStream:!1,fetchParams:{status:1}}})[e.filter]),f=_(()=>r.value.source.slice(0,n.value));P(()=>e,C,{deep:!0,immediate:!0});const B=()=>{n.value+=I};async function C(){const{isFetchStream:m,fetchParams:i}=r.value;if(i.list_id&&typeof i.list_id!="number")return;u.value=!1,s.value=[];const c=await t[m?"fetchStream":"fetch"]({...i});c&&c.value&&c.value.status_code==="ok"&&e.filter==="search"&&(s.value=[...s.value,...c.value.data],u.value=!s.value.length)}return(m,i)=>(o(),l(g,null,[p(m.$slots,"default",{tasks:f.value}),e.filter==="search"&&u.value?(o(),l("div",R,[i[0]||(i[0]=T(" No matches found for ")),a("strong",null,S(e.searchQuery),1)])):v("",!0),w(L,{name:"fade"},{default:k(()=>[f.value.length&&f.value.length<r.value.source.length?(o(),N(D,{key:0,onIntersecting:B},{default:k(()=>[a("div",V,[(o(),l(g,null,M(5,c=>a("span",{key:c,class:"skeleton-custom-box",style:{height:"40px"}})),64))])]),_:1})):v("",!0)]),_:1})],64))}}),Q={class:"dialog-header"},U={class:"dialog-content"},A={class:"dialog-footer tw-flex tw-gap-2"},j=y({__name:"ModalWrapperBody",props:{title:{},hideCloseButton:{type:Boolean},hideCloseIcon:{type:Boolean}},emits:["close"],setup(d){return(e,t)=>(o(),l(g,null,[a("header",Q,[a("h1",null,S(e.$props.title),1),e.hideCloseIcon?v("",!0):(o(),l("a",{key:0,class:"dialog-close",onClick:t[0]||(t[0]=x(n=>e.$emit("close"),["prevent"]))},t[2]||(t[2]=[a("i",{class:"fas fa-times"},null,-1)])))]),a("div",U,[p(e.$slots,"default")]),a("footer",A,[p(e.$slots,"submit"),e.hideCloseButton?v("",!0):(o(),l("button",{key:0,class:"button light-gray",onClick:t[1]||(t[1]=n=>e.$emit("close"))}," Close "))])],64))}});export{O as _,j as a};
