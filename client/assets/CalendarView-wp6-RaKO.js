import{d as W,r as w,I as C,i as k,o as p,c as y,b as h,t as _,e as D,O as z,F as x,n as T,E as L,L as H,N as I,V as R,W as V,y as N,P as E,X as O,Y as B,H as F,h as P,j as A,B as $,C as M,Z as b}from"./index-zS2JIE3S.js";const U=typeof window<"u"&&typeof document<"u"?window:void 0,Y=(u,n)=>{const l=new Date(Date.UTC(2017,0,2)),a=[];for(let c=0;c<7;c++)a.push(l.toLocaleDateString(u,{weekday:"short"})),l.setDate(l.getDate()+1);return n||a.unshift(a.pop()),a};function j(u,n,l){let a=0,c=!1,m=0,v=null;const i=10,r=10;function f(o){const g=-o.deltaY,S=Math.abs(g);S<r||o.timeStamp-m<300&&c||(m=o.timeStamp,a<S&&!c?(g<-i?n():g>i&&l(),d(S),v&&clearTimeout(v),v=setTimeout(()=>{a===S&&s()},1e3)):S<i&&s())}function d(o){a=o,c=!0}function s(){a=i,c=!1}const t=()=>{u.value&&u.value.removeEventListener("wheel",f)},e=k(u,o=>{t(),o&&o.addEventListener("wheel",f)},{immediate:!0,flush:"post"});O()&&B(()=>{t(),e()})}function q(u,n={width:0,height:0}){const l=U;let a;const c=l&&"ResizeObserver"in l,m=w(n.width),v=w(n.height),i=([d])=>{const s=d.contentBoxSize;if(s){const t=Array.isArray(s)?s:[s];m.value=t.reduce((e,{inlineSize:o})=>e+o,0),v.value=t.reduce((e,{blockSize:o})=>e+o,0)}else m.value=d.contentRect.width,v.value=d.contentRect.height},r=()=>{a&&(a.disconnect(),a=void 0)},f=k(u,d=>{r(),c&&l&&(a=new ResizeObserver(i),d&&a.observe(d))},{immediate:!0,flush:"post"});return N(()=>{u.value&&(m.value="offsetWidth"in u.value?u.value.offsetWidth:n.width,v.value="offsetHeight"in u.value?u.value.offsetHeight:n.height)}),O()&&B(()=>{r(),f()}),{width:m,height:v}}function G(u,n,l){const a=w(1),c=w(!0),m=w(!0),{height:v}=q(u),i=C(()=>v.value/6),r=w(z()),f=C(()=>{const t=r.value.startOf("M"),e=t.get("d")+-l,o=e<0?7+e:e;return t.add(-(6*7+o),"d")}),d=C(()=>new Array(6*7*3).fill(null).map((t,e)=>{const o=f.value.add(e,"d").toDate(),g=o.toLocaleDateString();return{localeDate:g,timestamp:o.getTime(),isWeekend:[0,6].includes(o.getDay()),isCurrent:new Date().toLocaleDateString()===g,isFirstDay:o.getDate()===1,isCurrentMonth:o.getMonth()===r.value.get("M")}}));N(()=>{n.value&&(m.value=!1,n.value.style.transform=`translate3d(0px, ${-n.value.clientHeight}px, 0px)`)}),j(u,()=>{c.value&&a.value<2&&a.value++},()=>{c.value&&a.value>0&&a.value--});const s=t=>{if(n.value){const e=n.value.querySelectorAll(".icg-months-grid-day--first-day")[t];e instanceof HTMLElement&&(n.value.style.transform=`translate3d(0px, ${-e.offsetTop}px, 0px)`)}};return k(a,t=>{t===1?s(t):n.value&&(m.value=!0,c.value=!1,n.value.addEventListener("transitionend",()=>{m.value=!1,c.value=!0,r.value=r.value.add(t===0?-1:1,"month"),E(()=>{a.value=1})},{once:!0}),s(t))}),k(m,t=>{n.value&&(n.value.style.transitionProperty=t?"transform":"none")}),k(i,()=>{s(1)},{flush:"post"}),{cellHeight:i,activeMonth:r,daysInCalendar:d}}const X={class:"icg"},Z={class:"icg-header"},J={class:"icg-month"},K={class:"icg-controls"},Q=h("svg",{xmlns:"http://www.w3.org/2000/svg",height:".8rem",viewBox:"0 0 320 512"},[h("path",{d:"M9.4 233.4c-12.5 12.5-12.5 32.8 0 45.3l192 192c12.5 12.5 32.8 12.5 45.3 0s12.5-32.8 0-45.3L77.3 256 246.6 86.6c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0l-192 192z"})],-1),ee=[Q],te=h("svg",{xmlns:"http://www.w3.org/2000/svg",height:".8rem",viewBox:"0 0 320 512"},[h("path",{d:"M310.6 233.4c12.5 12.5 12.5 32.8 0 45.3l-192 192c-12.5 12.5-32.8 12.5-45.3 0s-12.5-32.8 0-45.3L242.7 256 73.4 86.6c-12.5-12.5-12.5-32.8 0-45.3s32.8-12.5 45.3 0l192 192z"})],-1),ae=[te],se={class:"icg-weekdays"},ne=W({__name:"InfiniteCalendarGrid",props:{firstDayOfWeek:{default:0},locale:{default:"en-US"},todayLabel:{default:"Today"},items:{},fieldWithDate:{}},emits:["changeInterval"],setup(u,{emit:n}){const l=u,a=n,c=w(null),m=w(null),{cellHeight:v,activeMonth:i,daysInCalendar:r}=G(c,m,l.firstDayOfWeek),f=Y(l.locale,l.firstDayOfWeek),d=C(()=>{const s={};for(const t of l.items){const e=t[l.fieldWithDate];if(typeof e=="string"||typeof e=="number"){const o=new Date(e);if(!isNaN(o.getTime())){const g=o.toLocaleDateString();s[g]?s[g].push(t):s[g]=[t]}}}return s});return k(r,s=>{a("changeInterval",{start:s[0].timestamp,end:s[s.length-1].timestamp})},{immediate:!0,flush:"post"}),(s,t)=>(p(),y("div",X,[h("div",Z,[h("div",J,_(D(i).toDate().toLocaleDateString(l.locale,{year:"numeric",month:"long"}).replace("Ð³.","")),1),h("div",K,[h("button",{onClick:t[0]||(t[0]=e=>i.value=D(i).add(-1,"M"))},ee),h("button",{onClick:t[1]||(t[1]=e=>i.value=D(z)())},_(l.todayLabel),1),h("button",{onClick:t[2]||(t[2]=e=>i.value=D(i).add(1,"M"))},ae)])]),h("div",se,[(p(!0),y(x,null,T(D(f),(e,o)=>(p(),y("div",{key:e,class:L(["icg-weekdays-cell",{"icg-weekdays-cell--weekend":o===(l.firstDayOfWeek?5:0)||o===6}])},_(e),3))),128))]),h("div",{ref_key:"wrapperRef",ref:c,class:"icg-wrapper"},[h("div",{ref_key:"containerRef",ref:m,class:"icg-months-grid"},[(p(!0),y(x,null,T(D(r),e=>(p(),y("div",{key:e.timestamp,class:L(["icg-months-grid-day",{"icg-months-grid-day--active-month":e.isCurrentMonth,"icg-months-grid-day--first-day":e.isFirstDay,"icg-months-grid-day--weekend":e.isWeekend,"icg-months-grid-day--current":e.isCurrent}]),style:H({height:`${D(v)}px`})},[I(s.$slots,"default",R(V({date:e,items:d.value[e.localeDate]})))],6))),128))],512)],512)]))}}),ie={class:"tw-relative tw-h-full"},oe={class:"pl-calendar-day"},le={key:0},re={class:"custom-p-8 custom-pt-40"},ce={key:0},de={class:"small tw-truncate"},me=W({__name:"CalendarView",setup(u){const n=F(),l=w(),a=w(),c=C(()=>[...n.getTasksCompleted,...n.getDue].filter(i=>{const r=d=>d>l.value&&d<a.value;if(i.complete_datetime){const d=new Date(i.complete_datetime).getTime();return r(d)}if(!i.due_date)return!1;const f=new Date(i.due_date).getTime();return r(f)})),m=({start:i,end:r})=>{l.value=i,a.value=r,n.fetch({status:1}),n.fetchStream({filter:"due"})};function v(i){try{return i.toLocaleString(b,{month:"short"})}catch{}}return(i,r)=>(p(),y("div",ie,[P(D(ne),{items:c.value,"field-with-date":"due_date",locale:D(b),onChangeInterval:m},{default:A(({date:f,items:d})=>[h("div",oe,[$(_(new Date(f.timestamp).getDate())+" ",1),new Date(f.timestamp).getDate()===1?(p(),y("span",le,_(v(new Date(f.timestamp))),1)):M("",!0)]),h("div",re,[(p(!0),y(x,null,T(d,s=>(p(),y("div",{key:s.uuid||s.id,class:"flexbox middle space-4"},[s.complete_datetime?(p(),y("div",ce,r[0]||(r[0]=[h("i",{class:"small fas fa-check"},null,-1)]))):M("",!0),h("div",de,_(s.name),1)]))),128))])]),_:1},8,["items","locale"])]))}});export{me as default};
