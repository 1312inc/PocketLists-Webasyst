import{h as y,r as v,G as M,H as b,o as c,j as d,I as R,J as E,u as P,E as H,B as C,D as K,v as T,k as s,K as N,q as f,z as V,w as L,L as x,t as k,m as _,M as $,N as q,O as I,P as z,Q as O,F as w,R as B,C as F}from"./index-GGDBCzmZ.js";import{_ as J}from"./SearchForm.vue_vue_type_script_setup_true_lang-8HRECXG8.js";import{C as D}from"./ContenteditableBlock-yx_nYYs5.js";import{u as U,p as j,_ as G}from"./SortableList.vue_vue_type_style_index_0_lang-l7X9-r8L.js";import"./rangy-5rxgwlWZ.js";const Q=y({__name:"WaDropOnElement",props:{draggableEntityName:{}},emits:["drop"],setup(m,{emit:t}){const r=t,n=m,a=v(),{getDraggingEntityName:l}=U();return M(()=>{b(a,"dragenter",e=>{n.draggableEntityName===l()&&e.currentTarget instanceof HTMLElement&&e.currentTarget.classList.add("dragover")}),b(a,"dragleave",e=>{if(e.currentTarget instanceof HTMLElement){if(e.relatedTarget&&e.currentTarget.contains(e.relatedTarget))return;e.currentTarget.classList.remove("dragover")}}),b(a,"dragover",e=>{e.preventDefault()}),b(a,"drop",e=>{if(n.draggableEntityName===l()&&e.currentTarget instanceof HTMLElement&&(e.preventDefault(),e.currentTarget.classList.remove("dragover"),e.dataTransfer))try{const u=JSON.parse(e.dataTransfer.getData("text/plain")).taskIds;r("drop",u)}catch{}})}),(e,u)=>(c(),d("div",{ref_key:"menuItemElementRef",ref:a},[R(e.$slots,"default")],512))}}),W={class:"image sortable-handle"},Y={class:"details"},A={class:"tablebox"},X={class:"count align-right tw-flex tw-gap-1"},Z={key:0,class:"hint tw-flex"},tt={class:"tw-w-14 tw-truncate"},et=y({__name:"ListsListItem",props:{item:{}},setup(m){const t=m,r=E(),n=P(),a=H(),l=v(),e=v(!1),u=async o=>{e.value=!1,await r.updateItem(t.item,{name:o},{quietly:typeof t.item.pocket_id=="string"})},g=async o=>{await n.sort(t.item.id,null,o)},h=async o=>{o.target instanceof HTMLElement&&o.target.innerText&&a.push({name:"list",params:{id:t.item.id},query:{addNewTask:1}})};I("focusList").on(o=>{o===t.item.id&&i()});const i=async()=>{e.value=!0,await C(),l.value.focus()};return(o,ct)=>(c(),K(Q,{"draggable-entity-name":"tasks",onDrop:g},{default:T(()=>{var S;return[s("a",W,[s("i",{class:"userpic userpic32",style:N(`background-image: url(${t.item.icon_url||"/wa-apps/pocketlists/img/listicons/li-list@2x.png"})`)},null,4)]),s("a",Y,[s("div",A,[f(D,{ref_key:"contenteditableBlockRef",ref:l,value:o.item.name,editable:e.value,focusable:!0,placeholder:o.$t("newList"),tag:"strong",onUpdate:u,onKeydown:V(L(h,["prevent"]),["enter"])},null,8,["value","editable","placeholder","onKeydown"]),s("span",X,[x(k(t.item.extended_data.items_count>0?t.item.extended_data.items_count:0)+" ",1),t.item.extended_data.items_priority_count?(c(),d("span",{key:0,class:"badge",style:N(`background-color: ${(S=_(j).get(t.item.extended_data.items_priority_value))==null?void 0:S.color}`)},k(t.item.extended_data.items_priority_count),5)):$("",!0)])]),_(q).is_debug_mode?(c(),d("p",Z,[s("span",tt,"id: "+k(t.item.id),1),x(" | srank: "+k(t.item.sort)+" | "+k(t.item.rank),1)])):$("",!0)])]}),_:1}))}}),st={key:0,class:"custom-px-16 custom-py-12 gray"},at=y({__name:"ListsList",props:{pocket:{}},setup(m){const t=m,r=E();return(n,a)=>{const l=z("router-link");return c(),d(w,null,[f(G,{items:_(r).getListsInPocket(t.pocket.id),"sortable-list-id":t.pocket.id,"sortable-group-name":"lists","class-name":"list","class-name-item":"list",onSort:_(r).sort},{default:T(({item:e})=>[f(l,{to:{name:"list",params:{id:e.id}},custom:""},{default:T(({isActive:u,navigate:g})=>[f(et,{item:e,class:O(["item",(u||e.uuid===n.$route.params.id)&&"selected"]),onClick:g},null,8,["item","class","onClick"])]),_:2},1032,["to"])]),_:1},8,["items","sortable-list-id","onSort"]),_(r).getListsInPocket(t.pocket.id).length?$("",!0):(c(),d("div",st," No Lists Yet "))],64)}}}),nt={class:"custom-p-12"},ot={class:"heading black custom-m-0 custom-mb-8"},rt=y({__name:"PocketsListItem",props:{pocket:{}},setup(m){const t=m,r=B(),n=E(),a=v(!1),l=v(),e=async()=>{const p=await n.createList({pocket_id:t.pocket.id});if(!p)return;I("focusList").emit(p.id)},u=async()=>{a.value=!0,await C(),l.value.focus()},g=async p=>{await r.updateItemName(t.pocket,p)},h=async()=>{await r.deleteItem(t.pocket)};return(p,i)=>(c(),d(w,null,[s("div",nt,[s("h5",ot,[f(D,{ref_key:"pocketNameRef",ref:l,value:t.pocket.name,tag:"div",editable:a.value,focusable:!0,placeholder:p.$t("newPocket"),onBlur:i[0]||(i[0]=o=>a.value=!1),onUpdate:g},null,8,["value","editable","placeholder"]),s("a",{class:"count",onClick:L(u,["prevent"])},i[1]||(i[1]=[s("i",{class:"fas fa-pen"},null,-1)])),s("a",{class:"count action",onClick:L(e,["prevent"])},i[2]||(i[2]=[s("i",{class:"fas fa-plus-circle"},null,-1)])),s("a",{class:"count action",onClick:L(h,["prevent"])},i[3]||(i[3]=[s("i",{class:"fas fa-trash-alt"},null,-1)]))])]),f(at,{pocket:p.pocket},null,8,["pocket"])],64))}}),it={class:"custom-m-12"},lt={class:"align-center custom-m-12"},_t=y({__name:"SidebarInner",setup(m){const t=B();return(r,n)=>(c(),d(w,null,[s("div",it,[f(J)]),(c(!0),d(w,null,F(_(t).items,a=>(c(),d("div",{key:a.uuid||a.id,class:"custom-mb-24"},[f(rt,{pocket:a},null,8,["pocket"])]))),128)),s("div",lt,[s("button",{class:"gray",onClick:n[0]||(n[0]=a=>_(t).createPocket())},n[1]||(n[1]=[s("i",{class:"fa fa-plus"},null,-1)]))])],64))}});export{_t as default};
