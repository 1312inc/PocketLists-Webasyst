import{h as L,r as E,G as V,L as y,o as u,j as m,M as K,N as R,u as O,E as U,H as j,D as q,v as w,k as t,m as d,O as z,t as k,I as T,P as N,q as p,Q as F,R as G,z as J,w as _,S as M,F as x,B as Q,U as W,C as Y}from"./index-l4PKbJcP.js";import{C as P}from"./ContenteditableBlock-mxm5OTBn.js";import{u as A,_ as X,a as Z}from"./LazyRender.vue_vue_type_script_setup_true_lang-MUepH-sM.js";import{_ as tt}from"./SearchForm.vue_vue_type_script_setup_true_lang-qBKK-MRa.js";import"./rangy-5rxgwlWZ.js";const et=L({__name:"WaDropOnElement",props:{draggableEntityName:{}},emits:["drop"],setup(g,{emit:o}){const s=o,a=g,n=E(),{getDraggingEntityName:i}=A();return V(()=>{y(n,"dragenter",e=>{a.draggableEntityName===i()&&e.currentTarget instanceof HTMLElement&&e.currentTarget.classList.add("dragover")}),y(n,"dragleave",e=>{if(e.currentTarget instanceof HTMLElement){if(e.relatedTarget&&e.currentTarget.contains(e.relatedTarget))return;e.currentTarget.classList.remove("dragover")}}),y(n,"dragover",e=>{e.preventDefault()}),y(n,"drop",e=>{if(a.draggableEntityName===i()&&e.currentTarget instanceof HTMLElement&&(e.preventDefault(),e.currentTarget.classList.remove("dragover"),e.dataTransfer))try{const f=JSON.parse(e.dataTransfer.getData("text/plain")).taskIds;s("drop",f)}catch{}})}),(e,f)=>(u(),m("div",{ref_key:"menuItemElementRef",ref:n},[K(e.$slots,"default")],512))}}),st={class:"tw-group tw-relative custom-p-16"},at={key:0},nt={class:"hint"},ot={class:"hint"},rt={class:"hint"},it={class:"tw-flex tw-gap-4 tw-justify-between"},lt={key:0,class:"badge red"},ct={class:"tw-flex tw-gap-2"},dt=L({__name:"ListsListItem",props:{item:{}},setup(g,{expose:o}){const s=g,a=R(),n=O(),i=U(),e=E();o({focus:v});const f=l=>{a.updateItemName(s.item,l)},S=()=>{a.deleteItem(s.item),i.push({name:"lists"})},b=async l=>{await n.sort(s.item.id,null,l)},r=async l=>{l.target instanceof HTMLElement&&l.target.innerText&&i.push({name:"list",params:{id:s.item.id},query:{addNewTask:1}})};function v(){e.value.focus()}return(l,c)=>{const H=j("RouterLink");return u(),q(et,{"draggable-entity-name":"tasks",onDrop:b},{default:w(()=>{var C,I,$,h,B,D;return[t("div",st,[c[4]||(c[4]=t("div",{class:"sortable-handle tw-cursor-grabbing tw-absolute -tw-translate-x-4 tw-hidden group-hover:tw-block"},[t("i",{class:"fas fa-grip-vertical"})],-1)),t("div",null,[d(z).is_debug_mode?(u(),m("div",at,[t("span",nt,"id: "+k((C=s.item)==null?void 0:C.id),1),c[0]||(c[0]=T(" | ")),t("span",ot,"prev_id: "+k(String((I=s.item)==null?void 0:I.prev_item_id)),1),c[1]||(c[1]=T(" | ")),t("span",rt,"srank: "+k(String(($=s.item)==null?void 0:$.sort))+" | "+k(String((h=d(a).getItemById(s.item.id))==null?void 0:h.rank)),1)])):N("",!0),t("div",it,[p(H,{to:{name:"list",params:{id:s.item.id}},class:"tw-flex-auto"},{default:w(()=>[t("div",{class:F({"tw-bg-yellow":d(G)(d(i).currentRoute.value.params.id)===s.item.id||d(i).currentRoute.value.params.id===s.item.uuid})},[p(P,{ref_key:"contenteditableBlockRef",ref:e,value:l.item.name,editable:!0,focusable:!0,placeholder:"New list",tag:"span",onUpdate:f,onKeydown:J(_(r,["prevent"]),["enter"])},null,8,["value","onKeydown"])],2)]),_:1},8,["to"]),T(" "+k((B=s.item.extended_data)==null?void 0:B.items_count)+" ",1),(D=s.item.extended_data)!=null&&D.items_priority_count?(u(),m("div",lt,k(s.item.extended_data.items_priority_count),1)):N("",!0),t("div",ct,[t("a",{class:"count",onClick:_(v,["prevent"])},c[2]||(c[2]=[t("i",{class:"fas fa-pen"},null,-1)])),t("a",{class:"count",onClick:_(S,["prevent"])},c[3]||(c[3]=[t("i",{class:"fas fa-trash-alt"},null,-1)]))])])])])]}),_:1})}}}),ut={class:"heading black custom-m-0 custom-mb-8"},pt={class:"pl-bg-block"},mt={key:0,class:"custom-px-16 custom-py-12 gray"},ft=L({__name:"ListsList",props:{pocket:{}},setup(g){const o=g,s=M(),a=R(),n=E(!1),i=[],e=async()=>{await a.createList({pocket_id:o.pocket.id}),await Q(),i.at(-1).focus()},f=b=>{s.updateItemName(o.pocket,b)},S=()=>{s.deleteItem(o.pocket)};return(b,r)=>(u(),m(x,null,[t("h5",ut,[p(P,{value:o.pocket.name,tag:"span",editable:n.value,focusable:!0,placeholder:"New Pocket",onBlur:r[0]||(r[0]=v=>n.value=!1),onUpdate:f},null,8,["value","editable"]),t("a",{class:"count",onClick:r[1]||(r[1]=_(v=>n.value=!n.value,["prevent"]))},r[2]||(r[2]=[t("i",{class:"fas fa-pen"},null,-1)])),t("a",{class:"count action",onClick:_(e,["prevent"])},r[3]||(r[3]=[t("i",{class:"fas fa-plus-circle"},null,-1)])),t("a",{class:"count action",onClick:_(S,["prevent"])},r[4]||(r[4]=[t("i",{class:"fas fa-trash-alt"},null,-1)]))]),t("div",pt,[p(Z,{items:d(a).getListsInPocket(o.pocket.id),"sortable-list-id":o.pocket.id,"sortable-group-name":"lists",onSort:d(a).sort},{default:w(({item:v})=>[p(X,{style:{height:"auto"}},{default:w(()=>[p(dt,{ref:l=>i.push(l),item:v},null,8,["item"])]),_:2},1024)]),_:1},8,["items","sortable-list-id","onSort"]),d(a).getListsInPocket(o.pocket.id).length?N("",!0):(u(),m("div",mt," No Lists Yet "))])],64))}}),gt={class:"align-center"},wt=L({__name:"SidebarInner",setup(g){const o=M();return(s,a)=>(u(),m(x,null,[p(tt),a[2]||(a[2]=W('<div class="bricks"><div class="brick pl-bg-block"><span class="icon"><i class="fas fa-star"></i></span><span class="count">495</span> Star </div><div class="brick pl-bg-block"><span class="icon"><i class="fas fa-bolt"></i></span><span class="count">33</span> Bolt </div></div>',1)),(u(!0),m(x,null,Y(d(o).items,n=>(u(),m("div",{key:n.uuid||n.id},[p(ft,{pocket:n},null,8,["pocket"])]))),128)),t("div",gt,[t("button",{class:"gray",onClick:a[0]||(a[0]=n=>d(o).createPocket())},a[1]||(a[1]=[t("i",{class:"fa fa-plus"},null,-1)]))])],64))}});export{wt as default};
