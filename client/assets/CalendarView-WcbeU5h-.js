import{d as b,r as p,j as C,k,o as w,c as D,b as m,t as _,e as y,S as T,F as x,s as M,K as L,$ as O,A as N,a0 as R,a1 as B,z,q as H,a2 as W,a3 as I,i as V,h as A,l as E,C as F,J as $}from"./index-tuoj8TDQ.js";const P=typeof window<"u"&&typeof document<"u"?window:void 0,U=(c,n)=>{const i=new Date(Date.UTC(2017,0,2)),a=[];for(let r=0;r<7;r++)a.push(i.toLocaleDateString(c,{weekday:"short"})),i.setDate(i.getDate()+1);return n||a.unshift(a.pop()),a};function q(c,n,i){let a=0,r=!1,d=0,u=null;const l=10,h=10;function f(s){const g=-s.deltaY,S=Math.abs(g);S<h||s.timeStamp-d<300&&r||(d=s.timeStamp,a<S&&!r?(g<-l?n():g>l&&i(),v(S),u&&clearTimeout(u),u=setTimeout(()=>{a===S&&o()},1e3)):S<l&&o())}function v(s){a=s,r=!0}function o(){a=l,r=!1}const t=()=>{c.value&&c.value.removeEventListener("wheel",f)},e=k(c,s=>{t(),s&&s.addEventListener("wheel",f)},{immediate:!0,flush:"post"});W()&&I(()=>{t(),e()})}function j(c,n={width:0,height:0}){const i=P;let a;const r=i&&"ResizeObserver"in i,d=p(n.width),u=p(n.height),l=([v])=>{const o=v.contentBoxSize;if(o){const t=Array.isArray(o)?o:[o];d.value=t.reduce((e,{inlineSize:s})=>e+s,0),u.value=t.reduce((e,{blockSize:s})=>e+s,0)}else d.value=v.contentRect.width,u.value=v.contentRect.height},h=()=>{a&&(a.disconnect(),a=void 0)},f=k(c,v=>{h(),r&&i&&(a=new ResizeObserver(l),v&&a.observe(v))},{immediate:!0,flush:"post"});return z(()=>{c.value&&(d.value="offsetWidth"in c.value?c.value.offsetWidth:n.width,u.value="offsetHeight"in c.value?c.value.offsetHeight:n.height)}),W()&&I(()=>{h(),f()}),{width:d,height:u}}function G(c,n,i){const a=p(1),r=p(!0),d=p(!0),{height:u}=j(c),l=C(()=>u.value/6),h=p(T()),f=C(()=>{const t=h.value.startOf("M"),e=t.get("d")+-i,s=e<0?7+e:e;return t.add(-(6*7+s),"d")}),v=C(()=>new Array(6*7*3).fill(null).map((t,e)=>{const s=f.value.add(e,"d").toDate(),g=s.toLocaleDateString();return{localeDate:g,timestamp:s.getTime(),isWeekend:[0,6].includes(s.getDay()),isCurrent:new Date().toLocaleDateString()===g,isFirstDay:s.getDate()===1,isCurrentMonth:s.getMonth()===h.value.get("M")}}));z(()=>{n.value&&(d.value=!1,n.value.style.transform=`translate3d(0px, ${-n.value.clientHeight}px, 0px)`)}),q(c,()=>{r.value&&a.value<2&&a.value++},()=>{r.value&&a.value>0&&a.value--});const o=t=>{if(n.value){const e=n.value.querySelectorAll(".icg-months-grid-day--first-day")[t];e instanceof HTMLElement&&(n.value.style.transform=`translate3d(0px, ${-e.offsetTop}px, 0px)`)}};return k(a,t=>{t===1?o(t):n.value&&(d.value=!0,r.value=!1,n.value.addEventListener("transitionend",()=>{d.value=!1,r.value=!0,h.value=h.value.add(t===0?-1:1,"month"),H(()=>{a.value=1})},{once:!0}),o(t))}),k(d,t=>{n.value&&(n.value.style.transitionProperty=t?"transform":"none")}),k(l,()=>{o(1)},{flush:"post"}),{cellHeight:l,activeMonth:h,daysInCalendar:v}}const J={class:"icg"},K={class:"icg-header"},Y={class:"icg-month"},Q={class:"icg-controls"},X=m("svg",{xmlns:"http://www.w3.org/2000/svg",height:".8rem",viewBox:"0 0 320 512"},[m("path",{d:"M9.4 233.4c-12.5 12.5-12.5 32.8 0 45.3l192 192c12.5 12.5 32.8 12.5 45.3 0s12.5-32.8 0-45.3L77.3 256 246.6 86.6c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0l-192 192z"})],-1),Z=[X],ee=m("svg",{xmlns:"http://www.w3.org/2000/svg",height:".8rem",viewBox:"0 0 320 512"},[m("path",{d:"M310.6 233.4c12.5 12.5 12.5 32.8 0 45.3l-192 192c-12.5 12.5-32.8 12.5-45.3 0s-12.5-32.8 0-45.3L242.7 256 73.4 86.6c-12.5-12.5-12.5-32.8 0-45.3s32.8-12.5 45.3 0l192 192z"})],-1),te=[ee],ae={class:"icg-weekdays"},se=b({__name:"InfiniteCalendarGrid",props:{firstDayOfWeek:{default:0},locale:{default:"en-US"},todayLabel:{default:"Today"},items:{},fieldWithDate:{}},emits:["changeInterval"],setup(c,{emit:n}){const i=c,a=n,r=p(null),d=p(null),{cellHeight:u,activeMonth:l,daysInCalendar:h}=G(r,d,i.firstDayOfWeek),f=U(i.locale,i.firstDayOfWeek),v=C(()=>{const o={};for(const t of i.items){const e=t[i.fieldWithDate];if(typeof e=="string"||typeof e=="number"){const s=new Date(e);if(!isNaN(s.getTime())){const g=s.toLocaleDateString();o[g]?o[g].push(t):o[g]=[t]}}}return o});return k(h,o=>{a("changeInterval",{start:o[0].timestamp,end:o[o.length-1].timestamp})},{immediate:!0,flush:"post"}),(o,t)=>(w(),D("div",J,[m("div",K,[m("div",Y,_(y(l).toDate().toLocaleDateString(i.locale,{year:"numeric",month:"long"}).replace("Ð³.","")),1),m("div",Q,[m("button",{onClick:t[0]||(t[0]=e=>l.value=y(l).add(-1,"M"))},Z),m("button",{onClick:t[1]||(t[1]=e=>l.value=y(T)())},_(i.todayLabel),1),m("button",{onClick:t[2]||(t[2]=e=>l.value=y(l).add(1,"M"))},te)])]),m("div",ae,[(w(!0),D(x,null,M(y(f),(e,s)=>(w(),D("div",{key:e,class:L(["icg-weekdays-cell",{"icg-weekdays-cell--weekend":s===(i.firstDayOfWeek?5:0)||s===6}])},_(e),3))),128))]),m("div",{ref_key:"wrapperRef",ref:r,class:"icg-wrapper"},[m("div",{ref_key:"containerRef",ref:d,class:"icg-months-grid"},[(w(!0),D(x,null,M(y(h),e=>(w(),D("div",{key:e.timestamp,class:L(["icg-months-grid-day",{"icg-months-grid-day--active-month":e.isCurrentMonth,"icg-months-grid-day--first-day":e.isFirstDay,"icg-months-grid-day--weekend":e.isWeekend,"icg-months-grid-day--current":e.isCurrent}]),style:O({height:`${y(u)}px`})},[N(o.$slots,"default",R(B({date:e,items:v.value[e.localeDate]})))],6))),128))],512)],512)]))}}),ne={class:"tw-relative tw-h[100vh]"},ie={class:"pl-calendar-day"},oe={key:0},le={class:"tw-p-2 tw-pt-10"},ce=b({__name:"CalendarView",setup(c){const n=V(),i=p(""),a=p(""),r=({start:u,end:l})=>{i.value=u,a.value=l};function d(u){try{return u.toLocaleString("en-US".replace("_","-"),{month:"short"})}catch{}}return(u,l)=>(w(),D("div",ne,[A(y(se),{items:y(n).getTasksInInterval(i.value,a.value),"field-with-date":"due_datetime",onChangeInterval:r},{default:E(({date:h,items:f})=>[m("div",ie,[F(_(new Date(h.timestamp).getDate())+" ",1),new Date(h.timestamp).getDate()===1?(w(),D("span",oe,_(d(new Date(h.timestamp))),1)):$("",!0)]),m("div",le,[(w(!0),D(x,null,M(f,v=>(w(),D("div",{key:v.uuid||v.id},_(v.name),1))),128))])]),_:1},8,["items"])]))}});export{ce as default};
