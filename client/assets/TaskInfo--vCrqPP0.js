import{d as y,u as $,a as x,r as v,o as p,c as k,b as t,w as _,e as I,f as c,t as u,g,h as C,i as T,F as b,j as B,k as h,l as R,m as S,n as M,v as U,p as V,q as D,s as N,x as E,y as A}from"./index-cbrQSLvZ.js";import{C as F}from"./ContenteditableBlock-Ccm9KLJ7.js";import"./rangy-5rxgwlWZ.js";const K={class:"tw-flex tw-flex-col tw-gap-2 blank box rounded tw-rounded-lg tw-rounded-tl-0 small custom-mr-16"},L={class:"tw-flex tw-gap-2"},W={class:"tw-truncate smaller"},j={class:"gray"},q={class:"gray"},H=y({__name:"TaskInfoChatItem",props:{message:{}},setup(w){const a=w,d=$(),l=x(),o=v(!1),e=()=>{l.deleteItem(a.message)},s=r=>{l.updateItem(a.message,{comment:r})};return(r,n)=>{var i;return p(),k(b,null,[t("div",K,[t("div",L,[t("a",{onClick:_(e,["prevent"])},n[1]||(n[1]=[t("i",{class:"fas fa-times"},null,-1)])),t("a",{onClick:n[0]||(n[0]=_(m=>o.value=!0,["prevent"]))},n[2]||(n[2]=[t("i",{class:"fas fa-edit"},null,-1)]))]),I(F,{editable:o.value,focusable:!0,value:a.message.comment,tag:"div",onUpdate:s},null,8,["editable","value"])]),t("div",W,[c(u((i=g(d).getItemById(a.message.contact_id))==null?void 0:i.name)+" ",1),t("span",j,u(g(C)(g(T)(a.message)).format("ll")),1),t("span",q,u(typeof a.message.id=="number"?"delivered":"not delivered"),1)])],64)}}}),P={class:"tw-flex tw-flex-col tw-h-full"},z={class:"tw-flex-auto tw-flex tw-flex-col tw-gap-3"},G={class:"tw-flex-none tw-sticky tw-bottom-0 custom-py-12 pl-chat-input"},J={class:"state-with-inner-icon right width-100"},O=y({__name:"TaskInfoChat",props:{taskId:{}},emits:["update"],setup(w,{emit:a}){const d=a,l=w,o=x(),e=v(),s=v(""),r=B(()=>o.getComentsByTaskId(l.taskId));h(()=>l.taskId,i=>D(i)&&o.fetch({item_id:i}),{immediate:!0}),h(r,async()=>{r.value.length&&(await N(),d("update"))},{immediate:!0}),R(()=>{e.value.focus()}),h(()=>l.taskId,()=>{e.value.focus()});const n=async()=>{const i=await o.insert(l.taskId);i&&(o.updateItem(i,{comment:s.value}),s.value="",e.value.focus())};return(i,m)=>(p(),k("div",P,[t("div",z,[(p(!0),k(b,null,S(r.value,f=>(p(),E(H,{key:f.uuid||f.id,message:f},null,8,["message"]))),128))]),t("div",G,[t("div",J,[M(t("input",{ref_key:"inputRef",ref:e,"onUpdate:modelValue":m[0]||(m[0]=f=>s.value=f),type:"text",placeholder:"Type a message",class:"width-100 blank",onKeydown:V(n,["enter"])},null,544),[[U,s.value]]),t("button",{class:"icon",onClick:n},m[1]||(m[1]=[t("i",{class:"fas fa-arrow-right"},null,-1)]))])])]))}}),Q={class:"tw-h-full tw-flex tw-flex-col"},X={class:"tw-flex-none custom-px-12"},Y={class:"chips small"},Z={href:"#"},tt={href:"#"},st={href:"#"},et={href:"#"},at={href:"#"},it=y({__name:"TaskInfo",props:{taskId:{}},setup(w){const a=A(),d=v(),l=()=>{setTimeout(()=>{d.value.scrollTo({top:d.value.scrollHeight})},100)},o=()=>{var s;const e=(s=[...a.currentRoute.value.matched].reverse().find(r=>r.meta.isListView))==null?void 0:s.name;e?a.push({name:e}):console.error("Cant find back route")};return(e,s)=>(p(),k("div",Q,[t("div",{class:"tw-flex-none custom-p-12"},[t("a",{class:"back larger",onClick:o},s[0]||(s[0]=[t("i",{class:"fas fa-arrow-circle-left"},null,-1)]))]),t("div",X,[s[6]||(s[6]=t("h3",{class:"custom-my-0"}," taskname ",-1)),t("ul",Y,[t("li",null,[t("a",Z,[s[1]||(s[1]=t("i",{class:"fas fa-calendar-alt"},null,-1)),c(" "+u(e.$t("When")),1)])]),t("li",null,[t("a",tt,[s[2]||(s[2]=t("i",{class:"fas fa-map-marker-alt"},null,-1)),c(" "+u(e.$t("Where")),1)])]),t("li",null,[t("a",st,[s[3]||(s[3]=t("i",{class:"fas fa-exclamation-circle"},null,-1)),c(" "+u(e.$t("Priority")),1)])]),t("li",null,[t("a",et,[s[4]||(s[4]=t("i",{class:"fas fa-arrow-right"},null,-1)),c(" "+u(e.$t("Assign")),1)])]),t("li",null,[t("a",at,[s[5]||(s[5]=t("i",{class:"fas fa-paperclip"},null,-1)),c(" "+u(e.$t("Attach")),1)])])]),s[7]||(s[7]=t("p",{class:"hint custom-mt-0"}," note / sublist / amount / external link ss t etc / plugins / more ",-1)),s[8]||(s[8]=t("p",{class:"hint"}," follow / unfollow ",-1)),s[9]||(s[9]=t("p",{class:"hint"}," created / updated / last actor ",-1))]),t("div",{ref_key:"containerRef",ref:d,class:"tw-flex-auto custom-p-12 custom-pb-0 tw-overflow-scroll hide-scrollbar"},[I(O,{"task-id":e.taskId,onUpdate:l},null,8,["task-id"])],512)]))}});export{it as default};
