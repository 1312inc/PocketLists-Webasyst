import{aq as I,d as h,o as w,c as v,b as e,t as g,w as E,I as y,E as b,F as L,y as R,a4 as $,r as u,x as S,l as B,m as M,v as k,j as _,a3 as A,k as x,ar as z,Y as P,ap as D}from"./index-FRWD2OZN.js";const T=async a=>{try{const{response:t}=await(await fetch(`https://geocode-maps.yandex.ru/1.x/?apikey=${I}&geocode=${a}&format=json`)).json();return t?t.GeoObjectCollection.featureMember.map(o=>o.GeoObject):[]}catch(t){return t instanceof Error&&console.error(t.message),[]}},j={class:"dialog-header"},N={class:"dialog-content"},V={class:"dialog-footer"},F=h({__name:"ModalWrapperBody",props:{title:{},hideCloseButton:{type:Boolean},hideCloseIcon:{type:Boolean}},emits:["close"],setup(a){return(t,o)=>(w(),v(L,null,[e("header",j,[e("h1",null,g(t.$props.title),1),t.hideCloseIcon?y("",!0):(w(),v("a",{key:0,class:"dialog-close",onClick:o[0]||(o[0]=E(s=>t.$emit("close"),["prevent"]))},o[2]||(o[2]=[e("i",{class:"fas fa-times"},null,-1)])))]),e("div",N,[b(t.$slots,"default")]),e("footer",V,[b(t.$slots,"submit"),t.hideCloseButton?y("",!0):(w(),v("button",{key:0,class:"button light-gray",onClick:o[1]||(o[1]=s=>t.$emit("close"))}," Close "))])],64))}}),U=h({__name:"ChooseLocationCreate",props:{lat:{},lng:{},radius:{}},emits:["close"],setup(a,{emit:t}){const o=t,s=a,d=R(),c=$(),p=u(""),m=async()=>{const i=await c.insert({name:p.value,location_latitude:s.lat,location_longitude:s.lng,location_radius:s.radius});i&&(d.push(`/map/${i.id}`),o("close"))};return(i,r)=>(w(),S(F,{title:"Add Location",onClose:r[1]||(r[1]=f=>o("close"))},{default:B(()=>[M(e("input",{"onUpdate:modelValue":r[0]||(r[0]=f=>p.value=f),type:"text",placeholder:"Location"},null,512),[[k,p.value]]),e("button",{onClick:m}," Add ")]),_:1}))}});function Y(a,t,o){const c=40075016686e-3/(256*Math.pow(2,t))*Math.cos(o*(Math.PI/180));return a/c}const G={class:"tw-absolute tw-top-0 tw-left-0 tw-w-full tw-h-full"},O={class:"tw-absolute tw-flex tw-flex-col tw-gap-2 tw-top-12 tw-right-2 tw-z-50"},H={class:"pl-bg-block tw-p-4 tw-rounded-md"},W={class:"tw-flex tw-items-center tw-gap-2 tw-my-2"},Z={class:"tw-flex-auto"},K=h({__name:"ChooseLocation",props:{lng:{},lat:{},zoom:{}},setup(a){const t=a,o=u(50),s=_(()=>Math.pow(2,21-t.zoom)*1128.49722*(o.value/1e4)),d=_(()=>Math.round(Y(s.value,t.zoom,t.lat)));$();const c=u(""),p=u(!1),m=u(!1),i=A([]);u(),x(i,({length:l})=>{p.value=!!l}),x(z(c,500),l=>{if(m.value){m.value=!1;return}r(l)});const r=async l=>{i.value=await T(l)},f=()=>{D(U,{lat:t.lat,lng:t.lng,radius:s.value}).show()};return(l,n)=>(w(),v("div",G,[e("div",O,[e("div",H,[n[2]||(n[2]=e("h6",null," Current locations ",-1)),e("div",null,"Lat: "+g(l.lat),1),e("div",null,"Lng: "+g(l.lng),1),e("div",null,"Radius: "+g(s.value&&Math.ceil(s.value))+" m",1),e("div",W,[e("div",Z,[M(e("input",{"onUpdate:modelValue":n[0]||(n[0]=C=>o.value=C),type:"range",min:"10",max:"100",class:"tw-w-full"},null,512),[[k,o.value,void 0,{number:!0}]])]),e("a",{class:"gray smaller",onClick:n[1]||(n[1]=E(C=>o.value=50,["prevent"]))},"reset")]),e("div",{class:"tw-flex tw-gap-2"},[e("button",{onClick:f}," Create ")])])]),e("div",{class:"tw-absolute tw-top-1/2 tw-left-1/2 -tw-translate-x-1/2 -tw-translate-y-1/2 tw-z-40 tw-rounded-full tw-pointer-events-none",style:P({"background-color":"rgba(56, 56, 219, 0.4)",border:"1px solid rgb(14, 194, 219)",width:d.value+"px",height:d.value+"px"})},n[3]||(n[3]=[e("div",{class:"tw-absolute tw-top-1/2 tw-left-1/2 -tw-translate-x-1/2 -tw-translate-y-1/2"},[e("i",{class:"fas fa-map-pin text-purple",style:{"font-size":"2rem"}})],-1)]),4)]))}});export{K as _};
