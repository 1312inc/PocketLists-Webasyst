import{h as y,r as b,G as q,L,o as u,j as p,M as D,N as M,u as z,E as K,H as U,D as j,v as I,k as t,m as d,O as F,t as k,I as x,P as T,q as f,Q as G,R as J,z as Q,w as _,S as W,B as O,U as P,F as N,V as Y,C as A}from"./index-YMyNYm53.js";import{C as V}from"./ContenteditableBlock-lexJPhgI.js";import{u as X,_ as Z}from"./SortableList.vue_vue_type_style_index_0_lang-8oqupcxG.js";import{_ as tt}from"./SearchForm.vue_vue_type_script_setup_true_lang-Ng1WO6Af.js";import"./rangy-5rxgwlWZ.js";const et=y({__name:"WaDropOnElement",props:{draggableEntityName:{}},emits:["drop"],setup(m,{emit:o}){const e=o,a=m,n=b(),{getDraggingEntityName:r}=X();return q(()=>{L(n,"dragenter",s=>{a.draggableEntityName===r()&&s.currentTarget instanceof HTMLElement&&s.currentTarget.classList.add("dragover")}),L(n,"dragleave",s=>{if(s.currentTarget instanceof HTMLElement){if(s.relatedTarget&&s.currentTarget.contains(s.relatedTarget))return;s.currentTarget.classList.remove("dragover")}}),L(n,"dragover",s=>{s.preventDefault()}),L(n,"drop",s=>{if(a.draggableEntityName===r()&&s.currentTarget instanceof HTMLElement&&(s.preventDefault(),s.currentTarget.classList.remove("dragover"),s.dataTransfer))try{const g=JSON.parse(s.dataTransfer.getData("text/plain")).taskIds;e("drop",g)}catch{}})}),(s,g)=>(u(),p("div",{ref_key:"menuItemElementRef",ref:n},[D(s.$slots,"default")],512))}}),st={class:"tw-group tw-relative custom-p-16"},at={key:0},nt={class:"hint"},ot={class:"hint"},rt={class:"hint"},it={class:"tw-flex tw-gap-4 tw-justify-between"},lt={key:0,class:"badge red"},ct={class:"tw-flex tw-gap-2"},dt=y({__name:"ListsListItem",props:{item:{}},setup(m,{expose:o}){const e=m,a=M(),n=z(),r=K(),s=b();o({focus:v});const g=l=>{a.updateItemName(e.item,l)},S=()=>{a.deleteItem(e.item),r.push({name:"lists"})},w=async l=>{await n.sort(e.item.id,null,l)},i=async l=>{l.target instanceof HTMLElement&&l.target.innerText&&r.push({name:"list",params:{id:e.item.id},query:{addNewTask:1}})};function v(){s.value.focus()}return(l,c)=>{const H=U("RouterLink");return u(),j(et,{"draggable-entity-name":"tasks",onDrop:w},{default:I(()=>{var C,h,E,$,R,B;return[t("div",st,[c[4]||(c[4]=t("div",{class:"sortable-handle tw-cursor-grabbing tw-absolute -tw-translate-x-4 tw-hidden group-hover:tw-block"},[t("i",{class:"fas fa-grip-vertical"})],-1)),t("div",null,[d(F).is_debug_mode?(u(),p("div",at,[t("span",nt,"id: "+k((C=e.item)==null?void 0:C.id),1),c[0]||(c[0]=x(" | ")),t("span",ot,"prev_id: "+k(String((h=e.item)==null?void 0:h.prev_item_id)),1),c[1]||(c[1]=x(" | ")),t("span",rt,"srank: "+k(String((E=e.item)==null?void 0:E.sort))+" | "+k(String(($=d(a).getItemById(e.item.id))==null?void 0:$.rank)),1)])):T("",!0),t("div",it,[f(H,{to:{name:"list",params:{id:e.item.id}},class:"tw-flex-auto"},{default:I(()=>[t("div",{class:G({"tw-bg-yellow":d(J)(d(r).currentRoute.value.params.id)===e.item.id||d(r).currentRoute.value.params.id===e.item.uuid})},[f(V,{ref_key:"contenteditableBlockRef",ref:s,value:l.item.name,editable:!0,focusable:!0,placeholder:"New list",tag:"span",onUpdate:g,onKeydown:Q(_(i,["prevent"]),["enter"])},null,8,["value","onKeydown"])],2)]),_:1},8,["to"]),x(" "+k((R=e.item.extended_data)==null?void 0:R.items_count)+" ",1),(B=e.item.extended_data)!=null&&B.items_priority_count?(u(),p("div",lt,k(e.item.extended_data.items_priority_count),1)):T("",!0),t("div",ct,[t("a",{class:"count",onClick:_(v,["prevent"])},c[2]||(c[2]=[t("i",{class:"fas fa-pen"},null,-1)])),t("a",{class:"count",onClick:_(S,["prevent"])},c[3]||(c[3]=[t("i",{class:"fas fa-trash-alt"},null,-1)]))])])])])]}),_:1})}}}),ut=y({__name:"LazyRender",props:{renderOnIdle:{type:Boolean}},setup(m){const o=b(null),e=b(!1),{stop:a}=W(o,([{isIntersecting:r}])=>{r&&(e.value=!0,a())},{rootMargin:"600px"});m.renderOnIdle&&n(()=>{e.value=!0,a()});function n(r){"requestIdleCallback"in window?window.requestIdleCallback(r):setTimeout(()=>{O(r)},300)}return(r,s)=>(u(),p("div",{ref_key:"targetRef",ref:o,style:{height:"100px"}},[e.value?D(r.$slots,"default",{key:0}):T("",!0)],512))}}),pt={class:"heading black custom-m-0 custom-mb-8"},mt={class:"pl-bg-block"},ft={key:0,class:"custom-px-16 custom-py-12 gray"},gt=y({__name:"ListsList",props:{pocket:{}},setup(m){const o=m,e=P(),a=M(),n=b(!1),r=[],s=async()=>{await a.createList({pocket_id:o.pocket.id}),await O(),r.at(-1).focus()},g=w=>{e.updateItemName(o.pocket,w)},S=()=>{e.deleteItem(o.pocket)};return(w,i)=>(u(),p(N,null,[t("h5",pt,[f(V,{value:o.pocket.name,tag:"span",editable:n.value,focusable:!0,placeholder:"New Pocket",onBlur:i[0]||(i[0]=v=>n.value=!1),onUpdate:g},null,8,["value","editable"]),t("a",{class:"count",onClick:i[1]||(i[1]=_(v=>n.value=!n.value,["prevent"]))},i[2]||(i[2]=[t("i",{class:"fas fa-pen"},null,-1)])),t("a",{class:"count action",onClick:_(s,["prevent"])},i[3]||(i[3]=[t("i",{class:"fas fa-plus-circle"},null,-1)])),t("a",{class:"count action",onClick:_(S,["prevent"])},i[4]||(i[4]=[t("i",{class:"fas fa-trash-alt"},null,-1)]))]),t("div",mt,[f(Z,{items:d(a).getListsInPocket(o.pocket.id),"sortable-list-id":o.pocket.id,"sortable-group-name":"lists",onSort:d(a).sort},{default:I(({item:v})=>[f(ut,{style:{height:"auto"}},{default:I(()=>[f(dt,{ref:l=>r.push(l),item:v},null,8,["item"])]),_:2},1024)]),_:1},8,["items","sortable-list-id","onSort"]),d(a).getListsInPocket(o.pocket.id).length?T("",!0):(u(),p("div",ft," No Lists Yet "))])],64))}}),vt={class:"align-center"},Lt=y({__name:"SidebarInner",setup(m){const o=P();return(e,a)=>(u(),p(N,null,[f(tt),a[2]||(a[2]=Y('<div class="bricks"><div class="brick pl-bg-block"><span class="icon"><i class="fas fa-star"></i></span><span class="count">495</span> Star </div><div class="brick pl-bg-block"><span class="icon"><i class="fas fa-bolt"></i></span><span class="count">33</span> Bolt </div></div>',1)),(u(!0),p(N,null,A(d(o).items,n=>(u(),p("div",{key:n.uuid||n.id},[f(gt,{pocket:n},null,8,["pocket"])]))),128)),t("div",vt,[t("button",{class:"gray",onClick:a[0]||(a[0]=n=>d(o).createPocket())},a[1]||(a[1]=[t("i",{class:"fa fa-plus"},null,-1)]))])],64))}});export{Lt as default};
