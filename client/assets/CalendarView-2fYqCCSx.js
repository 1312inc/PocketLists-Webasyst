import{h as T,r as p,c as C,s as k,o as w,j as D,k as m,t as _,m as y,X as b,F as x,C as L,R as M,N as O,J as N,a2 as R,a3 as B,L as z,B as H,a4 as W,a5 as I,u as V,q as E,v as F,O as A,I as P}from"./index-hDrHKEuz.js";const U=typeof window<"u"&&typeof document<"u"?window:void 0,$=(c,n)=>{const i=new Date(Date.UTC(2017,0,2)),a=[];for(let r=0;r<7;r++)a.push(i.toLocaleDateString(c,{weekday:"short"})),i.setDate(i.getDate()+1);return n||a.unshift(a.pop()),a};function q(c,n,i){let a=0,r=!1,u=0,d=null;const l=10,v=10;function f(s){const g=-s.deltaY,S=Math.abs(g);S<v||s.timeStamp-u<300&&r||(u=s.timeStamp,a<S&&!r?(g<-l?n():g>l&&i(),h(S),d&&clearTimeout(d),d=setTimeout(()=>{a===S&&o()},1e3)):S<l&&o())}function h(s){a=s,r=!0}function o(){a=l,r=!1}const t=()=>{c.value&&c.value.removeEventListener("wheel",f)},e=k(c,s=>{t(),s&&s.addEventListener("wheel",f)},{immediate:!0,flush:"post"});W()&&I(()=>{t(),e()})}function j(c,n={width:0,height:0}){const i=U;let a;const r=i&&"ResizeObserver"in i,u=p(n.width),d=p(n.height),l=([h])=>{const o=h.contentBoxSize;if(o){const t=Array.isArray(o)?o:[o];u.value=t.reduce((e,{inlineSize:s})=>e+s,0),d.value=t.reduce((e,{blockSize:s})=>e+s,0)}else u.value=h.contentRect.width,d.value=h.contentRect.height},v=()=>{a&&(a.disconnect(),a=void 0)},f=k(c,h=>{v(),r&&i&&(a=new ResizeObserver(l),h&&a.observe(h))},{immediate:!0,flush:"post"});return z(()=>{c.value&&(u.value="offsetWidth"in c.value?c.value.offsetWidth:n.width,d.value="offsetHeight"in c.value?c.value.offsetHeight:n.height)}),W()&&I(()=>{v(),f()}),{width:u,height:d}}function G(c,n,i){const a=p(1),r=p(!0),u=p(!0),{height:d}=j(c),l=C(()=>d.value/6),v=p(b()),f=C(()=>{const t=v.value.startOf("M"),e=t.get("d")+-i,s=e<0?7+e:e;return t.add(-(6*7+s),"d")}),h=C(()=>new Array(6*7*3).fill(null).map((t,e)=>{const s=f.value.add(e,"d").toDate(),g=s.toLocaleDateString();return{localeDate:g,timestamp:s.getTime(),isWeekend:[0,6].includes(s.getDay()),isCurrent:new Date().toLocaleDateString()===g,isFirstDay:s.getDate()===1,isCurrentMonth:s.getMonth()===v.value.get("M")}}));z(()=>{n.value&&(u.value=!1,n.value.style.transform=`translate3d(0px, ${-n.value.clientHeight}px, 0px)`)}),q(c,()=>{r.value&&a.value<2&&a.value++},()=>{r.value&&a.value>0&&a.value--});const o=t=>{if(n.value){const e=n.value.querySelectorAll(".icg-months-grid-day--first-day")[t];e instanceof HTMLElement&&(n.value.style.transform=`translate3d(0px, ${-e.offsetTop}px, 0px)`)}};return k(a,t=>{t===1?o(t):n.value&&(u.value=!0,r.value=!1,n.value.addEventListener("transitionend",()=>{u.value=!1,r.value=!0,v.value=v.value.add(t===0?-1:1,"month"),H(()=>{a.value=1})},{once:!0}),o(t))}),k(u,t=>{n.value&&(n.value.style.transitionProperty=t?"transform":"none")}),k(l,()=>{o(1)},{flush:"post"}),{cellHeight:l,activeMonth:v,daysInCalendar:h}}const J={class:"icg"},X={class:"icg-header"},Y={class:"icg-month"},K={class:"icg-controls"},Q=m("svg",{xmlns:"http://www.w3.org/2000/svg",height:".8rem",viewBox:"0 0 320 512"},[m("path",{d:"M9.4 233.4c-12.5 12.5-12.5 32.8 0 45.3l192 192c12.5 12.5 32.8 12.5 45.3 0s12.5-32.8 0-45.3L77.3 256 246.6 86.6c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0l-192 192z"})],-1),Z=[Q],ee=m("svg",{xmlns:"http://www.w3.org/2000/svg",height:".8rem",viewBox:"0 0 320 512"},[m("path",{d:"M310.6 233.4c12.5 12.5 12.5 32.8 0 45.3l-192 192c-12.5 12.5-32.8 12.5-45.3 0s-12.5-32.8 0-45.3L242.7 256 73.4 86.6c-12.5-12.5-12.5-32.8 0-45.3s32.8-12.5 45.3 0l192 192z"})],-1),te=[ee],ae={class:"icg-weekdays"},se=T({__name:"InfiniteCalendarGrid",props:{firstDayOfWeek:{default:0},locale:{default:"en-US"},todayLabel:{default:"Today"},items:{},fieldWithDate:{}},emits:["changeInterval"],setup(c,{emit:n}){const i=c,a=n,r=p(null),u=p(null),{cellHeight:d,activeMonth:l,daysInCalendar:v}=G(r,u,i.firstDayOfWeek),f=$(i.locale,i.firstDayOfWeek),h=C(()=>{const o={};for(const t of i.items){const e=t[i.fieldWithDate];if(typeof e=="string"||typeof e=="number"){const s=new Date(e);if(!isNaN(s.getTime())){const g=s.toLocaleDateString();o[g]?o[g].push(t):o[g]=[t]}}}return o});return k(v,o=>{a("changeInterval",{start:o[0].timestamp,end:o[o.length-1].timestamp})},{immediate:!0,flush:"post"}),(o,t)=>(w(),D("div",J,[m("div",X,[m("div",Y,_(y(l).toDate().toLocaleDateString(i.locale,{year:"numeric",month:"long"}).replace("Ð³.","")),1),m("div",K,[m("button",{onClick:t[0]||(t[0]=e=>l.value=y(l).add(-1,"M"))},Z),m("button",{onClick:t[1]||(t[1]=e=>l.value=y(b)())},_(i.todayLabel),1),m("button",{onClick:t[2]||(t[2]=e=>l.value=y(l).add(1,"M"))},te)])]),m("div",ae,[(w(!0),D(x,null,L(y(f),(e,s)=>(w(),D("div",{key:e,class:M(["icg-weekdays-cell",{"icg-weekdays-cell--weekend":s===(i.firstDayOfWeek?5:0)||s===6}])},_(e),3))),128))]),m("div",{ref_key:"wrapperRef",ref:r,class:"icg-wrapper"},[m("div",{ref_key:"containerRef",ref:u,class:"icg-months-grid"},[(w(!0),D(x,null,L(y(v),e=>(w(),D("div",{key:e.timestamp,class:M(["icg-months-grid-day",{"icg-months-grid-day--active-month":e.isCurrentMonth,"icg-months-grid-day--first-day":e.isFirstDay,"icg-months-grid-day--weekend":e.isWeekend,"icg-months-grid-day--current":e.isCurrent}]),style:O({height:`${y(d)}px`})},[N(o.$slots,"default",R(B({date:e,items:h.value[e.localeDate]})))],6))),128))],512)],512)]))}}),ne={class:"tw-relative tw-h[100vh]"},ie={class:"pl-calendar-day"},oe={key:0},le={class:"custom-p-8 custom-pt-40"},ce=T({__name:"CalendarView",setup(c){const n=V(),i=p(""),a=p(""),r=({start:d,end:l})=>{i.value=d,a.value=l};function u(d){try{return d.toLocaleString("en-US".replace("_","-"),{month:"short"})}catch{}}return(d,l)=>(w(),D("div",ne,[E(y(se),{items:y(n).getTasksInInterval(i.value,a.value),"field-with-date":"due_datetime",onChangeInterval:r},{default:F(({date:v,items:f})=>[m("div",ie,[A(_(new Date(v.timestamp).getDate())+" ",1),new Date(v.timestamp).getDate()===1?(w(),D("span",oe,_(u(new Date(v.timestamp))),1)):P("",!0)]),m("div",le,[(w(!0),D(x,null,L(f,h=>(w(),D("div",{key:h.uuid||h.id},_(h.name),1))),128))])]),_:1},8,["items"])]))}});export{ce as default};
