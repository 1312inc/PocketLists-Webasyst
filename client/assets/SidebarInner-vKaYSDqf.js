import{h as y,r as v,G as M,H as b,o as l,j as d,I as R,J as E,u as P,E as H,B as C,D as K,v as T,k as s,K as N,q as f,z as V,w as L,L as x,t as k,m as _,M as $,N as q,O as I,P as z,Q as O,F as w,R as B,C as F}from"./index-7QA4oAOe.js";import{_ as J}from"./SearchForm.vue_vue_type_script_setup_true_lang-ZLQRVFTC.js";import{C as D}from"./ContenteditableBlock-sY8G1PSt.js";import{u as U,p as j,_ as G}from"./SortableList.vue_vue_type_style_index_0_lang-F1zloKrg.js";import"./rangy-5rxgwlWZ.js";const Q=y({__name:"WaDropOnElement",props:{draggableEntityName:{}},emits:["drop"],setup(m,{emit:e}){const r=e,n=m,a=v(),{getDraggingEntityName:c}=U();return M(()=>{b(a,"dragenter",t=>{n.draggableEntityName===c()&&t.currentTarget instanceof HTMLElement&&t.currentTarget.classList.add("dragover")}),b(a,"dragleave",t=>{if(t.currentTarget instanceof HTMLElement){if(t.relatedTarget&&t.currentTarget.contains(t.relatedTarget))return;t.currentTarget.classList.remove("dragover")}}),b(a,"dragover",t=>{t.preventDefault()}),b(a,"drop",t=>{if(n.draggableEntityName===c()&&t.currentTarget instanceof HTMLElement&&(t.preventDefault(),t.currentTarget.classList.remove("dragover"),t.dataTransfer))try{const u=JSON.parse(t.dataTransfer.getData("text/plain")).taskIds;r("drop",u)}catch{}})}),(t,u)=>(l(),d("div",{ref_key:"menuItemElementRef",ref:a},[R(t.$slots,"default")],512))}}),W={class:"image sortable-handle"},Y={class:"details"},A={class:"tablebox"},X={class:"count align-right tw-flex tw-gap-1"},Z={key:0,class:"hint tw-flex"},tt={class:"tw-w-14 tw-truncate"},et=y({__name:"ListsListItem",props:{item:{}},setup(m){const e=m,r=E(),n=P(),a=H(),c=v(),t=v(!1),u=async o=>{t.value=!1,await r.updateItem(e.item,{name:o},{quietly:typeof e.item.pocket_id=="string"})},g=async o=>{await n.sort(e.item.id,null,o)},h=async o=>{o.target instanceof HTMLElement&&o.target.innerText&&a.push({name:"list",params:{id:e.item.id},query:{addNewTask:1}})};I("focusList").on(o=>{o===e.item.id&&i()});const i=async()=>{t.value=!0,await C(),c.value.focus()};return(o,lt)=>(l(),K(Q,{"draggable-entity-name":"tasks",onDrop:g},{default:T(()=>{var S;return[s("a",W,[s("i",{class:"userpic userpic32",style:N(`background-image: url(${e.item.icon_url||"/wa-apps/pocketlists/img/listicons/li-list@2x.png"})`)},null,4)]),s("a",Y,[s("div",A,[f(D,{ref_key:"contenteditableBlockRef",ref:c,value:o.item.name,editable:t.value,focusable:!0,placeholder:o.$t("newList"),tag:"strong",onUpdate:u,onKeydown:V(L(h,["prevent"]),["enter"])},null,8,["value","editable","placeholder","onKeydown"]),s("span",X,[x(k(e.item.extended_data.items_count>0?e.item.extended_data.items_count:0)+" ",1),e.item.extended_data.items_priority_count?(l(),d("span",{key:0,class:"badge",style:N(`background-color: ${(S=_(j).get(e.item.extended_data.items_priority_value))==null?void 0:S.color}`)},k(e.item.extended_data.items_priority_count),5)):$("",!0)])]),_(q).is_debug_mode?(l(),d("p",Z,[s("span",tt,"id: "+k(e.item.id),1),x(" | srank: "+k(e.item.sort)+" | "+k(e.item.rank),1)])):$("",!0)])]}),_:1}))}}),st={key:0,class:"custom-px-16 custom-py-12 gray"},at=y({__name:"ListsList",props:{pocket:{}},setup(m){const e=m,r=E();return(n,a)=>{const c=z("router-link");return l(),d(w,null,[f(G,{items:_(r).getListsInPocket(e.pocket.id),"sortable-list-id":e.pocket.id,"sortable-group-name":"lists","class-name":"list",onSort:_(r).sort},{default:T(({item:t})=>[f(c,{to:{name:"list",params:{id:t.id}},custom:""},{default:T(({isActive:u,navigate:g})=>[f(et,{item:t,class:O(["item",(u||t.uuid===n.$route.params.id)&&"selected"]),"data-id":t.id,onClick:g},null,8,["item","class","data-id","onClick"])]),_:2},1032,["to"])]),_:1},8,["items","sortable-list-id","onSort"]),_(r).getListsInPocket(e.pocket.id).length?$("",!0):(l(),d("div",st," No Lists Yet "))],64)}}}),nt={class:"custom-p-12"},ot={class:"heading black custom-m-0 custom-mb-8"},rt=y({__name:"PocketsListItem",props:{pocket:{}},setup(m){const e=m,r=B(),n=E(),a=v(!1),c=v(),t=async()=>{const p=await n.createList({pocket_id:e.pocket.id});if(!p)return;I("focusList").emit(p.id)},u=async()=>{a.value=!0,await C(),c.value.focus()},g=async p=>{await r.updateItemName(e.pocket,p)},h=async()=>{await r.deleteItem(e.pocket)};return(p,i)=>(l(),d(w,null,[s("div",nt,[s("h5",ot,[f(D,{ref_key:"pocketNameRef",ref:c,value:e.pocket.name,tag:"div",editable:a.value,focusable:!0,placeholder:p.$t("newPocket"),onBlur:i[0]||(i[0]=o=>a.value=!1),onUpdate:g},null,8,["value","editable","placeholder"]),s("a",{class:"count",onClick:L(u,["prevent"])},i[1]||(i[1]=[s("i",{class:"fas fa-pen"},null,-1)])),s("a",{class:"count action",onClick:L(t,["prevent"])},i[2]||(i[2]=[s("i",{class:"fas fa-plus-circle"},null,-1)])),s("a",{class:"count action",onClick:L(h,["prevent"])},i[3]||(i[3]=[s("i",{class:"fas fa-trash-alt"},null,-1)]))])]),f(at,{pocket:p.pocket},null,8,["pocket"])],64))}}),it={class:"custom-m-12"},ct={class:"align-center custom-m-12"},_t=y({__name:"SidebarInner",setup(m){const e=B();return(r,n)=>(l(),d(w,null,[s("div",it,[f(J)]),(l(!0),d(w,null,F(_(e).items,a=>(l(),d("div",{key:a.uuid||a.id,class:"custom-mb-24"},[f(rt,{pocket:a},null,8,["pocket"])]))),128)),s("div",ct,[s("button",{class:"gray",onClick:n[0]||(n[0]=a=>_(e).createPocket())},n[1]||(n[1]=[s("i",{class:"fa fa-plus"},null,-1)]))])],64))}});export{_t as default};
