import{d as y,r as N,z as H,D as b,o as d,c as u,E as K,G as B,i as q,y as z,A as F,x as J,l as x,b as e,e as c,H as O,t as g,B as S,I as T,h as v,J as U,K as j,n as A,w as k,L as M,F as R,q as G,M as W,s as Y}from"./index-hfFnsJwY.js";import{C as P}from"./ContenteditableBlock-A-PA5V1O.js";import{u as Q,_ as X}from"./SortableList.vue_vue_type_style_index_0_lang-h2KvMxHl.js";import"./rangy-5rxgwlWZ.js";const Z=y({__name:"WaDropOnElement",props:{draggableEntityName:{}},emits:["drop"],setup(f,{emit:o}){const s=o,a=f,n=N(),{getDraggingEntityName:l}=Q();return H(()=>{b(n,"dragenter",t=>{a.draggableEntityName===l()&&t.currentTarget instanceof HTMLElement&&t.currentTarget.classList.add("dragover")}),b(n,"dragleave",t=>{if(t.currentTarget instanceof HTMLElement){if(t.relatedTarget&&t.currentTarget.contains(t.relatedTarget))return;t.currentTarget.classList.remove("dragover")}}),b(n,"dragover",t=>{t.preventDefault()}),b(n,"drop",t=>{if(a.draggableEntityName===l()&&t.currentTarget instanceof HTMLElement&&(t.preventDefault(),t.currentTarget.classList.remove("dragover"),t.dataTransfer))try{const p=JSON.parse(t.dataTransfer.getData("text/plain")).taskIds;s("drop",p)}catch{}})}),(t,p)=>(d(),u("div",{ref_key:"menuItemElementRef",ref:n},[K(t.$slots,"default")],512))}}),tt={class:"tw-group tw-relative tw-py-4 tw-px-6 -tw-mx-6"},et={key:0},st={class:"hint"},at={class:"hint"},nt={class:"hint"},ot={class:"tw-flex tw-gap-4 tw-justify-between"},rt={key:0,class:"badge red"},it={class:"tw-flex tw-gap-2"},lt=y({__name:"ListsListItem",props:{item:{}},setup(f,{expose:o}){const s=f,a=B(),n=q(),l=z(),t=N(!1);o({editMode:t});const p=m=>{a.updateItemName(s.item,m)},L=()=>{a.deleteItem(s.item),l.push({name:"lists"})},w=async m=>{await n.sort(s.item.id,null,m)},r=()=>{t.value=!1},_=async()=>{r(),l.push({name:"list",params:{id:s.item.id},query:{addNewTask:1}})};return(m,i)=>{const V=F("RouterLink");return d(),J(Z,{"draggable-entity-name":"tasks",onDrop:w},{default:x(()=>{var h,E,I,C,$,D;return[e("div",tt,[i[5]||(i[5]=e("div",{class:"sortable-handle tw-cursor-grabbing tw-absolute -tw-translate-x-4 tw-hidden group-hover:tw-block"},[e("i",{class:"fas fa-grip-vertical"})],-1)),e("div",null,[c(O).is_debug_mode?(d(),u("div",et,[e("span",st,"id: "+g((h=s.item)==null?void 0:h.id),1),i[1]||(i[1]=S(" | ")),e("span",at,"prev_id: "+g(String((E=s.item)==null?void 0:E.prev_item_id)),1),i[2]||(i[2]=S(" | ")),e("span",nt,"srank: "+g(String((I=s.item)==null?void 0:I.sort))+" | "+g(String((C=c(a).getItemById(s.item.id))==null?void 0:C.rank)),1)])):T("",!0),e("div",ot,[v(V,{to:{name:"list",params:{id:s.item.id}},class:"tw-flex-auto"},{default:x(()=>[e("div",{class:U({"tw-bg-yellow":c(j)(c(l).currentRoute.value.params.id)===s.item.id||c(l).currentRoute.value.params.id===s.item.uuid})},[v(P,{value:m.item.name,editable:t.value,focusable:!0,placeholder:"New list",tag:"span",onBlur:r,onUpdate:p,onKeydown:A(k(_,["prevent"]),["enter"])},null,8,["value","editable","onKeydown"])],2)]),_:1},8,["to"]),S(" "+g(($=s.item.extended_data)==null?void 0:$.items_count)+" ",1),(D=s.item.extended_data)!=null&&D.items_priority_count?(d(),u("div",rt,g(s.item.extended_data.items_priority_count),1)):T("",!0),e("div",it,[e("a",{class:"count",onClick:i[0]||(i[0]=k(gt=>t.value=!t.value,["prevent"]))},i[3]||(i[3]=[e("i",{class:"fas fa-pen"},null,-1)])),e("a",{class:"count",onClick:k(L,["prevent"])},i[4]||(i[4]=[e("i",{class:"fas fa-trash-alt"},null,-1)]))])])])])]}),_:1})}}}),ct={class:"heading black tw-m-0 tw-mb-2"},dt={class:"pl-bg-block"},ut={key:0,class:"tw-px-4 tw-py-3 gray"},pt=y({__name:"ListsList",props:{pocket:{}},setup(f){const o=f,s=M(),a=B(),n=N(!1),l=[],t=async()=>{await a.createList({pocket_id:o.pocket.id}),await G(),l.at(-1).editMode=!0},p=w=>{s.updateItemName(o.pocket,w)},L=()=>{s.deleteItem(o.pocket)};return(w,r)=>(d(),u(R,null,[e("h5",ct,[v(P,{value:o.pocket.name,tag:"span",editable:n.value,focusable:!0,placeholder:"New Pocket",onBlur:r[0]||(r[0]=_=>n.value=!1),onUpdate:p},null,8,["value","editable"]),e("a",{class:"count",onClick:r[1]||(r[1]=k(_=>n.value=!n.value,["prevent"]))},r[2]||(r[2]=[e("i",{class:"fas fa-pen"},null,-1)])),e("a",{class:"count action",onClick:k(t,["prevent"])},r[3]||(r[3]=[e("i",{class:"fas fa-plus-circle"},null,-1)])),e("a",{class:"count action",onClick:k(L,["prevent"])},r[4]||(r[4]=[e("i",{class:"fas fa-trash-alt"},null,-1)]))]),e("div",dt,[v(X,{items:c(a).getListsInPocket(o.pocket.id),"sortable-list-id":o.pocket.id,"sortable-group-name":"lists",onSort:c(a).sort},{default:x(({item:_})=>[v(lt,{ref:m=>l.push(m),item:_},null,8,["item"])]),_:1},8,["items","sortable-list-id","onSort"]),c(a).getListsInPocket(o.pocket.id).length?T("",!0):(d(),u("div",ut," No Lists Yet "))])],64))}}),mt={class:"tw-gap-4"},ft={class:"align-center"},bt=y({__name:"SidebarInner",setup(f){const o=M();return(s,a)=>(d(),u("div",mt,[a[2]||(a[2]=W('<form class="state-with-inner-icon right tw-w-full"><input type="search" placeholder="Search" class="tw-w-full"><button class="icon"><i class="fas fa-search"></i></button></form><div class="bricks tw-ml-0 -tw-mr-3"><div class="brick pl-bg-block"><span class="icon"><i class="fas fa-star"></i></span><span class="count">495</span> Star </div><div class="brick pl-bg-block"><span class="icon"><i class="fas fa-bolt"></i></span><span class="count">33</span> Bolt </div></div>',2)),(d(!0),u(R,null,Y(c(o).items,n=>(d(),u("div",{key:n.uuid||n.id},[v(pt,{pocket:n},null,8,["pocket"])]))),128)),e("div",ft,[e("button",{class:"gray",onClick:a[0]||(a[0]=n=>c(o).createPocket())},a[1]||(a[1]=[e("i",{class:"fa fa-plus"},null,-1)]))])]))}});export{bt as default};
