import{an as E,d as h,y as M,$ as _,r as u,o as b,x as I,l as L,m as C,b as t,v as y,j as g,Z as k,k as x,ao as R,c as S,t as f,w as A,S as $,al as z}from"./index-H1DRoyTZ.js";import{a as P}from"./TaskList.vue_vue_type_script_setup_true_lang-L-305cMU.js";const D=async n=>{try{const{response:e}=await(await fetch(`https://geocode-maps.yandex.ru/1.x/?apikey=${E}&geocode=${n}&format=json`)).json();return e?e.GeoObjectCollection.featureMember.map(o=>o.GeoObject):[]}catch(e){return e instanceof Error&&console.error(e.message),[]}},T=h({__name:"ChooseLocationCreate",props:{lat:{},lng:{},radius:{}},emits:["close"],setup(n,{emit:e}){const o=e,a=n,c=M(),d=_(),p=u(""),w=async()=>{const i=await d.insert({name:p.value,location_latitude:a.lat,location_longitude:a.lng,location_radius:a.radius});i&&(c.push(`/map/${i.id}`),o("close"))};return(i,r)=>(b(),I(P,{title:"Add Location",onClose:r[1]||(r[1]=m=>o("close"))},{default:L(()=>[C(t("input",{"onUpdate:modelValue":r[0]||(r[0]=m=>p.value=m),type:"text",placeholder:"Location"},null,512),[[y,p.value]]),t("button",{onClick:w}," Add ")]),_:1}))}});function j(n,e,o){const d=40075016686e-3/(256*Math.pow(2,e))*Math.cos(o*(Math.PI/180));return n/d}const B={class:"tw-absolute tw-top-0 tw-left-0 tw-w-full tw-h-full"},N={class:"tw-absolute tw-flex tw-flex-col tw-gap-2 tw-top-12 tw-right-2 tw-z-50"},U={class:"pl-bg-block tw-p-4 tw-rounded-md"},V={class:"tw-flex tw-items-center tw-gap-2 tw-my-2"},G={class:"tw-flex-auto"},Z=h({__name:"ChooseLocation",props:{lng:{},lat:{},zoom:{}},setup(n){const e=n,o=u(50),a=g(()=>Math.pow(2,21-e.zoom)*1128.49722*(o.value/1e4)),c=g(()=>Math.round(j(a.value,e.zoom,e.lat)));_();const d=u(""),p=u(!1),w=u(!1),i=k([]);u(),x(i,({length:s})=>{p.value=!!s}),x(R(d,500),s=>{if(w.value){w.value=!1;return}r(s)});const r=async s=>{i.value=await D(s)},m=()=>{z(T,{lat:e.lat,lng:e.lng,radius:a.value}).show()};return(s,l)=>(b(),S("div",B,[t("div",N,[t("div",U,[l[2]||(l[2]=t("h6",null," Current locations ",-1)),t("div",null,"Lat: "+f(s.lat),1),t("div",null,"Lng: "+f(s.lng),1),t("div",null,"Radius: "+f(a.value&&Math.ceil(a.value))+" m",1),t("div",V,[t("div",G,[C(t("input",{"onUpdate:modelValue":l[0]||(l[0]=v=>o.value=v),type:"range",min:"10",max:"100",class:"tw-w-full"},null,512),[[y,o.value,void 0,{number:!0}]])]),t("a",{class:"gray smaller",onClick:l[1]||(l[1]=A(v=>o.value=50,["prevent"]))},"reset")]),t("div",{class:"tw-flex tw-gap-2"},[t("button",{onClick:m}," Create ")])])]),t("div",{class:"tw-absolute tw-top-1/2 tw-left-1/2 -tw-translate-x-1/2 -tw-translate-y-1/2 tw-z-40 tw-rounded-full tw-pointer-events-none",style:$({"background-color":"rgba(56, 56, 219, 0.4)",border:"1px solid rgb(14, 194, 219)",width:c.value+"px",height:c.value+"px"})},l[3]||(l[3]=[t("div",{class:"tw-absolute tw-top-1/2 tw-left-1/2 -tw-translate-x-1/2 -tw-translate-y-1/2"},[t("i",{class:"fas fa-map-pin text-purple",style:{"font-size":"2rem"}})],-1)]),4)]))}});export{Z as _};
