import{h as w,r as k,G as M,K as y,o as c,j as d,L as P,M as C,u as R,E as H,B as z,D as K,v as x,k as e,N,q as p,z as V,w as b,O as $,t as g,m as f,P as h,Q as O,R as I,H as q,I as F,F as S,s as U,C as j}from"./index-LsLQ-9uF.js";import{C as D}from"./ContenteditableBlock-9jy8ose6.js";import{u as G,p as J,_ as Q}from"./SortableList.vue_vue_type_style_index_0_lang-4wHw0Pqg.js";import{_ as W}from"./SearchForm.vue_vue_type_script_setup_true_lang-prDpotD1.js";import"./rangy-5rxgwlWZ.js";const Y=w({__name:"WaDropOnElement",props:{draggableEntityName:{}},emits:["drop"],setup(_,{emit:o}){const s=o,r=_,a=k(),{getDraggingEntityName:u}=G();return M(()=>{y(a,"dragenter",t=>{r.draggableEntityName===u()&&t.currentTarget instanceof HTMLElement&&t.currentTarget.classList.add("dragover")}),y(a,"dragleave",t=>{if(t.currentTarget instanceof HTMLElement){if(t.relatedTarget&&t.currentTarget.contains(t.relatedTarget))return;t.currentTarget.classList.remove("dragover")}}),y(a,"dragover",t=>{t.preventDefault()}),y(a,"drop",t=>{if(r.draggableEntityName===u()&&t.currentTarget instanceof HTMLElement&&(t.preventDefault(),t.currentTarget.classList.remove("dragover"),t.dataTransfer))try{const l=JSON.parse(t.dataTransfer.getData("text/plain")).taskIds;s("drop",l)}catch{}})}),(t,l)=>(c(),d("div",{ref_key:"menuItemElementRef",ref:a},[P(t.$slots,"default")],512))}}),A={class:"image sortable-handle"},X={class:"details"},Z={class:"tablebox"},tt={class:"count align-right tw-flex tw-gap-1"},et={key:0,class:"hint tw-flex"},st={class:"tw-w-14 tw-truncate"},at=w({__name:"ListsListItem",props:{item:{}},setup(_,{expose:o}){const s=_,r=C(),a=R(),u=H(),t=k(),l=k(!1);o({focus:L});const T=async i=>{l.value=!1,await r.updateItemName(s.item,i)},m=async i=>{await a.sort(s.item.id,null,i)},n=async i=>{i.target instanceof HTMLElement&&i.target.innerText&&u.push({name:"list",params:{id:s.item.id},query:{addNewTask:1}})};async function L(){l.value=!0,await z(),t.value.focus()}return(i,E)=>(c(),K(Y,{"draggable-entity-name":"tasks",onDrop:m},{default:x(()=>{var v;return[e("a",A,[e("i",{class:"userpic userpic32",style:N(`background-image: url(${s.item.icon_url||"/wa-apps/pocketlists/img/listicons/li-list@2x.png"})`)},null,4)]),e("a",X,[e("div",Z,[p(D,{ref_key:"contenteditableBlockRef",ref:t,value:i.item.name,editable:l.value,focusable:!0,placeholder:"New list",tag:"strong",onUpdate:T,onKeydown:V(b(n,["prevent"]),["enter"])},null,8,["value","editable","onKeydown"]),e("span",tt,[$(g(s.item.extended_data.items_count>0?s.item.extended_data.items_count:0)+" ",1),s.item.extended_data.items_priority_count?(c(),d("span",{key:0,class:"badge",style:N(`background-color: ${(v=f(J).get(s.item.extended_data.items_priority_value))==null?void 0:v.color}`)},g(s.item.extended_data.items_priority_count),5)):h("",!0)])]),f(O).is_debug_mode?(c(),d("p",et,[e("span",st,"id: "+g(s.item.id),1),$(" | srank: "+g(s.item.sort)+" | "+g(s.item.rank),1)])):h("",!0)])]}),_:1}))}}),nt={class:"custom-p-12"},ot={class:"heading black custom-m-0 custom-mb-8"},rt={class:"pl-bg-block"},it={key:0,class:"custom-px-16 custom-py-12 gray"},lt=w({__name:"ListsList",props:{pocket:{}},setup(_){const o=_,s=I(),r=C(),a=k(!1),u=k(new Set),t=async()=>{U(u,m=>{var n;m.size>0&&((n=[...m].at(-1))==null||n.focus())},{deep:!0,once:!0}),await r.createList({pocket_id:o.pocket.id})},l=async m=>{await s.updateItemName(o.pocket,m)},T=async()=>{await s.deleteItem(o.pocket)};return(m,n)=>{const L=q("router-link");return c(),d(S,null,[e("div",nt,[e("h5",ot,[p(D,{value:o.pocket.name,tag:"span",editable:a.value,focusable:!0,placeholder:"New Pocket",onBlur:n[0]||(n[0]=i=>a.value=!1),onUpdate:l},null,8,["value","editable"]),e("a",{class:"count",onClick:n[1]||(n[1]=b(i=>a.value=!a.value,["prevent"]))},n[2]||(n[2]=[e("i",{class:"fas fa-pen"},null,-1)])),e("a",{class:"count action",onClick:b(t,["prevent"])},n[3]||(n[3]=[e("i",{class:"fas fa-plus-circle"},null,-1)])),e("a",{class:"count action",onClick:b(T,["prevent"])},n[4]||(n[4]=[e("i",{class:"fas fa-trash-alt"},null,-1)]))])]),e("div",rt,[p(Q,{items:f(r).getListsInPocket([o.pocket.id]),"sortable-list-id":o.pocket.id,"sortable-group-name":"lists","class-name":"list",onSort:f(r).sort},{default:x(({item:i})=>[p(L,{to:{name:"list",params:{id:i.id}},custom:""},{default:x(({isActive:E,navigate:v})=>[p(at,{ref:B=>u.value.add(B),item:i,class:F(["item",E&&"selected"]),"data-id":i.id,onClick:v},null,8,["item","class","data-id","onClick"])]),_:2},1032,["to"])]),_:1},8,["items","sortable-list-id","onSort"]),f(r).getListsInPocket([o.pocket.id]).length?h("",!0):(c(),d("div",it," No Lists Yet "))])],64)}}}),ct={class:"custom-m-12"},dt={class:"align-center custom-m-12"},gt=w({__name:"SidebarInner",setup(_){const o=I();return(s,r)=>(c(),d(S,null,[e("div",ct,[p(W)]),(c(!0),d(S,null,j(f(o).items,a=>(c(),d("div",{key:a.uuid||a.id,class:"custom-mb-24"},[p(lt,{pocket:a},null,8,["pocket"])]))),128)),e("div",dt,[e("button",{class:"gray",onClick:r[0]||(r[0]=a=>f(o).createPocket())},r[1]||(r[1]=[e("i",{class:"fa fa-plus"},null,-1)]))])],64))}});export{gt as default};
