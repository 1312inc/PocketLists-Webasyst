import{d as v,r as k,o as i,e as c,f as s,K as n,t as o,F as $,y,D as B,j as b,ax as g,aO as L,aP as P,aQ as h}from"./index-1o9lfSTD.js";const T={class:"box contentbox"},E={class:"small"},S={class:"small"},j={href:"https://support.webasyst.ru/forum/ideas/",class:"button light-gray text-blue custom-mr-8",target:"_blank"},D={class:"small"},M={class:"flexbox small space-12 bordered-bottom"},O={class:"tw-w-24 align-right bold"},x={class:"tw-w-24 align-right"},A={class:"tw-w-24 align-right"},C={class:"tw-w-24"},F={class:"tw-w-24 align-right bold"},N={class:"tw-w-24 align-right"},U={class:"tw-w-24 align-right"},V={class:"custom-my-24"},W={class:"hint"},R={class:"small"},z={class:"icon"},q=v({__name:"BetaView",setup(H){const d=["task","list","pocket","comment","user","location"],p={task:"Tasks",list:"Lists",pocket:"Pockets",comment:"Comments",user:"Users",location:"Locations"},u=k({}),f=async(a,t)=>{var m;const e=g.getTableByEntity(a);if(!e)return;const l=await e.toArray(),r=l.filter(_=>typeof _.id=="string").length;return{total:l.length,unsynced:r,errors:(m=t[a])==null?void 0:m.length}};(async()=>{const a=await g.jobsUpdate.filter(l=>!!l.error).toArray(),t=Object.groupBy(a,l=>l.entity),e=await Promise.all(d.map(l=>f(l,t)));u.value=Object.fromEntries(d.map((l,r)=>[l,e[r]]))})();const w=async()=>{confirm("This will flush your local browser state. Sync will restart from scratch. Proceed?")&&(L(),await P(),location.reload())};return(a,t)=>(i(),c("div",T,[s("div",null,[s("h2",null,[n(o(a.$t("betaTitle"))+" ",1),t[0]||(t[0]=s("span",{class:"hint"},"Beta",-1))]),s("p",E,o(a.$t("betaWelcomeMsg")),1),s("p",S,[s("a",j,[t[1]||(t[1]=s("i",{class:"fas fa-magic custom-mr-4"},null,-1)),n(" "+o(a.$t("shareFeedbackMsg")),1)]),t[2]||(t[2]=s("a",{href:"mailto:hello@1312.io",class:"button nobutton text-blue"},[s("i",{class:"fas fa-envelope custom-mr-4"}),n(" hello@1312.io")],-1)),t[3]||(t[3]=s("a",{href:"https://github.com/1312inc/PocketLists-Webasyst/tree/api",class:"button nobutton text-blue",target:"_blank"},[s("i",{class:"fab fa-github custom-mr-4"}),n(" 1312inc/PocketLists-Webasyst")],-1))]),t[5]||(t[5]=s("hr",null,null,-1)),s("p",D,o(a.$t("localDbStateMsg")),1),s("div",M,[t[4]||(t[4]=s("div",{class:"tw-w-24"},null,-1)),s("div",O,o(a.$t("Total")),1),s("div",x,o(a.$t("Unsynced")),1),s("div",A,o(a.$t("Error")),1)]),(i(!0),c($,null,y(u.value,(e,l)=>(i(),c("div",{key:l,class:"flexbox small space-12 bordered-bottom"},[s("div",C,o(p[l]),1),s("div",F,o(e==null?void 0:e.total),1),s("div",N,o(e==null?void 0:e.unsynced),1),s("div",U,o(e==null?void 0:e.errors),1)]))),128))]),s("div",V,[s("button",{class:"green small",onClick:w},o(a.$t("betaResetBtn")),1),s("p",W,o(a.$t("betaResetBtnHint")),1)]),s("p",R,[s("span",z,[s("i",{class:"rounded",style:B(`background: ${b(h).status.value==="OPEN"?"var(--green)":"var(--orange)"};`)},null,4)]),n(" "+o(a.$t("betaSocketLabel"))+": "+o(b(h).status.value),1)])]))}});export{q as default};
