import{d as W,r as w,I as C,i as k,o as p,c as y,b as m,t as _,e as D,O as z,F as x,n as L,E as M,L as H,N as I,V as R,W as V,y as N,P as E,X as O,Y as B,H as F,h as P,j as A,B as $,C as T,Z as b}from"./index-_Sp4qyol.js";const U=typeof window<"u"&&typeof document<"u"?window:void 0,Y=(u,n)=>{const o=new Date(Date.UTC(2017,0,2)),i=[];for(let c=0;c<7;c++)i.push(o.toLocaleDateString(u,{weekday:"short"})),o.setDate(o.getDate()+1);return n||i.unshift(i.pop()),i};function j(u,n,o){let i=0,c=!1,d=0,f=null;const a=10,r=10;function v(l){const g=-l.deltaY,S=Math.abs(g);S<r||l.timeStamp-d<300&&c||(d=l.timeStamp,i<S&&!c?(g<-a?n():g>a&&o(),h(S),f&&clearTimeout(f),f=setTimeout(()=>{i===S&&s()},1e3)):S<a&&s())}function h(l){i=l,c=!0}function s(){i=a,c=!1}const t=()=>{u.value&&u.value.removeEventListener("wheel",v)},e=k(u,l=>{t(),l&&l.addEventListener("wheel",v)},{immediate:!0,flush:"post"});O()&&B(()=>{t(),e()})}function q(u,n={width:0,height:0}){const o=U;let i;const c=o&&"ResizeObserver"in o,d=w(n.width),f=w(n.height),a=([h])=>{const s=h.contentBoxSize;if(s){const t=Array.isArray(s)?s:[s];d.value=t.reduce((e,{inlineSize:l})=>e+l,0),f.value=t.reduce((e,{blockSize:l})=>e+l,0)}else d.value=h.contentRect.width,f.value=h.contentRect.height},r=()=>{i&&(i.disconnect(),i=void 0)},v=k(u,h=>{r(),c&&o&&(i=new ResizeObserver(a),h&&i.observe(h))},{immediate:!0,flush:"post"});return N(()=>{u.value&&(d.value="offsetWidth"in u.value?u.value.offsetWidth:n.width,f.value="offsetHeight"in u.value?u.value.offsetHeight:n.height)}),O()&&B(()=>{r(),v()}),{width:d,height:f}}function G(u,n,o){const i=w(1),c=w(!0),d=w(!0),{height:f}=q(u),a=C(()=>f.value/6),r=w(z()),v=C(()=>{const t=r.value.startOf("M"),e=t.get("d")+-o,l=e<0?7+e:e;return t.add(-(6*7+l),"d")}),h=C(()=>new Array(6*7*3).fill(null).map((t,e)=>{const l=v.value.add(e,"d").toDate(),g=l.toLocaleDateString();return{localeDate:g,timestamp:l.getTime(),isWeekend:[0,6].includes(l.getDay()),isCurrent:new Date().toLocaleDateString()===g,isFirstDay:l.getDate()===1,isCurrentMonth:l.getMonth()===r.value.get("M")}}));N(()=>{n.value&&(d.value=!1,n.value.style.transform=`translate3d(0px, ${-n.value.clientHeight}px, 0px)`)}),j(u,()=>{c.value&&i.value<2&&i.value++},()=>{c.value&&i.value>0&&i.value--});const s=t=>{if(n.value){const e=n.value.querySelectorAll(".icg-months-grid-day--first-day")[t];e instanceof HTMLElement&&(n.value.style.transform=`translate3d(0px, ${-e.offsetTop}px, 0px)`)}};return k(i,t=>{t===1?s(t):n.value&&(d.value=!0,c.value=!1,n.value.addEventListener("transitionend",()=>{d.value=!1,c.value=!0,r.value=r.value.add(t===0?-1:1,"month"),E(()=>{i.value=1})},{once:!0}),s(t))}),k(d,t=>{n.value&&(n.value.style.transitionProperty=t?"transform":"none")}),k(a,()=>{s(1)},{flush:"post"}),{cellHeight:a,activeMonth:r,daysInCalendar:h}}const X={class:"icg"},Z={class:"icg-header"},J={class:"icg-month"},K={class:"icg-controls"},Q=m("svg",{xmlns:"http://www.w3.org/2000/svg",height:".8rem",viewBox:"0 0 320 512"},[m("path",{d:"M9.4 233.4c-12.5 12.5-12.5 32.8 0 45.3l192 192c12.5 12.5 32.8 12.5 45.3 0s12.5-32.8 0-45.3L77.3 256 246.6 86.6c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0l-192 192z"})],-1),ee=[Q],te=m("svg",{xmlns:"http://www.w3.org/2000/svg",height:".8rem",viewBox:"0 0 320 512"},[m("path",{d:"M310.6 233.4c12.5 12.5 12.5 32.8 0 45.3l-192 192c-12.5 12.5-32.8 12.5-45.3 0s-12.5-32.8 0-45.3L242.7 256 73.4 86.6c-12.5-12.5-12.5-32.8 0-45.3s32.8-12.5 45.3 0l192 192z"})],-1),ae=[te],se={class:"icg-weekdays"},ie=W({__name:"InfiniteCalendarGrid",props:{firstDayOfWeek:{default:0},locale:{default:"en-US"},todayLabel:{default:"Today"},items:{},fieldWithDate:{}},emits:["changeInterval"],setup(u,{emit:n}){const o=u,i=n,c=w(null),d=w(null),{cellHeight:f,activeMonth:a,daysInCalendar:r}=G(c,d,o.firstDayOfWeek),v=Y(o.locale,o.firstDayOfWeek),h=C(()=>{const s={};for(const t of o.items){const e=t[o.fieldWithDate];if(typeof e=="string"||typeof e=="number"){const l=new Date(e);if(!isNaN(l.getTime())){const g=l.toLocaleDateString();s[g]?s[g].push(t):s[g]=[t]}}}return s});return k(r,s=>{i("changeInterval",{start:s[0].timestamp,end:s[s.length-1].timestamp})},{immediate:!0,flush:"post"}),(s,t)=>(p(),y("div",X,[m("div",Z,[m("div",J,_(D(a).toDate().toLocaleDateString(o.locale,{year:"numeric",month:"long"}).replace("Ð³.","")),1),m("div",K,[m("button",{onClick:t[0]||(t[0]=e=>a.value=D(a).add(-1,"M"))},ee),m("button",{onClick:t[1]||(t[1]=e=>a.value=D(z)())},_(o.todayLabel),1),m("button",{onClick:t[2]||(t[2]=e=>a.value=D(a).add(1,"M"))},ae)])]),m("div",se,[(p(!0),y(x,null,L(D(v),(e,l)=>(p(),y("div",{key:e,class:M(["icg-weekdays-cell",{"icg-weekdays-cell--weekend":l===(o.firstDayOfWeek?5:0)||l===6}])},_(e),3))),128))]),m("div",{ref_key:"wrapperRef",ref:c,class:"icg-wrapper"},[m("div",{ref_key:"containerRef",ref:d,class:"icg-months-grid"},[(p(!0),y(x,null,L(D(r),e=>(p(),y("div",{key:e.timestamp,class:M(["icg-months-grid-day",{"icg-months-grid-day--active-month":e.isCurrentMonth,"icg-months-grid-day--first-day":e.isFirstDay,"icg-months-grid-day--weekend":e.isWeekend,"icg-months-grid-day--current":e.isCurrent}]),style:H({height:`${D(f)}px`})},[I(s.$slots,"default",R(V({date:e,items:h.value[e.localeDate]})))],6))),128))],512)],512)]))}}),ne={class:"tw-relative tw-h-full"},le={class:"pl-calendar-day"},oe={key:0},re={class:"custom-p-8 custom-pt-40"},ce={key:0,class:"opacity-50"},de=W({__name:"CalendarView",setup(u){const n=F(),o=w(),i=w(),c=C(()=>[...n.getTasksCompleted,...n.getDue].map(a=>({...a,filterDate:a.complete_datetime||a.due_date})).filter(a=>{if(!a.filterDate)return!1;const r=new Date(a.filterDate).getTime();return r>o.value&&r<i.value})),d=({start:a,end:r})=>{o.value=a,i.value=r,n.fetch({status:1}),n.fetchStream({filter:"due"})};function f(a){try{return a.toLocaleString(b,{month:"short"})}catch{}}return(a,r)=>(p(),y("div",ne,[P(D(ie),{items:c.value,"field-with-date":"filterDate",locale:D(b),onChangeInterval:d},{default:A(({date:v,items:h})=>[m("div",le,[$(_(new Date(v.timestamp).getDate())+" ",1),new Date(v.timestamp).getDate()===1?(p(),y("span",oe,_(f(new Date(v.timestamp))),1)):T("",!0)]),m("div",re,[(p(!0),y(x,null,L(h,s=>(p(),y("div",{key:s.uuid||s.id,class:"flexbox middle space-4"},[s.complete_datetime?(p(),y("div",ce,r[0]||(r[0]=[m("i",{class:"small gray fas fa-check"},null,-1)]))):T("",!0),m("div",{class:M(["small tw-truncate",{"opacity-50":s.complete_datetime}])},_(s.name),3)]))),128))])]),_:1},8,["items","locale"])]))}});export{de as default};
