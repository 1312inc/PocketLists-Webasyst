import{h as k,G as E,H as S,r as y,o,j as i,k as a,q as u,w as $,I as b,J as D,F as L,B as P,K as M,L as H,M as T,u as K,E as O,D as V,v as h,N as x,z as q,O as C,t as v,m as w,P as z,c as F,Q as J,R as U,C as j}from"./index--_aXmEEM.js";import{_ as G}from"./SearchForm.vue_vue_type_script_setup_true_lang-QYQ9I1bv.js";import{C as R}from"./ContenteditableBlock-wXcaO81t.js";import{u as Q,p as W,_ as Y}from"./SortableList.vue_vue_type_style_index_0_lang-sshLdXa-.js";import"./rangy-5rxgwlWZ.js";const A={class:"custom-p-12"},X={class:"heading black custom-m-0 custom-mb-8"},I=k({__name:"PocketsListItem",props:{pocket:{default:()=>({id:null,name:"NO POCKET"})}},setup(p){const t=p,l=E(),n=S(),s=y(!1),_=y(),e=async()=>{const m=await n.createList({pocket_id:t.pocket.id});if(!m)return;M("focusList").emit(m.id)},d=async()=>{s.value=!0,await P(),_.value.focus()},f=async m=>{t.pocket.id!==null&&await l.updateItemName(t.pocket,m)},g=async()=>{t.pocket.id!==null&&await l.deleteItem(t.pocket)};return(m,c)=>(o(),i(L,null,[a("div",A,[a("h5",X,[u(R,{ref_key:"pocketNameRef",ref:_,value:t.pocket.name||"",tag:"div",editable:s.value,focusable:!0,placeholder:m.$t("newPocket"),onBlur:c[0]||(c[0]=r=>s.value=!1),onUpdate:f},null,8,["value","editable","placeholder"]),t.pocket.id!==null?(o(),i("a",{key:0,class:"count",onClick:$(d,["prevent"])},c[1]||(c[1]=[a("i",{class:"fas fa-pen"},null,-1)]))):b("",!0),a("a",{class:"count action",onClick:$(e,["prevent"])},c[2]||(c[2]=[a("i",{class:"fas fa-plus-circle"},null,-1)])),t.pocket.id!==null?(o(),i("a",{key:1,class:"count action",onClick:$(g,["prevent"])},c[3]||(c[3]=[a("i",{class:"fas fa-trash-alt"},null,-1)]))):b("",!0)])]),D(m.$slots,"default")],64))}}),Z=k({__name:"WaDropOnElement",props:{draggableEntityName:{}},emits:["drop"],setup(p,{emit:t}){const l=t,n=p,s=y(),{getDraggingEntityName:_}=Q();return H(()=>{T(s,"dragenter",e=>{n.draggableEntityName===_()&&e.currentTarget instanceof HTMLElement&&e.currentTarget.classList.add("dragover")}),T(s,"dragleave",e=>{if(e.currentTarget instanceof HTMLElement){if(e.relatedTarget&&e.currentTarget.contains(e.relatedTarget))return;e.currentTarget.classList.remove("dragover")}}),T(s,"dragover",e=>{e.preventDefault()}),T(s,"drop",e=>{if(n.draggableEntityName===_()&&e.currentTarget instanceof HTMLElement&&(e.preventDefault(),e.currentTarget.classList.remove("dragover"),e.dataTransfer))try{const d=JSON.parse(e.dataTransfer.getData("text/plain")).taskIds;l("drop",d)}catch{}})}),(e,d)=>(o(),i("div",{ref_key:"menuItemElementRef",ref:s},[D(e.$slots,"default")],512))}}),tt={class:"image sortable-handle"},et={class:"details"},st={class:"tablebox"},at={class:"count align-right tw-flex tw-gap-1"},nt={key:0,class:"hint tw-flex"},ot={class:"tw-w-14 tw-truncate"},rt=k({__name:"ListsListItem",props:{item:{}},setup(p){const t=p,l=S(),n=K(),s=O(),_=y(),e=y(!1),d=async r=>{e.value=!1,await l.updateItem(t.item,{name:r},{quietly:typeof t.item.pocket_id=="string"})},f=async r=>{await n.sort(t.item.id,null,r)},g=async r=>{r.target instanceof HTMLElement&&r.target.innerText&&s.push({name:"list",params:{id:t.item.id},query:{addNewTask:1}})};M("focusList").on(r=>{r===t.item.id&&c()});const c=async()=>{e.value=!0,await P(),_.value.focus()};return(r,mt)=>(o(),V(Z,{"draggable-entity-name":"tasks",onDrop:f},{default:h(()=>{var N;return[a("a",tt,[a("i",{class:"userpic userpic32",style:x(`background-image: url(${t.item.icon_url||"/wa-apps/pocketlists/img/listicons/li-list@2x.png"})`)},null,4)]),a("a",et,[a("div",st,[u(R,{ref_key:"contenteditableBlockRef",ref:_,value:r.item.name,editable:e.value,focusable:!0,placeholder:r.$t("newList"),tag:"strong",onUpdate:d,onKeydown:q($(g,["prevent"]),["enter"])},null,8,["value","editable","placeholder","onKeydown"]),a("span",at,[C(v(t.item.extended_data.items_count>0?t.item.extended_data.items_count:0)+" ",1),t.item.extended_data.items_priority_count?(o(),i("span",{key:0,class:"badge",style:x(`background-color: ${(N=w(W).get(t.item.extended_data.items_priority_value))==null?void 0:N.color}`)},v(t.item.extended_data.items_priority_count),5)):b("",!0)])]),w(z).is_debug_mode?(o(),i("p",nt,[a("span",ot,"id: "+v(t.item.id),1),C(" | srank: "+v(t.item.sort)+" | "+v(t.item.rank),1)])):b("",!0)])]}),_:1}))}}),it={key:0,class:"custom-px-16 custom-py-12 gray"},B=k({__name:"ListsList",props:{pocket:{}},setup(p){const t=p,l=S(),n=F(()=>{var s;return l.getListsInPocket(((s=t.pocket)==null?void 0:s.id)||null)});return(s,_)=>{var d;const e=J("router-link");return o(),i(L,null,[u(Y,{items:n.value,"sortable-list-id":(d=t.pocket)==null?void 0:d.id,"sortable-group-name":"lists","class-name":"list","class-name-item":"list",onSort:w(l).sort},{default:h(({item:f})=>[u(e,{to:{name:"list",params:{id:f.id}},custom:""},{default:h(({isActive:g,navigate:m})=>[u(rt,{item:f,class:U(["item",(g||f.uuid===s.$route.params.id)&&"selected"]),onClick:m},null,8,["item","class","onClick"])]),_:2},1032,["to"])]),_:1},8,["items","sortable-list-id","onSort"]),n.value.length?b("",!0):(o(),i("div",it," No Lists Yet "))],64)}}}),lt={class:"custom-mb-24"},ct=k({__name:"PocketsLIst",setup(p){const t=E();return(l,n)=>(o(),i(L,null,[a("div",lt,[u(I,null,{default:h(()=>[u(B)]),_:1})]),(o(!0),i(L,null,j(w(t).items,s=>(o(),i("div",{key:s.uuid||s.id,class:"custom-mb-24"},[u(I,{pocket:s},{default:h(()=>[u(B,{pocket:s},null,8,["pocket"])]),_:2},1032,["pocket"])]))),128))],64))}}),ut={class:"custom-m-12"},dt={class:"align-center custom-m-12"},vt=k({__name:"SidebarInner",setup(p){const t=E();return(l,n)=>(o(),i(L,null,[a("div",ut,[u(G)]),u(ct),a("div",dt,[a("button",{class:"gray",onClick:n[0]||(n[0]=s=>w(t).createPocket())},n[1]||(n[1]=[a("i",{class:"fa fa-plus"},null,-1)]))])],64))}});export{vt as default};
