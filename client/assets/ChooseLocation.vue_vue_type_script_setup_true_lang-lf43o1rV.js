import{aH as E,d as h,s as M,a0 as b,r as d,o as x,q as I,k,l as C,b as t,v as y,K as g,a1 as L,j as _,aI as R,c as S,t as f,w as A,O as z,aD as D}from"./index-0CRS1nj7.js";import{a as P}from"./TaskList.vue_vue_type_script_setup_true_lang-mDub3XXH.js";const $=async i=>{try{const{response:e}=await(await fetch(`https://geocode-maps.yandex.ru/1.x/?apikey=${E}&geocode=${i}&format=json`)).json();return e?e.GeoObjectCollection.featureMember.map(a=>a.GeoObject):[]}catch(e){return e instanceof Error&&console.error(e.message),[]}},T=h({__name:"ChooseLocationCreate",props:{lat:{},lng:{},radius:{}},emits:["close"],setup(i,{emit:e}){const a=e,o=i,p=M(),r=b(),u=d(""),w=async()=>{const s=await r.insert({name:u.value,location_latitude:o.lat,location_longitude:o.lng,location_radius:o.radius});s&&(await r.updateItem(s,{name:u.value,location_latitude:o.lat,location_longitude:o.lng,location_radius:o.radius}),s&&(p.push(`/map/${s.id}`),a("close")))};return(s,c)=>(x(),I(P,{title:"Add Location",onClose:c[1]||(c[1]=m=>a("close"))},{default:k(()=>[C(t("input",{"onUpdate:modelValue":c[0]||(c[0]=m=>u.value=m),type:"text",placeholder:"Location"},null,512),[[y,u.value]]),t("button",{onClick:w}," Add ")]),_:1}))}});function j(i,e,a){const r=40075016686e-3/(256*Math.pow(2,e))*Math.cos(a*(Math.PI/180));return i/r}const B={class:"tw-absolute tw-top-0 tw-left-0 width-100 tw-h-full"},N={class:"tw-absolute tw-flex tw-flex-col tw-gap-2 tw-top-12 tw-right-2 z-50"},O={class:"pl-bg-block tw-bg-[--pl-bg-block] custom-p-16 tw-rounded-md"},U={class:"tw-flex tw-items-center tw-gap-2 custom-my-8"},V={class:"tw-flex-auto"},Y=h({__name:"ChooseLocation",props:{lng:{},lat:{},zoom:{}},setup(i){const e=i,a=d(50),o=g(()=>Math.pow(2,21-e.zoom)*1128.49722*(a.value/1e4)),p=g(()=>Math.round(j(o.value,e.zoom,e.lat)));b();const r=d(""),u=d(!1),w=d(!1),s=L([]);d(),_(s,({length:l})=>{u.value=!!l}),_(R(r,500),l=>{if(w.value){w.value=!1;return}c(l)});const c=async l=>{s.value=await $(l)},m=()=>{D(T,{lat:e.lat,lng:e.lng,radius:o.value}).show()};return(l,n)=>(x(),S("div",B,[t("div",N,[t("div",O,[n[2]||(n[2]=t("h6",null," Current locations ",-1)),t("div",null,"Lat: "+f(l.lat),1),t("div",null,"Lng: "+f(l.lng),1),t("div",null,"Radius: "+f(o.value&&Math.ceil(o.value))+" m",1),t("div",U,[t("div",V,[C(t("input",{"onUpdate:modelValue":n[0]||(n[0]=v=>a.value=v),type:"range",min:"10",max:"100",class:"width-100"},null,512),[[y,a.value,void 0,{number:!0}]])]),t("a",{class:"gray smaller",onClick:n[1]||(n[1]=A(v=>a.value=50,["prevent"]))},"reset")]),t("div",{class:"tw-flex tw-gap-2"},[t("button",{onClick:m}," Create ")])])]),t("div",{class:"tw-absolute tw-top-1/2 tw-left-1/2 -tw-translate-x-1/2 -tw-translate-y-1/2 z-40 tw-rounded-full tw-pointer-events-none",style:z({"background-color":"rgba(56, 56, 219, 0.4)",border:"1px solid rgb(14, 194, 219)",width:p.value+"px",height:p.value+"px"})},n[3]||(n[3]=[t("div",{class:"tw-absolute tw-top-1/2 tw-left-1/2 -tw-translate-x-1/2 -tw-translate-y-1/2"},[t("i",{class:"fas fa-map-pin text-purple",style:{"font-size":"2rem"}})],-1)]),4)]))}});export{Y as _};
