import{d as y,r as h,az as b,B as C,o,c as l,N as p,i as F,j as _,k as P,D as T,b as a,t as S,E as g,h as w,l as k,aA as L,F as v,s as N,q as M,w as x}from"./index-GVZiQq5N.js";const D=y({__name:"IntersectionObserver",props:{disabled:{type:Boolean}},emits:["intersecting"],setup(d,{emit:e}){const t=d,n=e,s=h(null),{stop:u}=b(s,([{isIntersecting:r}])=>{r&&!t.disabled&&n("intersecting")},{rootMargin:"200px"});return C(()=>{u()}),(r,f)=>(o(),l("div",{ref_key:"elRef",ref:s},[p(r.$slots,"default")],512))}}),R={key:0},V={class:"skeleton custom-m-24"},I=30,A=y({__name:"TaskListLazyLoadFetcher",props:{filter:{},listId:{},locationId:{},userId:{},searchQuery:{}},setup(d){const e=d,t=F(),n=h(I),s=h([]),u=h(!1),r=_(()=>({list:{source:e.listId?t.getTasksInList(e.listId):[],isFetchStream:!1,fetchParams:e.listId?{list_id:e.listId}:{}},upnext:{source:t.getUpnext,isFetchStream:!0,fetchParams:{filter:"upnext"}},due:{source:t.getDue,isFetchStream:!0,fetchParams:{filter:"due"}},priority:{source:t.getPriority,isFetchStream:!0,fetchParams:{filter:"priority"}},nearby:{source:t.getTasksSortedByCurrentDistance,isFetchStream:!0,fetchParams:{filter:"nearby"}},search:{source:s.value,isFetchStream:!0,fetchParams:{filter:`search/${e.searchQuery}`}},location:{source:e.locationId?t.getTasksInLocation(e.locationId):[],isFetchStream:!1,fetchParams:e.locationId?{location_id:e.locationId}:{}},user:{source:e.userId?t.getTasksByUser(e.userId):[],isFetchStream:!1,fetchParams:e.userId?{assigned_contact_id:e.userId}:{}},completed:{source:t.getTasksCompleted,isFetchStream:!1,fetchParams:{status:1}}})[e.filter]),f=_(()=>r.value.source.slice(0,n.value));P(()=>e,$,{deep:!0,immediate:!0});const B=()=>{n.value+=I};async function $(){const{isFetchStream:m,fetchParams:i}=r.value;if(i.list_id&&typeof i.list_id!="number")return;u.value=!1,s.value=[];const c=await t[m?"fetchStream":"fetch"]({...i});c&&c.value&&c.value.status_code==="ok"&&e.filter==="search"&&(s.value=[...s.value,...c.value.data],u.value=!s.value.length)}return(m,i)=>(o(),l(v,null,[p(m.$slots,"default",{tasks:f.value}),e.filter==="search"&&u.value?(o(),l("div",R,[i[0]||(i[0]=T(" No matches found for ")),a("strong",null,S(e.searchQuery),1)])):g("",!0),w(L,{name:"fade"},{default:k(()=>[f.value.length&&f.value.length<r.value.source.length?(o(),N(D,{key:0,onIntersecting:B},{default:k(()=>[a("div",V,[(o(),l(v,null,M(5,c=>a("span",{key:c,class:"skeleton-custom-box",style:{height:"40px"}})),64))])]),_:1})):g("",!0)]),_:1})],64))}}),E={class:"dialog-header"},Q={class:"dialog-content"},U={class:"dialog-footer tw-flex tw-gap-2"},O=y({__name:"ModalWrapperBody",props:{title:{},hideCloseButton:{type:Boolean},hideCloseIcon:{type:Boolean}},emits:["close"],setup(d){return(e,t)=>(o(),l(v,null,[a("header",E,[a("h1",null,S(e.$props.title),1),e.hideCloseIcon?g("",!0):(o(),l("a",{key:0,class:"dialog-close",onClick:t[0]||(t[0]=x(n=>e.$emit("close"),["prevent"]))},t[2]||(t[2]=[a("i",{class:"fas fa-times"},null,-1)])))]),a("div",Q,[p(e.$slots,"default")]),a("footer",U,[p(e.$slots,"submit"),e.hideCloseButton?g("",!0):(o(),l("button",{key:0,class:"button light-gray",onClick:t[1]||(t[1]=n=>e.$emit("close"))}," Close "))])],64))}});export{A as _,O as a};
