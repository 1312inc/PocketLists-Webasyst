import{d as z,r as D,K as b,j as M,o as p,c as g,b as o,t as k,g as h,A as _,F as S,p as T,H as W,O,P as R,W as E,X as I,B,Q as V,Y as H,Z as N,J as A,e as x,k as F,w as P,f as Y,E as L,$ as j}from"./index-0CRS1nj7.js";import{_ as $}from"./TaskList.vue_vue_type_script_setup_true_lang-mDub3XXH.js";import"./SortableList.vue_vue_type_style_index_0_lang-TUHliH4b.js";import"./rangy-5rxgwlWZ.js";const U=typeof window<"u"&&typeof document<"u"?window:void 0,q=(f,n)=>{const r=new Date(Date.UTC(2017,0,2)),l=[];for(let u=0;u<7;u++)l.push(r.toLocaleDateString(f,{weekday:"short"})),r.setDate(r.getDate()+1);return n||l.unshift(l.pop()),l};function G(f,n,r){let l=0,u=!1,v=0,t=null;const s=10,c=10;function w(i){const y=-i.deltaY,C=Math.abs(y);C<c||i.timeStamp-v<300&&u||(v=i.timeStamp,l<C&&!u?(y<-s?n():y>s&&r(),m(C),t&&clearTimeout(t),t=setTimeout(()=>{l===C&&d()},1e3)):C<s&&d())}function m(i){l=i,u=!0}function d(){l=s,u=!1}const a=()=>{f.value&&f.value.removeEventListener("wheel",w)},e=M(f,i=>{a(),i&&i.addEventListener("wheel",w)},{immediate:!0,flush:"post"});H()&&N(()=>{a(),e()})}function J(f,n={width:0,height:0}){const r=U;let l;const u=r&&"ResizeObserver"in r,v=D(n.width),t=D(n.height),s=([m])=>{const d=m.contentBoxSize;if(d){const a=Array.isArray(d)?d:[d];v.value=a.reduce((e,{inlineSize:i})=>e+i,0),t.value=a.reduce((e,{blockSize:i})=>e+i,0)}else v.value=m.contentRect.width,t.value=m.contentRect.height},c=()=>{l&&(l.disconnect(),l=void 0)},w=M(f,m=>{c(),u&&r&&(l=new ResizeObserver(s),m&&l.observe(m))},{immediate:!0,flush:"post"});return B(()=>{f.value&&(v.value="offsetWidth"in f.value?f.value.offsetWidth:n.width,t.value="offsetHeight"in f.value?f.value.offsetHeight:n.height)}),H()&&N(()=>{c(),w()}),{width:v,height:t}}function K(f,n,r){const l=D(1),u=D(!0),v=D(!0),{height:t}=J(f),s=b(()=>t.value/6),c=D(_()),w=b(()=>{const a=c.value.startOf("M"),e=a.get("d")+-r,i=e<0?7+e:e;return a.add(-(6*7+i),"d")}),m=b(()=>new Array(6*7*3).fill(null).map((a,e)=>{const i=w.value.add(e,"d").toDate(),y=i.toLocaleDateString();return{localeDate:y,timestamp:i.getTime(),isWeekend:[0,6].includes(i.getDay()),isCurrent:new Date().toLocaleDateString()===y,isFirstDay:i.getDate()===1,isCurrentMonth:i.getMonth()===c.value.get("M")}}));B(()=>{n.value&&(v.value=!1,n.value.style.transform=`translate3d(0px, ${-n.value.clientHeight}px, 0px)`)}),G(f,()=>{u.value&&l.value<2&&l.value++},()=>{u.value&&l.value>0&&l.value--});const d=a=>{if(n.value){const e=n.value.querySelectorAll(".icg-months-grid-day--first-day")[a];e instanceof HTMLElement&&(n.value.style.transform=`translate3d(0px, ${-e.offsetTop}px, 0px)`)}};return M(l,a=>{a===1?d(a):n.value&&(v.value=!0,u.value=!1,n.value.addEventListener("transitionend",()=>{v.value=!1,u.value=!0,c.value=c.value.add(a===0?-1:1,"month"),V(()=>{l.value=1})},{once:!0}),d(a))}),M(v,a=>{n.value&&(n.value.style.transitionProperty=a?"transform":"none")}),M(s,()=>{d(1)},{flush:"post"}),{cellHeight:s,activeMonth:c,daysInCalendar:m}}const Q={class:"icg"},X={class:"icg-header"},Z={class:"icg-month"},ee={class:"icg-controls"},te=o("svg",{xmlns:"http://www.w3.org/2000/svg",height:".8rem",viewBox:"0 0 320 512"},[o("path",{d:"M9.4 233.4c-12.5 12.5-12.5 32.8 0 45.3l192 192c12.5 12.5 32.8 12.5 45.3 0s12.5-32.8 0-45.3L77.3 256 246.6 86.6c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0l-192 192z"})],-1),ae=[te],se=o("svg",{xmlns:"http://www.w3.org/2000/svg",height:".8rem",viewBox:"0 0 320 512"},[o("path",{d:"M310.6 233.4c12.5 12.5 12.5 32.8 0 45.3l-192 192c-12.5 12.5-32.8 12.5-45.3 0s-12.5-32.8 0-45.3L242.7 256 73.4 86.6c-12.5-12.5-12.5-32.8 0-45.3s32.8-12.5 45.3 0l192 192z"})],-1),le=[se],ie={class:"icg-weekdays"},oe=z({__name:"InfiniteCalendarGrid",props:{firstDayOfWeek:{default:0},locale:{default:"en-US"},todayLabel:{default:"Today"},items:{},fieldWithDate:{}},emits:["changeInterval"],setup(f,{emit:n}){const r=f,l=n,u=D(null),v=D(null),{cellHeight:t,activeMonth:s,daysInCalendar:c}=K(u,v,r.firstDayOfWeek),w=q(r.locale,r.firstDayOfWeek),m=b(()=>{const d={};for(const a of r.items){const e=a[r.fieldWithDate];if(typeof e=="string"||typeof e=="number"){const i=new Date(e);if(!isNaN(i.getTime())){const y=i.toLocaleDateString();d[y]?d[y].push(a):d[y]=[a]}}}return d});return M(c,d=>{l("changeInterval",{start:d[0].timestamp,end:d[d.length-1].timestamp})},{immediate:!0,flush:"post"}),(d,a)=>(p(),g("div",Q,[o("div",X,[o("div",Z,k(h(s).toDate().toLocaleDateString(r.locale,{year:"numeric",month:"long"}).replace("Ð³.","")),1),o("div",ee,[o("button",{onClick:a[0]||(a[0]=e=>s.value=h(s).add(-1,"M"))},ae),o("button",{onClick:a[1]||(a[1]=e=>s.value=h(_)())},k(r.todayLabel),1),o("button",{onClick:a[2]||(a[2]=e=>s.value=h(s).add(1,"M"))},le)])]),o("div",ie,[(p(!0),g(S,null,T(h(w),(e,i)=>(p(),g("div",{key:e,class:W(["icg-weekdays-cell",{"icg-weekdays-cell--weekend":i===(r.firstDayOfWeek?5:0)||i===6}])},k(e),3))),128))]),o("div",{ref_key:"wrapperRef",ref:u,class:"icg-wrapper"},[o("div",{ref_key:"containerRef",ref:v,class:"icg-months-grid"},[(p(!0),g(S,null,T(h(c),e=>(p(),g("div",{key:e.timestamp,class:W(["icg-months-grid-day",{"icg-months-grid-day--active-month":e.isCurrentMonth,"icg-months-grid-day--first-day":e.isFirstDay,"icg-months-grid-day--weekend":e.isWeekend,"icg-months-grid-day--current":e.isCurrent}]),style:O({height:`${h(t)}px`})},[R(d.$slots,"default",E(I({date:e,items:m.value[e.localeDate]})))],6))),128))],512)],512)]))}}),ne={class:"flexbox space-12 tw-h-full"},re={class:"wide tw-relative"},de=["onClick"],ce={class:"pl-calendar-day"},ue={key:0},me={class:"custom-p-8 custom-pt-40"},fe={key:0,class:"opacity-50"},ve={class:"tw-w-80 tw-flex tw-flex-col tw-gap-4 tw-h-full tw-overflow-y-auto hide-scrollbar"},he={class:"flexbox space-12 middle custom-pt-12 tw-flex-none"},pe={class:"tw-flex-auto"},ge={class:"custom-my-16 tw-cursor-pointer heading"},_e=z({__name:"CalendarView",props:{selectedDate:{}},setup(f){const n=A(),r=D(),l=D(),u=b(()=>[...n.getTasksCompleted,...n.getDue].map(t=>({...t,filterDate:t.complete_datetime||t.due_date})).filter(t=>{if(!t.filterDate)return!1;const s=new Date(t.filterDate).getTime();return s>r.value&&s<l.value})),v=({start:t,end:s})=>{r.value=t,l.value=s};return(t,s)=>(p(),g("div",ne,[o("div",re,[x(h(oe),{items:u.value,"field-with-date":"filterDate",locale:h(j),onChangeInterval:v},{default:F(({date:c,items:w})=>[o("div",{class:"tw-h-full",style:O(t.selectedDate===h(_)(new Date(c.timestamp)).format("YYYY-MM-DD")&&"background: var(--highlighted-green)"),onClick:m=>t.$router.push({name:"calendar",params:{date:h(_)(new Date(c.timestamp)).format("YYYY-MM-DD")}})},[o("div",ce,[Y(k(new Date(c.timestamp).getDate())+" ",1),new Date(c.timestamp).getDate()===1?(p(),g("span",ue,k(h(_)(new Date(c.timestamp)).format("MMM")),1)):L("",!0)]),o("div",me,[(p(!0),g(S,null,T(w,m=>(p(),g("div",{key:m.uuid||m.id,class:"flexbox middle space-4"},[m.complete_datetime?(p(),g("div",fe,s[1]||(s[1]=[o("i",{class:"small gray fas fa-check"},null,-1)]))):L("",!0),o("div",{class:W(["small tw-truncate",{"opacity-50":m.complete_datetime}])},k(m.name),3)]))),128))])],12,de)]),_:1},8,["items","locale"])]),o("div",ve,[t.selectedDate?(p(),g(S,{key:0},[o("div",he,[o("a",{class:"back larger",onClick:s[0]||(s[0]=P(c=>t.$router.push({name:"calendar"}),["prevent"]))},s[2]||(s[2]=[o("i",{class:"fas fa-arrow-circle-left"},null,-1)])),Y(" "+k(h(_)(new Date(t.selectedDate)).format("LL")),1)]),o("div",pe,[o("div",null,[x($,{filter:"date",date:t.selectedDate,"addable-props":{due_date:t.selectedDate}},null,8,["date","addable-props"]),o("div",ge,k(t.$t("completed")),1),x($,{filter:"date","should-filter-uncompleted":!0,date:t.selectedDate,"hide-add-new-task":!0,"disable-sort":!0},null,8,["date"])])])],64)):L("",!0)])]))}});export{_e as default};
