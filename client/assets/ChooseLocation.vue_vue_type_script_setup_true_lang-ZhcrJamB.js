import{aH as M,d as b,y as I,a0 as x,r as p,o as y,x as k,G as $,n as C,b as t,v as E,j as _,a1 as L,k as h,aI as R,c as S,t as r,f as v,w as A,A as z,aC as P}from"./index-j05cnVj6.js";import{a as T}from"./TaskList.vue_vue_type_script_setup_true_lang-NiELA02A.js";const j=async i=>{try{const{response:e}=await(await fetch(`https://geocode-maps.yandex.ru/1.x/?apikey=${M}&geocode=${i}&format=json`)).json();return e?e.GeoObjectCollection.featureMember.map(s=>s.GeoObject):[]}catch(e){return e instanceof Error&&console.error(e.message),[]}},D=b({__name:"ChooseLocationCreate",props:{lat:{},lng:{},radius:{}},emits:["close"],setup(i,{emit:e}){const s=e,o=i,w=I(),c=x(),u=p(""),m=async()=>{const l=await c.insert({name:u.value,location_latitude:o.lat,location_longitude:o.lng,location_radius:o.radius});l&&(await c.updateItem(l,{name:u.value,location_latitude:o.lat,location_longitude:o.lng,location_radius:o.radius}),l&&(w.push(`/map/${l.id}`),s("close")))};return(l,d)=>(y(),k(T,{title:"Add Location",onClose:d[1]||(d[1]=f=>s("close"))},{default:$(()=>[C(t("input",{"onUpdate:modelValue":d[0]||(d[0]=f=>u.value=f),type:"text",placeholder:"Location"},null,512),[[E,u.value]]),t("button",{onClick:m}," Add ")]),_:1}))}});function N(i,e,s){const c=40075016686e-3/(256*Math.pow(2,e))*Math.cos(s*(Math.PI/180));return i/c}const V={class:"tw-absolute tw-top-0 tw-left-0 width-100 tw-h-full"},B={class:"tw-absolute tw-flex tw-flex-col tw-gap-2 tw-top-16 tw-right-6 z-50"},G={class:"pl-bg-block tw-bg-[--pl-bg-block] custom-p-16 tw-rounded-md"},H={class:"small"},U={class:"small gray"},O={class:"small"},Y={class:"tw-flex tw-items-center tw-gap-2 custom-my-8"},F={class:"tw-flex-auto"},Z={class:"tw-flex tw-gap-2"},X=b({__name:"ChooseLocation",props:{lng:{},lat:{},zoom:{}},setup(i){const e=i,s=p(50),o=_(()=>Math.pow(2,21-e.zoom)*1128.49722*(s.value/1e4)),w=_(()=>Math.round(N(o.value,e.zoom,e.lat)));x();const c=p(""),u=p(!1),m=p(!1),l=L([]);p(),h(l,({length:a})=>{u.value=!!a}),h(R(c,500),a=>{if(m.value){m.value=!1;return}d(a)});const d=async a=>{l.value=await j(a)},f=()=>{P(D,{lat:e.lat,lng:e.lng,radius:o.value}).show()};return(a,n)=>(y(),S("div",V,[t("div",B,[t("div",G,[t("p",H,r(a.$t("adjustLocationHint")),1),t("p",U,[v(r(a.lat),1),n[2]||(n[2]=t("br",null,null,-1)),v(" "+r(a.lng),1)]),t("div",O,[v(r(a.$t("Radius"))+": ",1),t("b",null,r(o.value&&Math.ceil(o.value))+" "+r(a.$t("m")),1)]),t("div",Y,[t("div",F,[C(t("input",{"onUpdate:modelValue":n[0]||(n[0]=g=>s.value=g),type:"range",min:"10",max:"100",class:"width-100"},null,512),[[E,s.value,void 0,{number:!0}]])]),t("a",{class:"gray smaller",onClick:n[1]||(n[1]=A(g=>s.value=50,["prevent"]))},"reset")]),t("div",Z,[t("button",{onClick:f},r(a.$t("Save location")),1)])])]),t("div",{class:"tw-absolute tw-top-1/2 tw-left-1/2 -tw-translate-x-1/2 -tw-translate-y-1/2 z-40 tw-rounded-full tw-pointer-events-none",style:z({"background-color":"rgba(56, 56, 219, 0.4)",border:"1px solid rgb(14, 194, 219)",width:w.value+"px",height:w.value+"px"})},n[3]||(n[3]=[t("div",{class:"tw-absolute tw-top-1/2 tw-left-1/2 -tw-translate-x-1/2 -tw-translate-y-1/2"},[t("i",{class:"fas fa-map-pin text-purple",style:{"font-size":"2rem"}})],-1)]),4)]))}});export{X as _};
