import{d as L,r as N,z as H,D as w,o as c,c as p,E as K,G as B,i as q,y as z,A as F,x as J,l as y,b as e,e as d,H as O,t as v,B as S,I as T,h as u,J as U,K as j,n as A,w as _,L as M,F as R,q as G,M as W,s as Y}from"./index-N0Aucc1x.js";import{C as P}from"./ContenteditableBlock-LYNwQ7wS.js";import{u as Q,_ as X,a as Z}from"./LazyRender.vue_vue_type_script_setup_true_lang-Tn6m0nWI.js";import{_ as tt}from"./SearchForm.vue_vue_type_script_setup_true_lang-fwMwLvCi.js";import"./rangy-5rxgwlWZ.js";const et=L({__name:"WaDropOnElement",props:{draggableEntityName:{}},emits:["drop"],setup(g,{emit:o}){const s=o,a=g,n=N(),{getDraggingEntityName:l}=Q();return H(()=>{w(n,"dragenter",t=>{a.draggableEntityName===l()&&t.currentTarget instanceof HTMLElement&&t.currentTarget.classList.add("dragover")}),w(n,"dragleave",t=>{if(t.currentTarget instanceof HTMLElement){if(t.relatedTarget&&t.currentTarget.contains(t.relatedTarget))return;t.currentTarget.classList.remove("dragover")}}),w(n,"dragover",t=>{t.preventDefault()}),w(n,"drop",t=>{if(a.draggableEntityName===l()&&t.currentTarget instanceof HTMLElement&&(t.preventDefault(),t.currentTarget.classList.remove("dragover"),t.dataTransfer))try{const m=JSON.parse(t.dataTransfer.getData("text/plain")).taskIds;s("drop",m)}catch{}})}),(t,m)=>(c(),p("div",{ref_key:"menuItemElementRef",ref:n},[K(t.$slots,"default")],512))}}),st={class:"tw-group tw-relative tw-py-4 tw-px-6 -tw-mx-6"},at={key:0},nt={class:"hint"},ot={class:"hint"},it={class:"hint"},rt={class:"tw-flex tw-gap-4 tw-justify-between"},lt={key:0,class:"badge red"},dt={class:"tw-flex tw-gap-2"},ct=L({__name:"ListsListItem",props:{item:{}},setup(g,{expose:o}){const s=g,a=B(),n=q(),l=z(),t=N(!1);o({editMode:t});const m=f=>{a.updateItemName(s.item,f)},x=()=>{a.deleteItem(s.item),l.push({name:"lists"})},b=async f=>{await n.sort(s.item.id,null,f)},i=()=>{t.value=!1},k=async()=>{i(),l.push({name:"list",params:{id:s.item.id},query:{addNewTask:1}})};return(f,r)=>{const V=F("RouterLink");return c(),J(et,{"draggable-entity-name":"tasks",onDrop:b},{default:y(()=>{var E,I,$,C,h,D;return[e("div",st,[r[5]||(r[5]=e("div",{class:"sortable-handle tw-cursor-grabbing tw-absolute -tw-translate-x-4 tw-hidden group-hover:tw-block"},[e("i",{class:"fas fa-grip-vertical"})],-1)),e("div",null,[d(O).is_debug_mode?(c(),p("div",at,[e("span",nt,"id: "+v((E=s.item)==null?void 0:E.id),1),r[1]||(r[1]=S(" | ")),e("span",ot,"prev_id: "+v(String((I=s.item)==null?void 0:I.prev_item_id)),1),r[2]||(r[2]=S(" | ")),e("span",it,"srank: "+v(String(($=s.item)==null?void 0:$.sort))+" | "+v(String((C=d(a).getItemById(s.item.id))==null?void 0:C.rank)),1)])):T("",!0),e("div",rt,[u(V,{to:{name:"list",params:{id:s.item.id}},class:"tw-flex-auto"},{default:y(()=>[e("div",{class:U({"tw-bg-yellow":d(j)(d(l).currentRoute.value.params.id)===s.item.id||d(l).currentRoute.value.params.id===s.item.uuid})},[u(P,{value:f.item.name,editable:t.value,focusable:!0,placeholder:"New list",tag:"span",onBlur:i,onUpdate:m,onKeydown:A(_(k,["prevent"]),["enter"])},null,8,["value","editable","onKeydown"])],2)]),_:1},8,["to"]),S(" "+v((h=s.item.extended_data)==null?void 0:h.items_count)+" ",1),(D=s.item.extended_data)!=null&&D.items_priority_count?(c(),p("div",lt,v(s.item.extended_data.items_priority_count),1)):T("",!0),e("div",dt,[e("a",{class:"count",onClick:r[0]||(r[0]=_(_t=>t.value=!t.value,["prevent"]))},r[3]||(r[3]=[e("i",{class:"fas fa-pen"},null,-1)])),e("a",{class:"count",onClick:_(x,["prevent"])},r[4]||(r[4]=[e("i",{class:"fas fa-trash-alt"},null,-1)]))])])])])]}),_:1})}}}),ut={class:"heading black tw-m-0 tw-mb-2"},pt={class:"pl-bg-block"},mt={key:0,class:"tw-px-4 tw-py-3 gray"},ft=L({__name:"ListsList",props:{pocket:{}},setup(g){const o=g,s=M(),a=B(),n=N(!1),l=[],t=async()=>{await a.createList({pocket_id:o.pocket.id}),await G(),l.at(-1).editMode=!0},m=b=>{s.updateItemName(o.pocket,b)},x=()=>{s.deleteItem(o.pocket)};return(b,i)=>(c(),p(R,null,[e("h5",ut,[u(P,{value:o.pocket.name,tag:"span",editable:n.value,focusable:!0,placeholder:"New Pocket",onBlur:i[0]||(i[0]=k=>n.value=!1),onUpdate:m},null,8,["value","editable"]),e("a",{class:"count",onClick:i[1]||(i[1]=_(k=>n.value=!n.value,["prevent"]))},i[2]||(i[2]=[e("i",{class:"fas fa-pen"},null,-1)])),e("a",{class:"count action",onClick:_(t,["prevent"])},i[3]||(i[3]=[e("i",{class:"fas fa-plus-circle"},null,-1)])),e("a",{class:"count action",onClick:_(x,["prevent"])},i[4]||(i[4]=[e("i",{class:"fas fa-trash-alt"},null,-1)]))]),e("div",pt,[u(Z,{items:d(a).getListsInPocket(o.pocket.id),"sortable-list-id":o.pocket.id,"sortable-group-name":"lists",onSort:d(a).sort},{default:y(({item:k})=>[u(X,{style:{height:"70px"}},{default:y(()=>[u(ct,{ref:f=>l.push(f),item:k},null,8,["item"])]),_:2},1024)]),_:1},8,["items","sortable-list-id","onSort"]),d(a).getListsInPocket(o.pocket.id).length?T("",!0):(c(),p("div",mt," No Lists Yet "))])],64))}}),gt={class:"tw-gap-4"},vt={class:"align-center"},xt=L({__name:"SidebarInner",setup(g){const o=M();return(s,a)=>(c(),p("div",gt,[u(tt),a[2]||(a[2]=W('<div class="bricks tw-ml-0 -tw-mr-3"><div class="brick pl-bg-block"><span class="icon"><i class="fas fa-star"></i></span><span class="count">495</span> Star </div><div class="brick pl-bg-block"><span class="icon"><i class="fas fa-bolt"></i></span><span class="count">33</span> Bolt </div></div>',1)),(c(!0),p(R,null,Y(d(o).items,n=>(c(),p("div",{key:n.uuid||n.id},[u(ft,{pocket:n},null,8,["pocket"])]))),128)),e("div",vt,[e("button",{class:"gray",onClick:a[0]||(a[0]=n=>d(o).createPocket())},a[1]||(a[1]=[e("i",{class:"fa fa-plus"},null,-1)]))])]))}});export{xt as default};
