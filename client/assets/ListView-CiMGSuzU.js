import{_ as S}from"./TaskListLayout.vue_vue_type_script_setup_true_lang-0AEN6hzX.js";import{_ as w}from"./TaskList.vue_vue_type_script_setup_true_lang-WN2BvxRy.js";import{d as b,r as v,O as B,P as $,o as n,c as _,A as y,i as O,j as f,k as h,q as N,e as I,x as m,l as p,b as o,F as k,s as L,J as g,H as T,Q as C,t as D,R,h as V,L as E}from"./index-JxhzpELs.js";import{_ as F}from"./VerticalGap.vue_vue_type_script_setup_true_lang-ESI00QH4.js";import"./rangy-5rxgwlWZ.js";import"./SortableList.vue_vue_type_style_index_0_lang-yycvBCpa.js";const j=l=>typeof l<"u",q=b({__name:"IntersectionObserver",props:{disabled:{type:Boolean}},emits:["intersecting"],setup(l,{emit:t}){const i=l,s=t,e=v(null),{stop:c}=B(e,([{isIntersecting:r}])=>{r&&!i.disabled&&s("intersecting")},{rootMargin:"100px"});return $(()=>{c()}),(r,u)=>(n(),_("div",{ref_key:"elRef",ref:e,class:"tw-min-h-2"},[y(r.$slots,"default")],512))}}),A={class:"skeleton"},H=b({__name:"Scroller",props:{currentListId:{},fetchDisabled:{type:Boolean}},setup(l){const t=l,i=O(),s=v(0),e=v(null),c=f(()=>e.value?e.value.offset+e.value.limit<e.value.count:!1);h(()=>t.currentListId,()=>{s.value=0,e.value=null}),h(s,async()=>{if(!t.fetchDisabled){const{scrollTop:u}=document.documentElement,{data:d,...a}=await i.fetch({list_id:t.currentListId,offset:s.value});await N(),document.documentElement.scrollTop=u,e.value=a}},{immediate:!0});function r(){e.value&&(s.value+=e.value.limit)}return(u,d)=>(n(),_(k,null,[y(u.$slots,"default",{tasks:I(i).getTasksInList(t.currentListId)}),c.value?(n(),m(q,{key:0,onIntersecting:r},{default:p(()=>[o("div",A,[(n(),_(k,null,L(10,a=>o("span",{key:a,class:"skeleton-custom-box",style:{height:"60px"}})),64))])]),_:1})):g("",!0)],64))}}),J={class:"tw-px-6"},K=b({__name:"ListView",setup(l){const t=T(),i=C(),s=f(()=>E(i.params.id)),e=f(()=>t.getItemById(s.value)),c=f(()=>[e.value,...t.getSublistsInList(s.value)].filter(j)),r=()=>{e.value&&t.createList({pocket_id:e.value.pocket_id,parent_list_id:s.value})};return(u,d)=>(n(),m(S,null,{default:p(()=>[e.value?(n(),m(F,{key:0,space:4},{default:p(()=>[o("div",J,[o("h1",null,D(e.value.name),1)]),(n(!0),_(k,null,L(c.value,a=>(n(),m(H,{key:a.uuid||a.id,"current-list-id":a.id,"fetch-disabled":!I(R)(e.value)},{default:p(({tasks:x})=>[V(w,{items:x,"sortable-list-id":a.id,"addable-props":{list_id:a.id}},null,8,["items","sortable-list-id","addable-props"])]),_:2},1032,["current-list-id","fetch-disabled"]))),128)),o("div",{class:"align-center"},[o("button",{class:"gray",onClick:r},d[0]||(d[0]=[o("i",{class:"fas fa-plus"},null,-1)]))])]),_:1})):g("",!0)]),_:1}))}});export{K as default};
