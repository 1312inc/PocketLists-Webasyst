import{d as Y,r as D,K as S,j as C,o as h,c as g,b as n,t as k,g as w,A as _,F as L,p as T,H as $,O as R,P as H,W as I,X as N,B as V,Q as E,Y as O,Z as B,J as A,z as F,e as x,k as P,w as j,f as z,E as b,$ as U}from"./index-_-KoVtVs.js";import{_ as W}from"./TaskList.vue_vue_type_script_setup_true_lang-4ZklXd7s.js";import"./SortableList.vue_vue_type_style_index_0_lang-vzB0afFL.js";import"./rangy-5rxgwlWZ.js";const q=typeof window<"u"&&typeof document<"u"?window:void 0,G=(u,r)=>{const d=new Date(Date.UTC(2017,0,2)),o=[];for(let c=0;c<7;c++)o.push(d.toLocaleDateString(u,{weekday:"short"})),d.setDate(d.getDate()+1);return r||o.unshift(o.pop()),o};function J(u,r,d){let o=0,c=!1,m=0,e=null;const l=10,f=10;function v(i){const y=-i.deltaY,M=Math.abs(y);M<f||i.timeStamp-m<300&&c||(m=i.timeStamp,o<M&&!c?(y<-l?r():y>l&&d(),p(M),e&&clearTimeout(e),e=setTimeout(()=>{o===M&&a()},1e3)):M<l&&a())}function p(i){o=i,c=!0}function a(){o=l,c=!1}const s=()=>{u.value&&u.value.removeEventListener("wheel",v)},t=C(u,i=>{s(),i&&i.addEventListener("wheel",v)},{immediate:!0,flush:"post"});O()&&B(()=>{s(),t()})}function K(u,r={width:0,height:0}){const d=q;let o;const c=d&&"ResizeObserver"in d,m=D(r.width),e=D(r.height),l=([p])=>{const a=p.contentBoxSize;if(a){const s=Array.isArray(a)?a:[a];m.value=s.reduce((t,{inlineSize:i})=>t+i,0),e.value=s.reduce((t,{blockSize:i})=>t+i,0)}else m.value=p.contentRect.width,e.value=p.contentRect.height},f=()=>{o&&(o.disconnect(),o=void 0)},v=C(u,p=>{f(),c&&d&&(o=new ResizeObserver(l),p&&o.observe(p))},{immediate:!0,flush:"post"});return V(()=>{u.value&&(m.value="offsetWidth"in u.value?u.value.offsetWidth:r.width,e.value="offsetHeight"in u.value?u.value.offsetHeight:r.height)}),O()&&B(()=>{f(),v()}),{width:m,height:e}}function Q(u,r,d){const o=D(1),c=D(!0),m=D(!0),{height:e}=K(u),l=S(()=>e.value/6),f=D(_()),v=S(()=>{const s=f.value.startOf("M"),t=s.get("d")+-d,i=t<0?7+t:t;return s.add(-(6*7+i),"d")}),p=S(()=>new Array(6*7*3).fill(null).map((s,t)=>{const i=v.value.add(t,"d").toDate(),y=i.toLocaleDateString();return{localeDate:y,timestamp:i.getTime(),isWeekend:[0,6].includes(i.getDay()),isCurrent:new Date().toLocaleDateString()===y,isFirstDay:i.getDate()===1,isCurrentMonth:i.getMonth()===f.value.get("M")}}));V(()=>{r.value&&(m.value=!1,r.value.style.transform=`translate3d(0px, ${-r.value.clientHeight}px, 0px)`)}),J(u,()=>{c.value&&o.value<2&&o.value++},()=>{c.value&&o.value>0&&o.value--});const a=s=>{if(r.value){const t=r.value.querySelectorAll(".icg-months-grid-day--first-day")[s];t instanceof HTMLElement&&(r.value.style.transform=`translate3d(0px, ${-t.offsetTop}px, 0px)`)}};return C(o,s=>{s===1?a(s):r.value&&(m.value=!0,c.value=!1,r.value.addEventListener("transitionend",()=>{m.value=!1,c.value=!0,f.value=f.value.add(s===0?-1:1,"month"),E(()=>{o.value=1})},{once:!0}),a(s))}),C(m,s=>{r.value&&(r.value.style.transitionProperty=s?"transform":"none")}),C(l,()=>{a(1)},{flush:"post"}),{cellHeight:l,activeMonth:f,daysInCalendar:p}}const X={class:"icg"},Z={class:"icg-header"},ee={class:"icg-month"},te={class:"icg-controls"},ae=n("svg",{xmlns:"http://www.w3.org/2000/svg",height:".8rem",viewBox:"0 0 320 512"},[n("path",{d:"M9.4 233.4c-12.5 12.5-12.5 32.8 0 45.3l192 192c12.5 12.5 32.8 12.5 45.3 0s12.5-32.8 0-45.3L77.3 256 246.6 86.6c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0l-192 192z"})],-1),se=[ae],le=n("svg",{xmlns:"http://www.w3.org/2000/svg",height:".8rem",viewBox:"0 0 320 512"},[n("path",{d:"M310.6 233.4c12.5 12.5 12.5 32.8 0 45.3l-192 192c-12.5 12.5-32.8 12.5-45.3 0s-12.5-32.8 0-45.3L242.7 256 73.4 86.6c-12.5-12.5-12.5-32.8 0-45.3s32.8-12.5 45.3 0l192 192z"})],-1),oe=[le],ie={class:"icg-weekdays"},ne=Y({__name:"InfiniteCalendarGrid",props:{firstDayOfWeek:{default:0},locale:{default:"en-US"},todayLabel:{default:"Today"},items:{},fieldWithDate:{}},emits:["changeInterval"],setup(u,{emit:r}){const d=u,o=r,c=D(null),m=D(null),{cellHeight:e,activeMonth:l,daysInCalendar:f}=Q(c,m,d.firstDayOfWeek),v=G(d.locale,d.firstDayOfWeek),p=S(()=>{const a={};for(const s of d.items){const t=s[d.fieldWithDate];if(typeof t=="string"||typeof t=="number"){const i=new Date(t);if(!isNaN(i.getTime())){const y=i.toLocaleDateString();a[y]?a[y].push(s):a[y]=[s]}}}return a});return C(f,a=>{o("changeInterval",{start:a[0].timestamp,end:a[a.length-1].timestamp})},{immediate:!0,flush:"post"}),(a,s)=>(h(),g("div",X,[n("div",Z,[n("div",ee,k(w(l).toDate().toLocaleDateString(d.locale,{year:"numeric",month:"long"}).replace("Ð³.","")),1),n("div",te,[n("button",{onClick:s[0]||(s[0]=t=>l.value=w(l).add(-1,"M"))},se),n("button",{onClick:s[1]||(s[1]=t=>l.value=w(_)())},k(d.todayLabel),1),n("button",{onClick:s[2]||(s[2]=t=>l.value=w(l).add(1,"M"))},oe)])]),n("div",ie,[(h(!0),g(L,null,T(w(v),(t,i)=>(h(),g("div",{key:t,class:$(["icg-weekdays-cell",{"icg-weekdays-cell--weekend":i===(d.firstDayOfWeek?5:0)||i===6}])},k(t),3))),128))]),n("div",{ref_key:"wrapperRef",ref:c,class:"icg-wrapper"},[n("div",{ref_key:"containerRef",ref:m,class:"icg-months-grid"},[(h(!0),g(L,null,T(w(f),t=>(h(),g("div",{key:t.timestamp,class:$(["icg-months-grid-day",{"icg-months-grid-day--active-month":t.isCurrentMonth,"icg-months-grid-day--first-day":t.isFirstDay,"icg-months-grid-day--weekend":t.isWeekend,"icg-months-grid-day--current":t.isCurrent}]),style:R({height:`${w(e)}px`})},[H(a.$slots,"default",I(N({date:t,items:p.value[t.localeDate]})))],6))),128))],512)],512)]))}}),re={class:"flexbox space-12 tw-h-full"},de={class:"wide tw-relative"},ce=["onClick"],ue={class:"pl-calendar-day"},me={key:0},fe={class:"custom-p-8 custom-pt-40"},ve={key:0,class:"opacity-50"},pe={key:0,class:"tw-w-80 empty:tw-hidden tw-flex tw-flex-col tw-gap-4 tw-h-full tw-overflow-y-auto hide-scrollbar"},he={class:"flexbox space-12 middle custom-pt-12 tw-flex-none"},ge={class:"tw-flex-auto"},we={class:"custom-my-16 tw-cursor-pointer heading"},ye={key:1,class:"tw-w-80 empty:tw-hidden"},Me=Y({__name:"CalendarView",props:{selectedDate:{}},setup(u){const r=A(),d=D(),o=D(),c=S(()=>[...r.getTasksCompleted,...r.getDue].map(e=>({...e,filterDate:e.complete_datetime||e.due_date})).filter(e=>{if(!e.filterDate)return!1;const l=new Date(e.filterDate).getTime();return l>d.value&&l<o.value})),m=({start:e,end:l})=>{d.value=e,o.value=l};return(e,l)=>{const f=F("RouterView");return h(),g("div",re,[n("div",de,[x(w(ne),{items:c.value,"field-with-date":"filterDate",locale:w(U),onChangeInterval:m},{default:P(({date:v,items:p})=>[n("div",{class:"tw-h-full",style:R(e.selectedDate===w(_)(new Date(v.timestamp)).format("YYYY-MM-DD")&&"background: var(--highlighted-green)"),onClick:a=>e.$router.push({name:"calendarDate",params:{date:w(_)(new Date(v.timestamp)).format("YYYY-MM-DD")}})},[n("div",ue,[z(k(new Date(v.timestamp).getDate())+" ",1),new Date(v.timestamp).getDate()===1?(h(),g("span",me,k(w(_)(new Date(v.timestamp)).format("MMM")),1)):b("",!0)]),n("div",fe,[(h(!0),g(L,null,T(p,a=>(h(),g("div",{key:a.uuid||a.id,class:"flexbox middle space-4"},[a.complete_datetime?(h(),g("div",ve,l[1]||(l[1]=[n("i",{class:"small gray fas fa-check"},null,-1)]))):b("",!0),n("div",{class:$(["small tw-truncate",{"opacity-50":a.complete_datetime}])},k(a.name),3)]))),128))])],12,ce)]),_:1},8,["items","locale"])]),e.$route.name==="calendarDate"?(h(),g("div",pe,[e.selectedDate?(h(),g(L,{key:0},[n("div",he,[n("a",{class:"back larger",onClick:l[0]||(l[0]=j(v=>e.$router.push({name:"calendar"}),["prevent"]))},l[2]||(l[2]=[n("i",{class:"fas fa-arrow-circle-left"},null,-1)])),z(" "+k(w(_)(new Date(e.selectedDate)).format("LL")),1)]),n("div",ge,[n("div",null,[x(W,{filter:"date",date:e.selectedDate,"addable-props":{due_date:e.selectedDate}},null,8,["date","addable-props"]),n("div",we,k(e.$t("completed")),1),x(W,{filter:"date","should-filter-uncompleted":!0,date:e.selectedDate,"hide-add-new-task":!0,"disable-sort":!0},null,8,["date"])])])],64)):b("",!0)])):b("",!0),e.$route.meta.isTaskInfoView?(h(),g("div",ye,[x(f)])):b("",!0)])}}});export{Me as default};
