import{d as W,r as w,J as x,j as k,o as p,c as y,b as m,t as _,g as D,O as z,F as C,p as M,G as L,N as R,P as B,W as H,X as V,A as N,Q as A,Y as O,Z as I,I as E,e as F,k as P,f as $,D as T,$ as b}from"./index-SHjJ8L0G.js";const G=typeof window<"u"&&typeof document<"u"?window:void 0,U=(u,n)=>{const o=new Date(Date.UTC(2017,0,2)),i=[];for(let c=0;c<7;c++)i.push(o.toLocaleDateString(u,{weekday:"short"})),o.setDate(o.getDate()+1);return n||i.unshift(i.pop()),i};function Y(u,n,o){let i=0,c=!1,d=0,f=null;const a=10,r=10;function h(l){const g=-l.deltaY,S=Math.abs(g);S<r||l.timeStamp-d<300&&c||(d=l.timeStamp,i<S&&!c?(g<-a?n():g>a&&o(),v(S),f&&clearTimeout(f),f=setTimeout(()=>{i===S&&s()},1e3)):S<a&&s())}function v(l){i=l,c=!0}function s(){i=a,c=!1}const t=()=>{u.value&&u.value.removeEventListener("wheel",h)},e=k(u,l=>{t(),l&&l.addEventListener("wheel",h)},{immediate:!0,flush:"post"});O()&&I(()=>{t(),e()})}function j(u,n={width:0,height:0}){const o=G;let i;const c=o&&"ResizeObserver"in o,d=w(n.width),f=w(n.height),a=([v])=>{const s=v.contentBoxSize;if(s){const t=Array.isArray(s)?s:[s];d.value=t.reduce((e,{inlineSize:l})=>e+l,0),f.value=t.reduce((e,{blockSize:l})=>e+l,0)}else d.value=v.contentRect.width,f.value=v.contentRect.height},r=()=>{i&&(i.disconnect(),i=void 0)},h=k(u,v=>{r(),c&&o&&(i=new ResizeObserver(a),v&&i.observe(v))},{immediate:!0,flush:"post"});return N(()=>{u.value&&(d.value="offsetWidth"in u.value?u.value.offsetWidth:n.width,f.value="offsetHeight"in u.value?u.value.offsetHeight:n.height)}),O()&&I(()=>{r(),h()}),{width:d,height:f}}function q(u,n,o){const i=w(1),c=w(!0),d=w(!0),{height:f}=j(u),a=x(()=>f.value/6),r=w(z()),h=x(()=>{const t=r.value.startOf("M"),e=t.get("d")+-o,l=e<0?7+e:e;return t.add(-(6*7+l),"d")}),v=x(()=>new Array(6*7*3).fill(null).map((t,e)=>{const l=h.value.add(e,"d").toDate(),g=l.toLocaleDateString();return{localeDate:g,timestamp:l.getTime(),isWeekend:[0,6].includes(l.getDay()),isCurrent:new Date().toLocaleDateString()===g,isFirstDay:l.getDate()===1,isCurrentMonth:l.getMonth()===r.value.get("M")}}));N(()=>{n.value&&(d.value=!1,n.value.style.transform=`translate3d(0px, ${-n.value.clientHeight}px, 0px)`)}),Y(u,()=>{c.value&&i.value<2&&i.value++},()=>{c.value&&i.value>0&&i.value--});const s=t=>{if(n.value){const e=n.value.querySelectorAll(".icg-months-grid-day--first-day")[t];e instanceof HTMLElement&&(n.value.style.transform=`translate3d(0px, ${-e.offsetTop}px, 0px)`)}};return k(i,t=>{t===1?s(t):n.value&&(d.value=!0,c.value=!1,n.value.addEventListener("transitionend",()=>{d.value=!1,c.value=!0,r.value=r.value.add(t===0?-1:1,"month"),A(()=>{i.value=1})},{once:!0}),s(t))}),k(d,t=>{n.value&&(n.value.style.transitionProperty=t?"transform":"none")}),k(a,()=>{s(1)},{flush:"post"}),{cellHeight:a,activeMonth:r,daysInCalendar:v}}const J={class:"icg"},Q={class:"icg-header"},X={class:"icg-month"},Z={class:"icg-controls"},K=m("svg",{xmlns:"http://www.w3.org/2000/svg",height:".8rem",viewBox:"0 0 320 512"},[m("path",{d:"M9.4 233.4c-12.5 12.5-12.5 32.8 0 45.3l192 192c12.5 12.5 32.8 12.5 45.3 0s12.5-32.8 0-45.3L77.3 256 246.6 86.6c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0l-192 192z"})],-1),ee=[K],te=m("svg",{xmlns:"http://www.w3.org/2000/svg",height:".8rem",viewBox:"0 0 320 512"},[m("path",{d:"M310.6 233.4c12.5 12.5 12.5 32.8 0 45.3l-192 192c-12.5 12.5-32.8 12.5-45.3 0s-12.5-32.8 0-45.3L242.7 256 73.4 86.6c-12.5-12.5-12.5-32.8 0-45.3s32.8-12.5 45.3 0l192 192z"})],-1),ae=[te],se={class:"icg-weekdays"},ie=W({__name:"InfiniteCalendarGrid",props:{firstDayOfWeek:{default:0},locale:{default:"en-US"},todayLabel:{default:"Today"},items:{},fieldWithDate:{}},emits:["changeInterval"],setup(u,{emit:n}){const o=u,i=n,c=w(null),d=w(null),{cellHeight:f,activeMonth:a,daysInCalendar:r}=q(c,d,o.firstDayOfWeek),h=U(o.locale,o.firstDayOfWeek),v=x(()=>{const s={};for(const t of o.items){const e=t[o.fieldWithDate];if(typeof e=="string"||typeof e=="number"){const l=new Date(e);if(!isNaN(l.getTime())){const g=l.toLocaleDateString();s[g]?s[g].push(t):s[g]=[t]}}}return s});return k(r,s=>{i("changeInterval",{start:s[0].timestamp,end:s[s.length-1].timestamp})},{immediate:!0,flush:"post"}),(s,t)=>(p(),y("div",J,[m("div",Q,[m("div",X,_(D(a).toDate().toLocaleDateString(o.locale,{year:"numeric",month:"long"}).replace("Ð³.","")),1),m("div",Z,[m("button",{onClick:t[0]||(t[0]=e=>a.value=D(a).add(-1,"M"))},ee),m("button",{onClick:t[1]||(t[1]=e=>a.value=D(z)())},_(o.todayLabel),1),m("button",{onClick:t[2]||(t[2]=e=>a.value=D(a).add(1,"M"))},ae)])]),m("div",se,[(p(!0),y(C,null,M(D(h),(e,l)=>(p(),y("div",{key:e,class:L(["icg-weekdays-cell",{"icg-weekdays-cell--weekend":l===(o.firstDayOfWeek?5:0)||l===6}])},_(e),3))),128))]),m("div",{ref_key:"wrapperRef",ref:c,class:"icg-wrapper"},[m("div",{ref_key:"containerRef",ref:d,class:"icg-months-grid"},[(p(!0),y(C,null,M(D(r),e=>(p(),y("div",{key:e.timestamp,class:L(["icg-months-grid-day",{"icg-months-grid-day--active-month":e.isCurrentMonth,"icg-months-grid-day--first-day":e.isFirstDay,"icg-months-grid-day--weekend":e.isWeekend,"icg-months-grid-day--current":e.isCurrent}]),style:R({height:`${D(f)}px`})},[B(s.$slots,"default",H(V({date:e,items:v.value[e.localeDate]})))],6))),128))],512)],512)]))}}),ne={class:"tw-relative tw-h-full"},le={class:"pl-calendar-day"},oe={key:0},re={class:"custom-p-8 custom-pt-40"},ce={key:0,class:"opacity-50"},de=W({__name:"CalendarView",setup(u){const n=E(),o=w(),i=w(),c=x(()=>[...n.getTasksCompleted,...n.getDue].map(a=>({...a,filterDate:a.complete_datetime||a.due_date})).filter(a=>{if(!a.filterDate)return!1;const r=new Date(a.filterDate).getTime();return r>o.value&&r<i.value})),d=({start:a,end:r})=>{o.value=a,i.value=r,n.fetch({status:1}),n.fetchStream({filter:"due"})};function f(a){try{return a.toLocaleString(b,{month:"short"})}catch{}}return(a,r)=>(p(),y("div",ne,[F(D(ie),{items:c.value,"field-with-date":"filterDate",locale:D(b),onChangeInterval:d},{default:P(({date:h,items:v})=>[m("div",le,[$(_(new Date(h.timestamp).getDate())+" ",1),new Date(h.timestamp).getDate()===1?(p(),y("span",oe,_(f(new Date(h.timestamp))),1)):T("",!0)]),m("div",re,[(p(!0),y(C,null,M(v,s=>(p(),y("div",{key:s.uuid||s.id,class:"flexbox middle space-4"},[s.complete_datetime?(p(),y("div",ce,r[0]||(r[0]=[m("i",{class:"small gray fas fa-check"},null,-1)]))):T("",!0),m("div",{class:L(["small tw-truncate",{"opacity-50":s.complete_datetime}])},_(s.name),3)]))),128))])]),_:1},8,["items","locale"])]))}});export{de as default};
