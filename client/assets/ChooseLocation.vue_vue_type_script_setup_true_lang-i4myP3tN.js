import{aC as E,h as x,E as M,a7 as _,r as u,o as C,D as I,v as L,x as b,k as t,y,c as g,a6 as k,s as h,aD as R,j as S,t as f,w as A,$ as D,ay as $}from"./index-mTohFGR9.js";import{a as z}from"./ModalWrapperBody.vue_vue_type_script_setup_true_lang-qsVegkTV.js";const P=async l=>{try{const{response:e}=await(await fetch(`https://geocode-maps.yandex.ru/1.x/?apikey=${E}&geocode=${l}&format=json`)).json();return e?e.GeoObjectCollection.featureMember.map(o=>o.GeoObject):[]}catch(e){return e instanceof Error&&console.error(e.message),[]}},T=x({__name:"ChooseLocationCreate",props:{lat:{},lng:{},radius:{}},emits:["close"],setup(l,{emit:e}){const o=e,s=l,c=M(),d=_(),p=u(""),w=async()=>{const i=await d.insert({name:p.value,location_latitude:s.lat,location_longitude:s.lng,location_radius:s.radius});i&&(c.push(`/map/${i.id}`),o("close"))};return(i,r)=>(C(),I(z,{title:"Add Location",onClose:r[1]||(r[1]=m=>o("close"))},{default:L(()=>[b(t("input",{"onUpdate:modelValue":r[0]||(r[0]=m=>p.value=m),type:"text",placeholder:"Location"},null,512),[[y,p.value]]),t("button",{onClick:w}," Add ")]),_:1}))}});function j(l,e,o){const d=40075016686e-3/(256*Math.pow(2,e))*Math.cos(o*(Math.PI/180));return l/d}const B={class:"tw-absolute tw-top-0 tw-left-0 width-100 tw-h-full"},N={class:"tw-absolute tw-flex tw-flex-col tw-gap-2 tw-top-12 tw-right-2 z-50"},U={class:"pl-bg-block custom-p-16 tw-rounded-md"},V={class:"tw-flex tw-items-center tw-gap-2 custom-my-8"},G={class:"tw-flex-auto"},F=x({__name:"ChooseLocation",props:{lng:{},lat:{},zoom:{}},setup(l){const e=l,o=u(50),s=g(()=>Math.pow(2,21-e.zoom)*1128.49722*(o.value/1e4)),c=g(()=>Math.round(j(s.value,e.zoom,e.lat)));_();const d=u(""),p=u(!1),w=u(!1),i=k([]);u(),h(i,({length:a})=>{p.value=!!a}),h(R(d,500),a=>{if(w.value){w.value=!1;return}r(a)});const r=async a=>{i.value=await P(a)},m=()=>{$(T,{lat:e.lat,lng:e.lng,radius:s.value}).show()};return(a,n)=>(C(),S("div",B,[t("div",N,[t("div",U,[n[2]||(n[2]=t("h6",null," Current locations ",-1)),t("div",null,"Lat: "+f(a.lat),1),t("div",null,"Lng: "+f(a.lng),1),t("div",null,"Radius: "+f(s.value&&Math.ceil(s.value))+" m",1),t("div",V,[t("div",G,[b(t("input",{"onUpdate:modelValue":n[0]||(n[0]=v=>o.value=v),type:"range",min:"10",max:"100",class:"width-100"},null,512),[[y,o.value,void 0,{number:!0}]])]),t("a",{class:"gray smaller",onClick:n[1]||(n[1]=A(v=>o.value=50,["prevent"]))},"reset")]),t("div",{class:"tw-flex tw-gap-2"},[t("button",{onClick:m}," Create ")])])]),t("div",{class:"tw-absolute tw-top-1/2 tw-left-1/2 -tw-translate-x-1/2 -tw-translate-y-1/2 z-40 tw-rounded-full tw-pointer-events-none",style:D({"background-color":"rgba(56, 56, 219, 0.4)",border:"1px solid rgb(14, 194, 219)",width:c.value+"px",height:c.value+"px"})},n[3]||(n[3]=[t("div",{class:"tw-absolute tw-top-1/2 tw-left-1/2 -tw-translate-x-1/2 -tw-translate-y-1/2"},[t("i",{class:"fas fa-map-pin text-purple",style:{"font-size":"2rem"}})],-1)]),4)]))}});export{F as _};
