import{d as y,r as h,aA as C,z as $,o,c as l,P as p,H as b,I,i as P,B as T,b as a,t as S,C as g,h as w,j as _,aB as L,F as v,p as N,n as U,w as M}from"./index-9aHTTejR.js";const x=y({__name:"IntersectionObserver",props:{disabled:{type:Boolean}},emits:["intersecting"],setup(d,{emit:e}){const t=d,n=e,s=h(null),{stop:u}=C(s,([{isIntersecting:r}])=>{r&&!t.disabled&&n("intersecting")},{rootMargin:"200px"});return $(()=>{u()}),(r,f)=>(o(),l("div",{ref_key:"elRef",ref:s},[p(r.$slots,"default")],512))}}),R={key:0},V={class:"skeleton custom-m-24"},k=30,E=y({__name:"TaskListLazyLoadFetcher",props:{filter:{},shouldFilterUncompleted:{type:Boolean},listId:{},locationId:{},userId:{},searchQuery:{}},setup(d){const e=d,t=b(),n=h(k),s=h([]),u=h(!1),r=I(()=>({list:{source:e.listId?t.getTasksInList(e.listId,e.shouldFilterUncompleted):[],isFetchStream:!1,fetchParams:e.listId?{list_id:e.listId,status:e.shouldFilterUncompleted?"1":"0"}:{}},upnext:{source:t.getUpnext,isFetchStream:!0,fetchParams:{filter:"upnext"}},due:{source:t.getDue,isFetchStream:!0,fetchParams:{filter:"due"}},priority:{source:t.getPriority,isFetchStream:!0,fetchParams:{filter:"priority"}},nearby:{source:t.getTasksSortedByCurrentDistance,isFetchStream:!0,fetchParams:{filter:"nearby"}},search:{source:s.value,isFetchStream:!0,fetchParams:{filter:`search/${e.searchQuery}`}},location:{source:e.locationId?t.getTasksInLocation(e.locationId):[],isFetchStream:!1,fetchParams:e.locationId?{location_id:e.locationId}:{}},user:{source:e.userId?t.getTasksByUser(e.userId):[],isFetchStream:!1,fetchParams:e.userId?{assigned_contact_id:e.userId}:{}},completed:{source:t.getTasksCompleted,isFetchStream:!1,fetchParams:{status:1}}})[e.filter]),f=I(()=>r.value.source.slice(0,n.value));P(()=>e,F,{deep:!0,immediate:!0});const B=()=>{n.value+=k};async function F(){const{isFetchStream:m,fetchParams:i}=r.value;if(i.list_id&&typeof i.list_id!="number")return;u.value=!1,s.value=[];const c=await t[m?"fetchStream":"fetch"]({...i});c&&c.value&&c.value.status_code==="ok"&&e.filter==="search"&&(s.value=[...s.value,...c.value.data],u.value=!s.value.length)}return(m,i)=>(o(),l(v,null,[p(m.$slots,"default",{tasks:f.value}),e.filter==="search"&&u.value?(o(),l("div",R,[i[0]||(i[0]=T(" No matches found for ")),a("strong",null,S(e.searchQuery),1)])):g("",!0),w(L,{name:"fade"},{default:_(()=>[f.value.length&&f.value.length<r.value.source.length?(o(),N(x,{key:0,onIntersecting:B},{default:_(()=>[a("div",V,[(o(),l(v,null,U(5,c=>a("span",{key:c,class:"skeleton-custom-box",style:{height:"40px"}})),64))])]),_:1})):g("",!0)]),_:1})],64))}}),D={class:"dialog-header"},Q={class:"dialog-content"},z={class:"dialog-footer tw-flex tw-gap-2"},H=y({__name:"ModalWrapperBody",props:{title:{},hideCloseButton:{type:Boolean},hideCloseIcon:{type:Boolean}},emits:["close"],setup(d){return(e,t)=>(o(),l(v,null,[a("header",D,[a("h1",null,S(e.$props.title),1),e.hideCloseIcon?g("",!0):(o(),l("a",{key:0,class:"dialog-close",onClick:t[0]||(t[0]=M(n=>e.$emit("close"),["prevent"]))},t[2]||(t[2]=[a("i",{class:"fas fa-times"},null,-1)])))]),a("div",Q,[p(e.$slots,"default")]),a("footer",z,[p(e.$slots,"submit"),e.hideCloseButton?g("",!0):(o(),l("button",{key:0,class:"button light-gray",onClick:t[1]||(t[1]=n=>e.$emit("close"))}," Close "))])],64))}});export{E as _,H as a};
