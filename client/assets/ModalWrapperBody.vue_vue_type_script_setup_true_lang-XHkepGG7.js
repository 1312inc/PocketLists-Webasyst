import{h as _,r as m,aA as F,M as P,o,j as i,X as p,u as T,c as S,L as w,s as D,aB as L,P as M,k as r,t as $,Q as v,q as N,v as C,aC as Q,F as y,aD as x,D as R,C as U,w as V}from"./index-EhhO85kh.js";const A=_({__name:"IntersectionObserver",props:{disabled:{type:Boolean}},emits:["intersecting"],setup(d,{emit:e}){const t=d,l=e,a=m(null),{stop:c}=F(a,([{isIntersecting:n}])=>{n&&!t.disabled&&l("intersecting")},{rootMargin:"200px"});return P(()=>{c()}),(n,f)=>(o(),i("div",{ref_key:"elRef",ref:a},[p(n.$slots,"default")],512))}}),E={key:0},O={class:"skeleton custom-m-24"},B=30,H=_({__name:"TaskListLazyLoadFetcher",props:{filter:{},listId:{},locationId:{},userId:{},searchQuery:{}},setup(d){const e=d,t=T(),l=m(B),a=m([]),c=m(!1),{item:n}=x(),f=S(()=>({list:{source:e.listId?t.getTasksInList(e.listId):[],isFetchStream:!1,fetchParams:e.listId?{list_id:e.listId}:{}},upnext:{source:t.getUpnext,isFetchStream:!0,fetchParams:{filter:"upnext"}},due:{source:t.getDue,isFetchStream:!0,fetchParams:{filter:"due"}},priority:{source:t.getPriority,isFetchStream:!0,fetchParams:{filter:"priority"}},nearby:{source:t.getTasksSortedByCurrentDistance,isFetchStream:!0,fetchParams:{filter:"nearby"}},search:{source:a.value,isFetchStream:!0,fetchParams:{filter:`search/${e.searchQuery}`}},location:{source:e.locationId?t.getTasksInLocation(e.locationId):[],isFetchStream:!1,fetchParams:e.locationId?{location_id:e.locationId}:{}},user:{source:e.userId?t.getTasksByUser(e.userId):[],isFetchStream:!0,fetchParams:{filter:`user/${e.userId}`}}})[e.filter]),g=S(()=>f.value.source.slice(0,l.value));w(()=>{k()}),D(()=>e.searchQuery,()=>{c.value=!1,a.value=[],k()});const b=()=>{l.value+=B},k=async()=>{const{isFetchStream:h,fetchParams:s}=f.value;if(s.list_id&&typeof s.list_id!="number")return;let u;s.list_id&&(u=n.value.get(s.list_id));const I=await t[h?"fetchStream":"fetch"]({...s,limit:500,starting_from:u&&L(new Date(u))});I.value&&e.filter==="search"&&(a.value=[...a.value,...I.value.data],c.value=!a.value.length),s.list_id&&n.value.set(s.list_id,Date.now())};return(h,s)=>(o(),i(y,null,[p(h.$slots,"default",{tasks:g.value}),e.filter==="search"&&c.value?(o(),i("div",E,[s[0]||(s[0]=M(" No matches found for ")),r("strong",null,$(e.searchQuery),1)])):v("",!0),N(Q,{name:"fade"},{default:C(()=>[g.value.length&&g.value.length<f.value.source.length?(o(),R(A,{key:0,onIntersecting:b},{default:C(()=>[r("div",O,[(o(),i(y,null,U(5,u=>r("span",{key:u,class:"skeleton-custom-box",style:{height:"40px"}})),64))])]),_:1})):v("",!0)]),_:1})],64))}}),W={class:"dialog-header"},j={class:"dialog-content"},q={class:"dialog-footer tw-flex tw-gap-2"},X=_({__name:"ModalWrapperBody",props:{title:{},hideCloseButton:{type:Boolean},hideCloseIcon:{type:Boolean}},emits:["close"],setup(d){return(e,t)=>(o(),i(y,null,[r("header",W,[r("h1",null,$(e.$props.title),1),e.hideCloseIcon?v("",!0):(o(),i("a",{key:0,class:"dialog-close",onClick:t[0]||(t[0]=V(l=>e.$emit("close"),["prevent"]))},t[2]||(t[2]=[r("i",{class:"fas fa-times"},null,-1)])))]),r("div",j,[p(e.$slots,"default")]),r("footer",q,[p(e.$slots,"submit"),e.hideCloseButton?v("",!0):(o(),i("button",{key:0,class:"button light-gray",onClick:t[1]||(t[1]=l=>e.$emit("close"))}," Close "))])],64))}});export{H as _,X as a};
